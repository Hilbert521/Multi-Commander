{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1, "num_steps_trained": 0, "num_steps_sampled": 1000, "sample_time_ms": 12.567, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 5.324, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 1000, "episodes_total": 0, "training_iteration": 1, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-33-41", "timestamp": 1565080421, "time_this_iter_s": 11.671227216720581, "time_total_s": 11.671227216720581, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11.671227216720581, "timesteps_since_restore": 1000, "iterations_since_restore": 1}
{"episode_reward_max": -10374.0, "episode_reward_min": -10374.0, "episode_reward_mean": -10374.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1.0751087268789312, "mean_processing_ms": 0.2102202501730702, "mean_inference_ms": 1.0831588390527636}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.902, "max_exploration": 0.902, "num_target_updates": 3, "num_steps_trained": 8000, "num_steps_sampled": 2000, "sample_time_ms": 15.266, "replay_time_ms": 4.583, "grad_time_ms": 7.187, "update_time_ms": 6.99, "opt_peak_throughput": 4452.33, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -26.07000732421875, "min_q": -51.04987335205078, "max_q": 1.0863300561904907, "mean_td_error": 2.2798733711242676}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 2000, "episodes_total": 1, "training_iteration": 2, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-33-50", "timestamp": 1565080430, "time_this_iter_s": 8.789290189743042, "time_total_s": 20.460517406463623, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 20.460517406463623, "timesteps_since_restore": 2000, "iterations_since_restore": 2}
{"episode_reward_max": -10374.0, "episode_reward_min": -12441.0, "episode_reward_mean": -11407.5, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1.0236474615851154, "mean_processing_ms": 0.20343542481064236, "mean_inference_ms": 1.0262138027333831}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.804, "max_exploration": 0.804, "num_target_updates": 5, "num_steps_trained": 16000, "num_steps_sampled": 3000, "sample_time_ms": 12.808, "replay_time_ms": 4.39, "grad_time_ms": 5.688, "update_time_ms": 5.629, "opt_peak_throughput": 5625.95, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -43.26560974121094, "min_q": -85.16773223876953, "max_q": -5.226601600646973, "mean_td_error": 0.5506243705749512}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 3000, "episodes_total": 2, "training_iteration": 3, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-33-58", "timestamp": 1565080438, "time_this_iter_s": 7.576616287231445, "time_total_s": 28.03713369369507, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 28.03713369369507, "timesteps_since_restore": 3000, "iterations_since_restore": 3}
{"episode_reward_max": -10364.0, "episode_reward_min": -12441.0, "episode_reward_mean": -11059.666666666666, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.986902535185476, "mean_processing_ms": 0.19930982133327502, "mean_inference_ms": 0.9891005357423155}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.706, "max_exploration": 0.706, "num_target_updates": 7, "num_steps_trained": 24000, "num_steps_sampled": 4000, "sample_time_ms": 13.261, "replay_time_ms": 4.156, "grad_time_ms": 6.129, "update_time_ms": 5.813, "opt_peak_throughput": 5221.078, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -51.14729309082031, "min_q": -107.48002624511719, "max_q": 0.034679532051086426, "mean_td_error": -0.7729518413543701}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 4000, "episodes_total": 3, "training_iteration": 4, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-34-05", "timestamp": 1565080445, "time_this_iter_s": 7.548266410827637, "time_total_s": 35.585400104522705, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 35.585400104522705, "timesteps_since_restore": 4000, "iterations_since_restore": 4}
{"episode_reward_max": -7817.0, "episode_reward_min": -12441.0, "episode_reward_mean": -10249.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.959953707708446, "mean_processing_ms": 0.19609231624196355, "mean_inference_ms": 0.9614758477093774}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.608, "max_exploration": 0.608, "num_target_updates": 9, "num_steps_trained": 32000, "num_steps_sampled": 5000, "sample_time_ms": 13.11, "replay_time_ms": 4.209, "grad_time_ms": 5.912, "update_time_ms": 5.577, "opt_peak_throughput": 5413.097, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -76.82471466064453, "min_q": -151.75816345214844, "max_q": 1.0109245777130127, "mean_td_error": -2.3829970359802246}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 5000, "episodes_total": 4, "training_iteration": 5, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-34-13", "timestamp": 1565080453, "time_this_iter_s": 7.536494016647339, "time_total_s": 43.121894121170044, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 43.121894121170044, "timesteps_since_restore": 5000, "iterations_since_restore": 5}
{"episode_reward_max": -7817.0, "episode_reward_min": -12441.0, "episode_reward_mean": -9938.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.9383607921913175, "mean_processing_ms": 0.19354696895444828, "mean_inference_ms": 0.94013544458959}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.51, "max_exploration": 0.51, "num_target_updates": 11, "num_steps_trained": 40000, "num_steps_sampled": 6000, "sample_time_ms": 12.301, "replay_time_ms": 4.329, "grad_time_ms": 6.197, "update_time_ms": 5.222, "opt_peak_throughput": 5164.008, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.80596160888672, "min_q": -194.2404022216797, "max_q": -4.7972025871276855, "mean_td_error": -1.3931827545166016}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 6000, "episodes_total": 5, "training_iteration": 6, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-34-20", "timestamp": 1565080460, "time_this_iter_s": 7.586238622665405, "time_total_s": 50.70813274383545, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 50.70813274383545, "timesteps_since_restore": 6000, "iterations_since_restore": 6}
{"episode_reward_max": -6226.0, "episode_reward_min": -12441.0, "episode_reward_mean": -9319.333333333334, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.9221487446268625, "mean_processing_ms": 0.19155773763652248, "mean_inference_ms": 0.9229635163960186}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.41200000000000003, "max_exploration": 0.41200000000000003, "num_target_updates": 13, "num_steps_trained": 48000, "num_steps_sampled": 7000, "sample_time_ms": 13.675, "replay_time_ms": 3.845, "grad_time_ms": 5.549, "update_time_ms": 5.819, "opt_peak_throughput": 5767.224, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -93.66490173339844, "min_q": -252.00924682617188, "max_q": -1.5697028636932373, "mean_td_error": 1.724623680114746}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 7000, "episodes_total": 6, "training_iteration": 7, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-34-28", "timestamp": 1565080468, "time_this_iter_s": 7.529215574264526, "time_total_s": 58.237348318099976, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 58.237348318099976, "timesteps_since_restore": 7000, "iterations_since_restore": 7}
{"episode_reward_max": -6226.0, "episode_reward_min": -13801.0, "episode_reward_mean": -9959.57142857143, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.9079093821139949, "mean_processing_ms": 0.18986662664345852, "mean_inference_ms": 0.9087539242941176}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.31400000000000006, "max_exploration": 0.31400000000000006, "num_target_updates": 15, "num_steps_trained": 56000, "num_steps_sampled": 8000, "sample_time_ms": 11.952, "replay_time_ms": 4.353, "grad_time_ms": 5.898, "update_time_ms": 5.521, "opt_peak_throughput": 5425.481, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.9581069946289, "min_q": -258.09002685546875, "max_q": -3.2091727256774902, "mean_td_error": 2.379033088684082}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 8000, "episodes_total": 7, "training_iteration": 8, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-34-35", "timestamp": 1565080475, "time_this_iter_s": 7.481080532073975, "time_total_s": 65.71842885017395, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 65.71842885017395, "timesteps_since_restore": 8000, "iterations_since_restore": 8}
{"episode_reward_max": -1933.0, "episode_reward_min": -13801.0, "episode_reward_mean": -8956.25, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.896099942434158, "mean_processing_ms": 0.18847554746317052, "mean_inference_ms": 0.8970057548845155}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.21599999999999997, "max_exploration": 0.21599999999999997, "num_target_updates": 17, "num_steps_trained": 64000, "num_steps_sampled": 9000, "sample_time_ms": 14.292, "replay_time_ms": 4.783, "grad_time_ms": 6.713, "update_time_ms": 6.19, "opt_peak_throughput": 4767.033, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -134.17266845703125, "min_q": -331.09783935546875, "max_q": -8.939306259155273, "mean_td_error": 4.556519031524658}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 9000, "episodes_total": 8, "training_iteration": 9, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-34-43", "timestamp": 1565080483, "time_this_iter_s": 7.608306169509888, "time_total_s": 73.32673501968384, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 73.32673501968384, "timesteps_since_restore": 9000, "iterations_since_restore": 9}
{"episode_reward_max": -1933.0, "episode_reward_min": -13801.0, "episode_reward_mean": -8782.333333333334, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8856745107105192, "mean_processing_ms": 0.18718472749190057, "mean_inference_ms": 0.8869019167982266}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.118, "max_exploration": 0.118, "num_target_updates": 19, "num_steps_trained": 72000, "num_steps_sampled": 10000, "sample_time_ms": 14.91, "replay_time_ms": 4.353, "grad_time_ms": 6.657, "update_time_ms": 6.202, "opt_peak_throughput": 4807.329, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -173.47959899902344, "min_q": -374.848876953125, "max_q": -7.7698516845703125, "mean_td_error": -12.687727928161621}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 10000, "episodes_total": 9, "training_iteration": 10, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-34-50", "timestamp": 1565080490, "time_this_iter_s": 7.235108137130737, "time_total_s": 80.56184315681458, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 80.56184315681458, "timesteps_since_restore": 10000, "iterations_since_restore": 10}
{"episode_reward_max": -1933.0, "episode_reward_min": -13801.0, "episode_reward_mean": -8617.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8775255423426831, "mean_processing_ms": 0.18627855425004514, "mean_inference_ms": 0.8792133634984575}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 21, "num_steps_trained": 80000, "num_steps_sampled": 11000, "sample_time_ms": 16.832, "replay_time_ms": 5.482, "grad_time_ms": 8.331, "update_time_ms": 7.617, "opt_peak_throughput": 3841.169, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -160.71377563476562, "min_q": -433.4580993652344, "max_q": -7.234657287597656, "mean_td_error": -3.338672161102295}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 11000, "episodes_total": 10, "training_iteration": 11, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-34-59", "timestamp": 1565080499, "time_this_iter_s": 8.537630558013916, "time_total_s": 89.09947371482849, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 89.09947371482849, "timesteps_since_restore": 11000, "iterations_since_restore": 11}
{"episode_reward_max": -1933.0, "episode_reward_min": -13801.0, "episode_reward_mean": -8355.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8701251093355838, "mean_processing_ms": 0.18545853323887337, "mean_inference_ms": 0.8724196879051394}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 23, "num_steps_trained": 88000, "num_steps_sampled": 12000, "sample_time_ms": 12.441, "replay_time_ms": 4.147, "grad_time_ms": 6.055, "update_time_ms": 6.047, "opt_peak_throughput": 5284.454, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -143.8329315185547, "min_q": -454.7765808105469, "max_q": -7.37349796295166, "mean_td_error": -3.8195834159851074}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 12000, "episodes_total": 11, "training_iteration": 12, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-35-07", "timestamp": 1565080507, "time_this_iter_s": 7.648530960083008, "time_total_s": 96.7480046749115, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 96.7480046749115, "timesteps_since_restore": 12000, "iterations_since_restore": 12}
{"episode_reward_max": -1933.0, "episode_reward_min": -13801.0, "episode_reward_mean": -7850.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8636969883787166, "mean_processing_ms": 0.18483347997542895, "mean_inference_ms": 0.866908726745152}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 25, "num_steps_trained": 96000, "num_steps_sampled": 13000, "sample_time_ms": 12.572, "replay_time_ms": 4.138, "grad_time_ms": 6.145, "update_time_ms": 6.446, "opt_peak_throughput": 5207.263, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -180.3436279296875, "min_q": -495.4909362792969, "max_q": -10.309470176696777, "mean_td_error": 8.211186408996582}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 13000, "episodes_total": 12, "training_iteration": 13, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-35-15", "timestamp": 1565080515, "time_this_iter_s": 8.081707239151001, "time_total_s": 104.8297119140625, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 104.8297119140625, "timesteps_since_restore": 13000, "iterations_since_restore": 13}
{"episode_reward_max": -1933.0, "episode_reward_min": -13801.0, "episode_reward_mean": -7435.692307692308, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8576901746160813, "mean_processing_ms": 0.18426951293286675, "mean_inference_ms": 0.8618939495533019}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 27, "num_steps_trained": 104000, "num_steps_sampled": 14000, "sample_time_ms": 13.098, "replay_time_ms": 4.566, "grad_time_ms": 6.334, "update_time_ms": 5.625, "opt_peak_throughput": 5052.066, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -100.7897720336914, "min_q": -431.429931640625, "max_q": -7.066083908081055, "mean_td_error": -1.0071918964385986}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 14000, "episodes_total": 13, "training_iteration": 14, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-35-22", "timestamp": 1565080522, "time_this_iter_s": 7.636777400970459, "time_total_s": 112.46648931503296, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 112.46648931503296, "timesteps_since_restore": 14000, "iterations_since_restore": 14}
{"episode_reward_max": -1840.0, "episode_reward_min": -13801.0, "episode_reward_mean": -7036.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8521399065195429, "mean_processing_ms": 0.1837578449039636, "mean_inference_ms": 0.8573577019837751}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 29, "num_steps_trained": 112000, "num_steps_sampled": 15000, "sample_time_ms": 11.959, "replay_time_ms": 4.207, "grad_time_ms": 6.035, "update_time_ms": 6.043, "opt_peak_throughput": 5302.219, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.8758544921875, "min_q": -481.9824523925781, "max_q": -17.579986572265625, "mean_td_error": 2.3335816860198975}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 15000, "episodes_total": 14, "training_iteration": 15, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-35-30", "timestamp": 1565080530, "time_this_iter_s": 7.647915601730347, "time_total_s": 120.1144049167633, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 120.1144049167633, "timesteps_since_restore": 15000, "iterations_since_restore": 15}
{"episode_reward_max": -1840.0, "episode_reward_min": -13801.0, "episode_reward_mean": -6718.066666666667, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8470333600844955, "mean_processing_ms": 0.1833033074707422, "mean_inference_ms": 0.8533519823394157}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 31, "num_steps_trained": 120000, "num_steps_sampled": 16000, "sample_time_ms": 12.485, "replay_time_ms": 4.316, "grad_time_ms": 6.147, "update_time_ms": 6.016, "opt_peak_throughput": 5206.071, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -121.16134643554688, "min_q": -527.9390258789062, "max_q": -10.904987335205078, "mean_td_error": -13.607320785522461}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 16000, "episodes_total": 15, "training_iteration": 16, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-35-38", "timestamp": 1565080538, "time_this_iter_s": 7.852212905883789, "time_total_s": 127.9666178226471, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 127.9666178226471, "timesteps_since_restore": 16000, "iterations_since_restore": 16}
{"episode_reward_max": -1741.0, "episode_reward_min": -13801.0, "episode_reward_mean": -6407.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8423493340259935, "mean_processing_ms": 0.18289360892924994, "mean_inference_ms": 0.8497188292858768}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 33, "num_steps_trained": 128000, "num_steps_sampled": 17000, "sample_time_ms": 12.204, "replay_time_ms": 3.841, "grad_time_ms": 5.634, "update_time_ms": 6.164, "opt_peak_throughput": 5679.948, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -145.43185424804688, "min_q": -523.14892578125, "max_q": -12.149375915527344, "mean_td_error": -31.689998626708984}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 17000, "episodes_total": 16, "training_iteration": 17, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-35-45", "timestamp": 1565080545, "time_this_iter_s": 7.743417263031006, "time_total_s": 135.7100350856781, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 135.7100350856781, "timesteps_since_restore": 17000, "iterations_since_restore": 17}
{"episode_reward_max": -1741.0, "episode_reward_min": -13801.0, "episode_reward_mean": -6145.882352941177, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8380255686586392, "mean_processing_ms": 0.18251396149942992, "mean_inference_ms": 0.8464465598609903}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 35, "num_steps_trained": 136000, "num_steps_sampled": 18000, "sample_time_ms": 13.406, "replay_time_ms": 4.316, "grad_time_ms": 6.261, "update_time_ms": 5.813, "opt_peak_throughput": 5111.343, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -171.2056884765625, "min_q": -638.9678344726562, "max_q": -14.448166847229004, "mean_td_error": 9.936091423034668}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 18000, "episodes_total": 17, "training_iteration": 18, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-35-53", "timestamp": 1565080553, "time_this_iter_s": 7.7176573276519775, "time_total_s": 143.42769241333008, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 143.42769241333008, "timesteps_since_restore": 18000, "iterations_since_restore": 18}
{"episode_reward_max": -1741.0, "episode_reward_min": -13801.0, "episode_reward_mean": -5921.222222222223, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8337838186885126, "mean_processing_ms": 0.1821101600598155, "mean_inference_ms": 0.8432078411815429}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 37, "num_steps_trained": 144000, "num_steps_sampled": 19000, "sample_time_ms": 12.142, "replay_time_ms": 5.04, "grad_time_ms": 6.352, "update_time_ms": 6.373, "opt_peak_throughput": 5037.579, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -145.7769012451172, "min_q": -631.9727172851562, "max_q": -17.662233352661133, "mean_td_error": -7.925799369812012}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 19000, "episodes_total": 18, "training_iteration": 19, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-36-00", "timestamp": 1565080560, "time_this_iter_s": 7.061749696731567, "time_total_s": 150.48944211006165, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 150.48944211006165, "timesteps_since_restore": 19000, "iterations_since_restore": 19}
{"episode_reward_max": -1741.0, "episode_reward_min": -13801.0, "episode_reward_mean": -5726.0526315789475, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8300043427066606, "mean_processing_ms": 0.181775178451623, "mean_inference_ms": 0.8403425394024636}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 39, "num_steps_trained": 152000, "num_steps_sampled": 20000, "sample_time_ms": 13.39, "replay_time_ms": 4.601, "grad_time_ms": 6.556, "update_time_ms": 6.937, "opt_peak_throughput": 4881.213, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -92.02820587158203, "min_q": -576.7257080078125, "max_q": -20.059406280517578, "mean_td_error": -5.172176361083984}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 20000, "episodes_total": 19, "training_iteration": 20, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-36-09", "timestamp": 1565080569, "time_this_iter_s": 8.31907320022583, "time_total_s": 158.80851531028748, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 158.80851531028748, "timesteps_since_restore": 20000, "iterations_since_restore": 20}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -5520.95, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8264539331808193, "mean_processing_ms": 0.1814535881398148, "mean_inference_ms": 0.8376520842141442}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 41, "num_steps_trained": 160000, "num_steps_sampled": 21000, "sample_time_ms": 13.193, "replay_time_ms": 3.427, "grad_time_ms": 5.391, "update_time_ms": 5.423, "opt_peak_throughput": 5936.316, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -200.13284301757812, "min_q": -762.4834594726562, "max_q": -28.655763626098633, "mean_td_error": -17.31595230102539}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 21000, "episodes_total": 20, "training_iteration": 21, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-36-16", "timestamp": 1565080576, "time_this_iter_s": 7.5039896965026855, "time_total_s": 166.31250500679016, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 166.31250500679016, "timesteps_since_restore": 21000, "iterations_since_restore": 21}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -5389.238095238095, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8230027828341794, "mean_processing_ms": 0.18112251909822405, "mean_inference_ms": 0.8350179949427602}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 43, "num_steps_trained": 168000, "num_steps_sampled": 22000, "sample_time_ms": 11.486, "replay_time_ms": 3.676, "grad_time_ms": 5.564, "update_time_ms": 5.741, "opt_peak_throughput": 5751.112, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -202.78271484375, "min_q": -718.239013671875, "max_q": -26.1156063079834, "mean_td_error": -4.136598110198975}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 22000, "episodes_total": 21, "training_iteration": 22, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-36-23", "timestamp": 1565080583, "time_this_iter_s": 7.1706013679504395, "time_total_s": 173.4831063747406, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 173.4831063747406, "timesteps_since_restore": 22000, "iterations_since_restore": 22}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -5229.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8197270286331556, "mean_processing_ms": 0.1807967109383212, "mean_inference_ms": 0.8325196928490304}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 45, "num_steps_trained": 176000, "num_steps_sampled": 23000, "sample_time_ms": 11.825, "replay_time_ms": 3.83, "grad_time_ms": 5.865, "update_time_ms": 6.438, "opt_peak_throughput": 5455.717, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -118.8681640625, "min_q": -666.8901977539062, "max_q": -34.28456497192383, "mean_td_error": -1.7934067249298096}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 23000, "episodes_total": 22, "training_iteration": 23, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-36-30", "timestamp": 1565080590, "time_this_iter_s": 7.144251823425293, "time_total_s": 180.6273581981659, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 180.6273581981659, "timesteps_since_restore": 23000, "iterations_since_restore": 23}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -5169.565217391304, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8168489660708953, "mean_processing_ms": 0.18054212240281575, "mean_inference_ms": 0.8303768227738925}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 47, "num_steps_trained": 184000, "num_steps_sampled": 24000, "sample_time_ms": 14.326, "replay_time_ms": 4.37, "grad_time_ms": 6.509, "update_time_ms": 6.49, "opt_peak_throughput": 4915.95, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -232.7720947265625, "min_q": -801.1506958007812, "max_q": -29.23328399658203, "mean_td_error": -7.178241729736328}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 24000, "episodes_total": 23, "training_iteration": 24, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-36-39", "timestamp": 1565080599, "time_this_iter_s": 8.581474542617798, "time_total_s": 189.2088327407837, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 189.2088327407837, "timesteps_since_restore": 24000, "iterations_since_restore": 24}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -5030.333333333333, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8140445691404699, "mean_processing_ms": 0.18027603251951732, "mean_inference_ms": 0.8282646932562555}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 49, "num_steps_trained": 192000, "num_steps_sampled": 25000, "sample_time_ms": 11.908, "replay_time_ms": 3.661, "grad_time_ms": 5.625, "update_time_ms": 5.896, "opt_peak_throughput": 5688.807, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -156.21820068359375, "min_q": -832.9952392578125, "max_q": -31.444293975830078, "mean_td_error": -2.62860107421875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 25000, "episodes_total": 24, "training_iteration": 25, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-36-46", "timestamp": 1565080606, "time_this_iter_s": 7.081641674041748, "time_total_s": 196.29047441482544, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 196.29047441482544, "timesteps_since_restore": 25000, "iterations_since_restore": 25}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4956.32, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8114669564566084, "mean_processing_ms": 0.18004159364475697, "mean_inference_ms": 0.8263361324911971}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 51, "num_steps_trained": 200000, "num_steps_sampled": 26000, "sample_time_ms": 15.691, "replay_time_ms": 5.802, "grad_time_ms": 7.771, "update_time_ms": 7.508, "opt_peak_throughput": 4117.955, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -166.41098022460938, "min_q": -793.7030029296875, "max_q": -28.56890296936035, "mean_td_error": 5.782724857330322}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 26000, "episodes_total": 25, "training_iteration": 26, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-36-54", "timestamp": 1565080614, "time_this_iter_s": 7.954469680786133, "time_total_s": 204.24494409561157, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 204.24494409561157, "timesteps_since_restore": 26000, "iterations_since_restore": 26}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4845.346153846154, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8090543132101841, "mean_processing_ms": 0.1798256487804474, "mean_inference_ms": 0.8245515378991537}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 53, "num_steps_trained": 208000, "num_steps_sampled": 27000, "sample_time_ms": 12.355, "replay_time_ms": 4.319, "grad_time_ms": 6.689, "update_time_ms": 6.262, "opt_peak_throughput": 4784.144, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -171.58087158203125, "min_q": -850.696044921875, "max_q": -28.517486572265625, "mean_td_error": -6.057171821594238}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 27000, "episodes_total": 26, "training_iteration": 27, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-37-02", "timestamp": 1565080622, "time_this_iter_s": 7.959766387939453, "time_total_s": 212.20471048355103, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 212.20471048355103, "timesteps_since_restore": 27000, "iterations_since_restore": 27}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4745.2962962962965, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8066929787718905, "mean_processing_ms": 0.1796060016804805, "mean_inference_ms": 0.8228022106102953}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 55, "num_steps_trained": 216000, "num_steps_sampled": 28000, "sample_time_ms": 12.975, "replay_time_ms": 4.986, "grad_time_ms": 6.334, "update_time_ms": 6.146, "opt_peak_throughput": 5052.37, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -152.0804443359375, "min_q": -794.7818603515625, "max_q": -30.344358444213867, "mean_td_error": -10.77859115600586}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 28000, "episodes_total": 27, "training_iteration": 28, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-37-09", "timestamp": 1565080629, "time_this_iter_s": 7.149505853652954, "time_total_s": 219.35421633720398, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 219.35421633720398, "timesteps_since_restore": 28000, "iterations_since_restore": 28}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4648.642857142857, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8043696861112012, "mean_processing_ms": 0.1793776317782097, "mean_inference_ms": 0.8210730852957797}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 57, "num_steps_trained": 224000, "num_steps_sampled": 29000, "sample_time_ms": 13.424, "replay_time_ms": 4.546, "grad_time_ms": 6.239, "update_time_ms": 5.766, "opt_peak_throughput": 5128.785, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -204.96121215820312, "min_q": -869.4562377929688, "max_q": -39.881263732910156, "mean_td_error": -17.90243911743164}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 29000, "episodes_total": 28, "training_iteration": 29, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-37-16", "timestamp": 1565080636, "time_this_iter_s": 7.060108661651611, "time_total_s": 226.4143249988556, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 226.4143249988556, "timesteps_since_restore": 29000, "iterations_since_restore": 29}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4570.689655172414, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8022176447181946, "mean_processing_ms": 0.17917376495076273, "mean_inference_ms": 0.8194584672095664}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 59, "num_steps_trained": 232000, "num_steps_sampled": 30000, "sample_time_ms": 12.857, "replay_time_ms": 5.042, "grad_time_ms": 6.707, "update_time_ms": 6.47, "opt_peak_throughput": 4771.439, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -112.46458435058594, "min_q": -904.1813354492188, "max_q": -31.67684555053711, "mean_td_error": -3.317615270614624}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 30000, "episodes_total": 29, "training_iteration": 30, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-37-25", "timestamp": 1565080645, "time_this_iter_s": 8.331594705581665, "time_total_s": 234.74591970443726, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 234.74591970443726, "timesteps_since_restore": 30000, "iterations_since_restore": 30}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4484.766666666666, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.8001551268190251, "mean_processing_ms": 0.17897790735038685, "mean_inference_ms": 0.8179258415852857}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 61, "num_steps_trained": 240000, "num_steps_sampled": 31000, "sample_time_ms": 13.881, "replay_time_ms": 4.687, "grad_time_ms": 6.075, "update_time_ms": 6.207, "opt_peak_throughput": 5267.448, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -129.51004028320312, "min_q": -937.390380859375, "max_q": -32.982845306396484, "mean_td_error": -19.658784866333008}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 31000, "episodes_total": 30, "training_iteration": 31, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-37-32", "timestamp": 1565080652, "time_this_iter_s": 7.598873615264893, "time_total_s": 242.34479331970215, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 242.34479331970215, "timesteps_since_restore": 31000, "iterations_since_restore": 31}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4400.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7981735555954684, "mean_processing_ms": 0.17878576678083902, "mean_inference_ms": 0.8164460189601885}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 63, "num_steps_trained": 248000, "num_steps_sampled": 32000, "sample_time_ms": 13.863, "replay_time_ms": 5.16, "grad_time_ms": 6.98, "update_time_ms": 7.389, "opt_peak_throughput": 4584.659, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -146.68948364257812, "min_q": -738.353759765625, "max_q": -38.10440444946289, "mean_td_error": 1.1471060514450073}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 32000, "episodes_total": 31, "training_iteration": 32, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-37-40", "timestamp": 1565080660, "time_this_iter_s": 7.6390721797943115, "time_total_s": 249.98386549949646, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 249.98386549949646, "timesteps_since_restore": 32000, "iterations_since_restore": 32}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4365.3125, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7964571562830078, "mean_processing_ms": 0.17863422788331557, "mean_inference_ms": 0.815175976405478}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 65, "num_steps_trained": 256000, "num_steps_sampled": 33000, "sample_time_ms": 15.375, "replay_time_ms": 5.89, "grad_time_ms": 7.771, "update_time_ms": 6.957, "opt_peak_throughput": 4117.778, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -143.62815856933594, "min_q": -649.8255615234375, "max_q": -40.64728927612305, "mean_td_error": 3.8641247749328613}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 33000, "episodes_total": 32, "training_iteration": 33, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-37-49", "timestamp": 1565080669, "time_this_iter_s": 9.244696617126465, "time_total_s": 259.2285621166229, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 259.2285621166229, "timesteps_since_restore": 33000, "iterations_since_restore": 33}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4333.121212121212, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.79485441573527, "mean_processing_ms": 0.17850108225435238, "mean_inference_ms": 0.8140112387328425}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 67, "num_steps_trained": 264000, "num_steps_sampled": 34000, "sample_time_ms": 12.791, "replay_time_ms": 4.39, "grad_time_ms": 6.048, "update_time_ms": 5.847, "opt_peak_throughput": 5290.953, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -123.9237289428711, "min_q": -758.5245971679688, "max_q": -40.02368927001953, "mean_td_error": -2.077695846557617}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 34000, "episodes_total": 33, "training_iteration": 34, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-37-57", "timestamp": 1565080677, "time_this_iter_s": 8.171550273895264, "time_total_s": 267.4001123905182, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 267.4001123905182, "timesteps_since_restore": 34000, "iterations_since_restore": 34}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4254.205882352941, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7933176301522432, "mean_processing_ms": 0.17837180040753173, "mean_inference_ms": 0.812893208147577}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 69, "num_steps_trained": 272000, "num_steps_sampled": 35000, "sample_time_ms": 12.205, "replay_time_ms": 4.125, "grad_time_ms": 6.166, "update_time_ms": 6.01, "opt_peak_throughput": 5189.706, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -138.81906127929688, "min_q": -632.3441772460938, "max_q": -43.09492111206055, "mean_td_error": 1.748896837234497}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 35000, "episodes_total": 34, "training_iteration": 35, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-38-05", "timestamp": 1565080685, "time_this_iter_s": 7.697469234466553, "time_total_s": 275.09758162498474, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 275.09758162498474, "timesteps_since_restore": 35000, "iterations_since_restore": 35}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4199.142857142857, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7918983848621978, "mean_processing_ms": 0.178257523850147, "mean_inference_ms": 0.8118631933835194}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 71, "num_steps_trained": 280000, "num_steps_sampled": 36000, "sample_time_ms": 18.305, "replay_time_ms": 6.335, "grad_time_ms": 8.348, "update_time_ms": 8.34, "opt_peak_throughput": 3833.325, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -189.45651245117188, "min_q": -843.3834838867188, "max_q": -44.01283645629883, "mean_td_error": 1.1512752771377563}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 36000, "episodes_total": 35, "training_iteration": 36, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-38-13", "timestamp": 1565080693, "time_this_iter_s": 8.307957649230957, "time_total_s": 283.4055392742157, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 283.4055392742157, "timesteps_since_restore": 36000, "iterations_since_restore": 36}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4138.694444444444, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7906284550041215, "mean_processing_ms": 0.17816729617911775, "mean_inference_ms": 0.8109482066874155}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 73, "num_steps_trained": 288000, "num_steps_sampled": 37000, "sample_time_ms": 13.459, "replay_time_ms": 4.699, "grad_time_ms": 6.086, "update_time_ms": 6.004, "opt_peak_throughput": 5258.285, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -130.85565185546875, "min_q": -1000.35888671875, "max_q": -47.49436950683594, "mean_td_error": -18.1461181640625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 37000, "episodes_total": 36, "training_iteration": 37, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-38-22", "timestamp": 1565080702, "time_this_iter_s": 8.88670539855957, "time_total_s": 292.29224467277527, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 292.29224467277527, "timesteps_since_restore": 37000, "iterations_since_restore": 37}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4092.6486486486488, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7894539107452916, "mean_processing_ms": 0.17809378552568372, "mean_inference_ms": 0.8101054059569968}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 75, "num_steps_trained": 296000, "num_steps_sampled": 38000, "sample_time_ms": 13.965, "replay_time_ms": 4.936, "grad_time_ms": 6.497, "update_time_ms": 5.989, "opt_peak_throughput": 4925.421, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -214.3575897216797, "min_q": -1065.2392578125, "max_q": -45.773258209228516, "mean_td_error": -0.6760830879211426}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 38000, "episodes_total": 37, "training_iteration": 38, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-38-31", "timestamp": 1565080711, "time_this_iter_s": 8.489004611968994, "time_total_s": 300.78124928474426, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 300.78124928474426, "timesteps_since_restore": 38000, "iterations_since_restore": 38}
{"episode_reward_max": -1624.0, "episode_reward_min": -13801.0, "episode_reward_mean": -4031.184210526316, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7883667747809516, "mean_processing_ms": 0.1780353529817937, "mean_inference_ms": 0.8093360496904576}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 77, "num_steps_trained": 304000, "num_steps_sampled": 39000, "sample_time_ms": 13.889, "replay_time_ms": 4.616, "grad_time_ms": 6.573, "update_time_ms": 5.851, "opt_peak_throughput": 4868.359, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -246.77537536621094, "min_q": -969.5747680664062, "max_q": -47.83142852783203, "mean_td_error": -11.242406845092773}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 39000, "episodes_total": 38, "training_iteration": 39, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-38-39", "timestamp": 1565080719, "time_this_iter_s": 8.496718406677246, "time_total_s": 309.2779676914215, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 309.2779676914215, "timesteps_since_restore": 39000, "iterations_since_restore": 39}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3965.3333333333335, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7873125309418278, "mean_processing_ms": 0.17797780224483992, "mean_inference_ms": 0.8085895843928146}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 79, "num_steps_trained": 312000, "num_steps_sampled": 40000, "sample_time_ms": 14.964, "replay_time_ms": 4.884, "grad_time_ms": 7.077, "update_time_ms": 6.748, "opt_peak_throughput": 4521.506, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -139.22879028320312, "min_q": -774.5833740234375, "max_q": -50.6434211730957, "mean_td_error": 3.1211142539978027}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 40000, "episodes_total": 39, "training_iteration": 40, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-38-47", "timestamp": 1565080727, "time_this_iter_s": 7.74426794052124, "time_total_s": 317.02223563194275, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 317.02223563194275, "timesteps_since_restore": 40000, "iterations_since_restore": 40}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3922.45, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7862780662099903, "mean_processing_ms": 0.17791784378744785, "mean_inference_ms": 0.8078522344611734}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 81, "num_steps_trained": 320000, "num_steps_sampled": 41000, "sample_time_ms": 14.564, "replay_time_ms": 4.873, "grad_time_ms": 6.974, "update_time_ms": 6.928, "opt_peak_throughput": 4588.358, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -229.26724243164062, "min_q": -1057.3914794921875, "max_q": -49.94873046875, "mean_td_error": 0.651945948600769}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 41000, "episodes_total": 40, "training_iteration": 41, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-38-55", "timestamp": 1565080735, "time_this_iter_s": 7.649036407470703, "time_total_s": 324.67127203941345, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 324.67127203941345, "timesteps_since_restore": 41000, "iterations_since_restore": 41}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3902.5365853658536, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7852448681907843, "mean_processing_ms": 0.177851680988813, "mean_inference_ms": 0.8071084142509551}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 83, "num_steps_trained": 328000, "num_steps_sampled": 42000, "sample_time_ms": 12.538, "replay_time_ms": 4.828, "grad_time_ms": 6.208, "update_time_ms": 5.409, "opt_peak_throughput": 5154.469, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -252.48886108398438, "min_q": -1133.7672119140625, "max_q": -57.990745544433594, "mean_td_error": 8.054990768432617}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 42000, "episodes_total": 41, "training_iteration": 42, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-39-02", "timestamp": 1565080742, "time_this_iter_s": 7.284423828125, "time_total_s": 331.95569586753845, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 331.95569586753845, "timesteps_since_restore": 42000, "iterations_since_restore": 42}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3866.5476190476193, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7842106731991765, "mean_processing_ms": 0.17777853390360251, "mean_inference_ms": 0.80635938274998}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 85, "num_steps_trained": 336000, "num_steps_sampled": 43000, "sample_time_ms": 12.521, "replay_time_ms": 3.891, "grad_time_ms": 5.927, "update_time_ms": 5.975, "opt_peak_throughput": 5399.421, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -201.25543212890625, "min_q": -1131.8956298828125, "max_q": -51.57257843017578, "mean_td_error": -29.429443359375}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 43000, "episodes_total": 42, "training_iteration": 43, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-39-09", "timestamp": 1565080749, "time_this_iter_s": 7.130663633346558, "time_total_s": 339.086359500885, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 339.086359500885, "timesteps_since_restore": 43000, "iterations_since_restore": 43}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3840.4418604651164, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.783203554186442, "mean_processing_ms": 0.17770633867426563, "mean_inference_ms": 0.8056310220971697}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 87, "num_steps_trained": 344000, "num_steps_sampled": 44000, "sample_time_ms": 15.304, "replay_time_ms": 5.911, "grad_time_ms": 7.557, "update_time_ms": 6.636, "opt_peak_throughput": 4234.465, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -114.22504425048828, "min_q": -681.9376220703125, "max_q": -51.78559875488281, "mean_td_error": 2.0680954456329346}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 44000, "episodes_total": 43, "training_iteration": 44, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-39-17", "timestamp": 1565080757, "time_this_iter_s": 7.624878883361816, "time_total_s": 346.7112383842468, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 346.7112383842468, "timesteps_since_restore": 44000, "iterations_since_restore": 44}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3799.4545454545455, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7822519721271892, "mean_processing_ms": 0.17764155195124853, "mean_inference_ms": 0.8049477668534023}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 89, "num_steps_trained": 352000, "num_steps_sampled": 45000, "sample_time_ms": 12.882, "replay_time_ms": 4.151, "grad_time_ms": 5.939, "update_time_ms": 5.63, "opt_peak_throughput": 5388.561, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -153.59463500976562, "min_q": -1151.00830078125, "max_q": -53.480525970458984, "mean_td_error": -3.2411131858825684}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 45000, "episodes_total": 44, "training_iteration": 45, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-39-25", "timestamp": 1565080765, "time_this_iter_s": 8.147762060165405, "time_total_s": 354.85900044441223, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 354.85900044441223, "timesteps_since_restore": 45000, "iterations_since_restore": 45}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3768.688888888889, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7813250319589466, "mean_processing_ms": 0.17757650241202716, "mean_inference_ms": 0.8042730697775876}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 91, "num_steps_trained": 360000, "num_steps_sampled": 46000, "sample_time_ms": 12.829, "replay_time_ms": 4.252, "grad_time_ms": 5.882, "update_time_ms": 6.308, "opt_peak_throughput": 5440.392, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -204.57015991210938, "min_q": -1132.6849365234375, "max_q": -62.80583572387695, "mean_td_error": -2.1488664150238037}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 46000, "episodes_total": 45, "training_iteration": 46, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-39-33", "timestamp": 1565080773, "time_this_iter_s": 7.681084632873535, "time_total_s": 362.54008507728577, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 362.54008507728577, "timesteps_since_restore": 46000, "iterations_since_restore": 46}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3734.695652173913, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7804219229928911, "mean_processing_ms": 0.1775117227467691, "mean_inference_ms": 0.8036153018236873}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 93, "num_steps_trained": 368000, "num_steps_sampled": 47000, "sample_time_ms": 13.804, "replay_time_ms": 4.512, "grad_time_ms": 5.651, "update_time_ms": 6.227, "opt_peak_throughput": 5662.885, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -159.3276824951172, "min_q": -789.9471435546875, "max_q": -53.10926818847656, "mean_td_error": 11.951065063476562}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 47000, "episodes_total": 46, "training_iteration": 47, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-39-40", "timestamp": 1565080780, "time_this_iter_s": 7.727551460266113, "time_total_s": 370.2676365375519, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 370.2676365375519, "timesteps_since_restore": 47000, "iterations_since_restore": 47}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3705.744680851064, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7795484980637238, "mean_processing_ms": 0.17744838401550012, "mean_inference_ms": 0.8029780476436081}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 95, "num_steps_trained": 376000, "num_steps_sampled": 48000, "sample_time_ms": 13.77, "replay_time_ms": 4.211, "grad_time_ms": 5.909, "update_time_ms": 5.68, "opt_peak_throughput": 5415.652, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -220.60665893554688, "min_q": -992.3047485351562, "max_q": -52.95393371582031, "mean_td_error": 0.9126566648483276}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 48000, "episodes_total": 47, "training_iteration": 48, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-39-48", "timestamp": 1565080788, "time_this_iter_s": 7.7763283252716064, "time_total_s": 378.0439648628235, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 378.0439648628235, "timesteps_since_restore": 48000, "iterations_since_restore": 48}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3778.9375, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7787072497550808, "mean_processing_ms": 0.17738870292536593, "mean_inference_ms": 0.8023685732171133}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 97, "num_steps_trained": 384000, "num_steps_sampled": 49000, "sample_time_ms": 13.112, "replay_time_ms": 5.02, "grad_time_ms": 5.85, "update_time_ms": 5.805, "opt_peak_throughput": 5469.791, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -188.38311767578125, "min_q": -1104.9945068359375, "max_q": -52.2099494934082, "mean_td_error": -5.846660137176514}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 49000, "episodes_total": 48, "training_iteration": 49, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-39-56", "timestamp": 1565080796, "time_this_iter_s": 7.756844520568848, "time_total_s": 385.80080938339233, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 385.80080938339233, "timesteps_since_restore": 49000, "iterations_since_restore": 49}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3733.469387755102, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7778592433824596, "mean_processing_ms": 0.17732364083433064, "mean_inference_ms": 0.8017608484158831}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 99, "num_steps_trained": 392000, "num_steps_sampled": 50000, "sample_time_ms": 13.102, "replay_time_ms": 4.326, "grad_time_ms": 5.903, "update_time_ms": 5.773, "opt_peak_throughput": 5420.529, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -122.00485229492188, "min_q": -1119.6177978515625, "max_q": -52.225791931152344, "mean_td_error": -1.5825830698013306}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 50000, "episodes_total": 49, "training_iteration": 50, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-40-03", "timestamp": 1565080803, "time_this_iter_s": 7.160525560379028, "time_total_s": 392.96133494377136, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 392.96133494377136, "timesteps_since_restore": 50000, "iterations_since_restore": 50}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3690.2, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7770553890636329, "mean_processing_ms": 0.177264755609813, "mean_inference_ms": 0.801182711130705}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 101, "num_steps_trained": 400000, "num_steps_sampled": 51000, "sample_time_ms": 16.408, "replay_time_ms": 5.776, "grad_time_ms": 7.212, "update_time_ms": 6.955, "opt_peak_throughput": 4437.346, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -140.40191650390625, "min_q": -1053.5302734375, "max_q": -54.69392395019531, "mean_td_error": -6.742410182952881}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 51000, "episodes_total": 50, "training_iteration": 51, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-40-11", "timestamp": 1565080811, "time_this_iter_s": 8.1762056350708, "time_total_s": 401.13754057884216, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 401.13754057884216, "timesteps_since_restore": 51000, "iterations_since_restore": 51}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3665.5686274509803, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7762695642594535, "mean_processing_ms": 0.17720639463968504, "mean_inference_ms": 0.800617251067317}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 103, "num_steps_trained": 408000, "num_steps_sampled": 52000, "sample_time_ms": 12.111, "replay_time_ms": 4.185, "grad_time_ms": 5.844, "update_time_ms": 5.959, "opt_peak_throughput": 5476.129, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -222.3415069580078, "min_q": -1194.5157470703125, "max_q": -56.3743782043457, "mean_td_error": 7.001308917999268}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 52000, "episodes_total": 51, "training_iteration": 52, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-40-19", "timestamp": 1565080819, "time_this_iter_s": 7.667953252792358, "time_total_s": 408.8054938316345, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 408.8054938316345, "timesteps_since_restore": 52000, "iterations_since_restore": 52}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3647.9615384615386, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7755535434129132, "mean_processing_ms": 0.17715966191401414, "mean_inference_ms": 0.8001063921177997}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 105, "num_steps_trained": 416000, "num_steps_sampled": 53000, "sample_time_ms": 15.558, "replay_time_ms": 5.421, "grad_time_ms": 7.586, "update_time_ms": 7.687, "opt_peak_throughput": 4218.044, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -125.98815155029297, "min_q": -855.08251953125, "max_q": -59.52978515625, "mean_td_error": 5.34278678894043}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 53000, "episodes_total": 52, "training_iteration": 53, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-40-28", "timestamp": 1565080828, "time_this_iter_s": 8.995666027069092, "time_total_s": 417.8011598587036, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 417.8011598587036, "timesteps_since_restore": 53000, "iterations_since_restore": 53}
{"episode_reward_max": -1463.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3618.8490566037735, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7748820934299167, "mean_processing_ms": 0.17712057624380553, "mean_inference_ms": 0.7996393831130741}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 107, "num_steps_trained": 424000, "num_steps_sampled": 54000, "sample_time_ms": 13.721, "replay_time_ms": 4.699, "grad_time_ms": 6.08, "update_time_ms": 5.766, "opt_peak_throughput": 5263.11, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -125.83514404296875, "min_q": -578.0438232421875, "max_q": -59.02885437011719, "mean_td_error": 2.2372279167175293}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 54000, "episodes_total": 53, "training_iteration": 54, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-40-36", "timestamp": 1565080836, "time_this_iter_s": 8.44796109199524, "time_total_s": 426.24912095069885, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 426.24912095069885, "timesteps_since_restore": 54000, "iterations_since_restore": 54}
{"episode_reward_max": -1340.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3576.6481481481483, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.774247383608175, "mean_processing_ms": 0.17708308157607502, "mean_inference_ms": 0.7991864965197353}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 109, "num_steps_trained": 432000, "num_steps_sampled": 55000, "sample_time_ms": 12.133, "replay_time_ms": 4.79, "grad_time_ms": 6.493, "update_time_ms": 6.221, "opt_peak_throughput": 4928.098, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -157.74649047851562, "min_q": -1150.104736328125, "max_q": -58.26656723022461, "mean_td_error": 0.9542607069015503}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 55000, "episodes_total": 54, "training_iteration": 55, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-40-44", "timestamp": 1565080844, "time_this_iter_s": 7.919123888015747, "time_total_s": 434.1682448387146, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 434.1682448387146, "timesteps_since_restore": 55000, "iterations_since_restore": 55}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3533.981818181818, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7736258910589762, "mean_processing_ms": 0.17704595998053738, "mean_inference_ms": 0.7987442839560533}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 111, "num_steps_trained": 440000, "num_steps_sampled": 56000, "sample_time_ms": 13.073, "replay_time_ms": 4.114, "grad_time_ms": 5.884, "update_time_ms": 6.254, "opt_peak_throughput": 5438.518, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -133.85397338867188, "min_q": -1046.8900146484375, "max_q": -64.6872787475586, "mean_td_error": -2.803321361541748}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 56000, "episodes_total": 55, "training_iteration": 56, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-40-52", "timestamp": 1565080852, "time_this_iter_s": 7.705569505691528, "time_total_s": 441.8738143444061, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 441.8738143444061, "timesteps_since_restore": 56000, "iterations_since_restore": 56}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3506.339285714286, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7730166558975525, "mean_processing_ms": 0.17700923605665644, "mean_inference_ms": 0.7983146651834978}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 113, "num_steps_trained": 448000, "num_steps_sampled": 57000, "sample_time_ms": 17.892, "replay_time_ms": 6.763, "grad_time_ms": 9.252, "update_time_ms": 8.818, "opt_peak_throughput": 3458.658, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -130.77774047851562, "min_q": -1128.9814453125, "max_q": -63.988956451416016, "mean_td_error": 6.766792297363281}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 57000, "episodes_total": 56, "training_iteration": 57, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-41-00", "timestamp": 1565080860, "time_this_iter_s": 7.816145420074463, "time_total_s": 449.6899597644806, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 449.6899597644806, "timesteps_since_restore": 57000, "iterations_since_restore": 57}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3468.2105263157896, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7724695720957618, "mean_processing_ms": 0.17698440762390744, "mean_inference_ms": 0.7979388729092473}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 115, "num_steps_trained": 456000, "num_steps_sampled": 58000, "sample_time_ms": 14.224, "replay_time_ms": 4.743, "grad_time_ms": 6.348, "update_time_ms": 6.653, "opt_peak_throughput": 5040.966, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -128.215576171875, "min_q": -1179.456298828125, "max_q": -62.74530792236328, "mean_td_error": 5.268803596496582}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 58000, "episodes_total": 57, "training_iteration": 58, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-41-09", "timestamp": 1565080869, "time_this_iter_s": 9.27929973602295, "time_total_s": 458.96925950050354, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 458.96925950050354, "timesteps_since_restore": 58000, "iterations_since_restore": 58}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3438.603448275862, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7719550836439666, "mean_processing_ms": 0.17696506849503843, "mean_inference_ms": 0.7975884091831774}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 117, "num_steps_trained": 464000, "num_steps_sampled": 59000, "sample_time_ms": 13.584, "replay_time_ms": 5.163, "grad_time_ms": 6.65, "update_time_ms": 6.922, "opt_peak_throughput": 4812.293, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.57518005371094, "min_q": -533.3739013671875, "max_q": -63.33895492553711, "mean_td_error": 3.225494146347046}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 59000, "episodes_total": 58, "training_iteration": 59, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-41-18", "timestamp": 1565080878, "time_this_iter_s": 8.508891582489014, "time_total_s": 467.47815108299255, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 467.47815108299255, "timesteps_since_restore": 59000, "iterations_since_restore": 59}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3416.8474576271187, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7714468220585441, "mean_processing_ms": 0.17694405029955004, "mean_inference_ms": 0.797239474683688}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 119, "num_steps_trained": 472000, "num_steps_sampled": 60000, "sample_time_ms": 14.535, "replay_time_ms": 5.225, "grad_time_ms": 6.619, "update_time_ms": 6.301, "opt_peak_throughput": 4834.636, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -141.62661743164062, "min_q": -521.4338989257812, "max_q": -64.02146911621094, "mean_td_error": -4.650104522705078}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 60000, "episodes_total": 59, "training_iteration": 60, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-41-25", "timestamp": 1565080885, "time_this_iter_s": 7.602309942245483, "time_total_s": 475.08046102523804, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 475.08046102523804, "timesteps_since_restore": 60000, "iterations_since_restore": 60}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3394.133333333333, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7709529514966338, "mean_processing_ms": 0.17692344537209218, "mean_inference_ms": 0.7969008897217665}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 121, "num_steps_trained": 480000, "num_steps_sampled": 61000, "sample_time_ms": 13.637, "replay_time_ms": 4.863, "grad_time_ms": 7.116, "update_time_ms": 6.511, "opt_peak_throughput": 4496.602, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -118.67654418945312, "min_q": -554.5768432617188, "max_q": -64.42923736572266, "mean_td_error": 0.25200212001800537}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 61000, "episodes_total": 60, "training_iteration": 61, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-41-33", "timestamp": 1565080893, "time_this_iter_s": 7.790303707122803, "time_total_s": 482.87076473236084, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 482.87076473236084, "timesteps_since_restore": 61000, "iterations_since_restore": 61}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3362.934426229508, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7704528443415178, "mean_processing_ms": 0.17689882609574115, "mean_inference_ms": 0.7965586811157719}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 123, "num_steps_trained": 488000, "num_steps_sampled": 62000, "sample_time_ms": 11.211, "replay_time_ms": 4.216, "grad_time_ms": 5.67, "update_time_ms": 5.226, "opt_peak_throughput": 5643.265, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -85.94715881347656, "min_q": -162.44369506835938, "max_q": -65.29496002197266, "mean_td_error": 1.2756320238113403}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 62000, "episodes_total": 61, "training_iteration": 62, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-41-40", "timestamp": 1565080900, "time_this_iter_s": 7.4391796588897705, "time_total_s": 490.3099443912506, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 490.3099443912506, "timesteps_since_restore": 62000, "iterations_since_restore": 62}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3339.4032258064517, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7699497846893495, "mean_processing_ms": 0.17687077527290593, "mean_inference_ms": 0.7962113438093458}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 125, "num_steps_trained": 496000, "num_steps_sampled": 63000, "sample_time_ms": 16.518, "replay_time_ms": 6.111, "grad_time_ms": 7.898, "update_time_ms": 7.562, "opt_peak_throughput": 4051.403, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -106.75257110595703, "min_q": -468.3434753417969, "max_q": -67.79559326171875, "mean_td_error": -2.064208984375}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 63000, "episodes_total": 62, "training_iteration": 63, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-41-48", "timestamp": 1565080908, "time_this_iter_s": 7.23240327835083, "time_total_s": 497.54234766960144, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 497.54234766960144, "timesteps_since_restore": 63000, "iterations_since_restore": 63}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3359.0158730158732, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7694703067582488, "mean_processing_ms": 0.17684589267010498, "mean_inference_ms": 0.7958850883552617}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 126, "num_steps_trained": 504000, "num_steps_sampled": 64000, "sample_time_ms": 13.205, "replay_time_ms": 4.585, "grad_time_ms": 6.445, "update_time_ms": 6.15, "opt_peak_throughput": 4965.436, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -113.51350402832031, "min_q": -852.4451904296875, "max_q": -65.47309112548828, "mean_td_error": -0.2545630931854248}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 64000, "episodes_total": 63, "training_iteration": 64, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-41-56", "timestamp": 1565080916, "time_this_iter_s": 8.506397724151611, "time_total_s": 506.04874539375305, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 506.04874539375305, "timesteps_since_restore": 64000, "iterations_since_restore": 64}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3330.890625, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7689786792530129, "mean_processing_ms": 0.17681696692248722, "mean_inference_ms": 0.7955449976335609}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 128, "num_steps_trained": 512000, "num_steps_sampled": 65000, "sample_time_ms": 12.204, "replay_time_ms": 3.725, "grad_time_ms": 5.452, "update_time_ms": 4.866, "opt_peak_throughput": 5869.315, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -86.21688842773438, "min_q": -149.12905883789062, "max_q": -66.90879821777344, "mean_td_error": 1.3937242031097412}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 65000, "episodes_total": 64, "training_iteration": 65, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-42-03", "timestamp": 1565080923, "time_this_iter_s": 7.113061904907227, "time_total_s": 513.1618072986603, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 513.1618072986603, "timesteps_since_restore": 65000, "iterations_since_restore": 65}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3309.6923076923076, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.768507643611779, "mean_processing_ms": 0.17679128496276136, "mean_inference_ms": 0.795225846517295}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 130, "num_steps_trained": 520000, "num_steps_sampled": 66000, "sample_time_ms": 14.131, "replay_time_ms": 4.826, "grad_time_ms": 7.049, "update_time_ms": 7.114, "opt_peak_throughput": 4539.382, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -93.76634216308594, "min_q": -181.14634704589844, "max_q": -65.8026123046875, "mean_td_error": -1.7850215435028076}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 66000, "episodes_total": 65, "training_iteration": 66, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-42-12", "timestamp": 1565080932, "time_this_iter_s": 8.31275987625122, "time_total_s": 521.4745671749115, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 521.4745671749115, "timesteps_since_restore": 66000, "iterations_since_restore": 66}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3284.4545454545455, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7680409302412688, "mean_processing_ms": 0.1767649816777019, "mean_inference_ms": 0.7949103872676194}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 132, "num_steps_trained": 528000, "num_steps_sampled": 67000, "sample_time_ms": 12.504, "replay_time_ms": 3.753, "grad_time_ms": 5.527, "update_time_ms": 5.331, "opt_peak_throughput": 5789.364, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -112.172607421875, "min_q": -314.84613037109375, "max_q": -64.02833557128906, "mean_td_error": -0.3433905839920044}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 67000, "episodes_total": 66, "training_iteration": 67, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-42-19", "timestamp": 1565080939, "time_this_iter_s": 7.753738164901733, "time_total_s": 529.2283053398132, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 529.2283053398132, "timesteps_since_restore": 67000, "iterations_since_restore": 67}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3267.283582089552, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.767567506912879, "mean_processing_ms": 0.17673536712699642, "mean_inference_ms": 0.7945900260323931}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 134, "num_steps_trained": 536000, "num_steps_sampled": 68000, "sample_time_ms": 14.029, "replay_time_ms": 4.05, "grad_time_ms": 5.978, "update_time_ms": 5.934, "opt_peak_throughput": 5353.398, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -94.50729370117188, "min_q": -263.5541076660156, "max_q": -63.861732482910156, "mean_td_error": 0.732506513595581}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 68000, "episodes_total": 67, "training_iteration": 68, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-42-27", "timestamp": 1565080947, "time_this_iter_s": 7.116316080093384, "time_total_s": 536.3446214199066, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 536.3446214199066, "timesteps_since_restore": 68000, "iterations_since_restore": 68}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3240.970588235294, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7671218077016065, "mean_processing_ms": 0.17670998768288304, "mean_inference_ms": 0.7942894194014867}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 136, "num_steps_trained": 544000, "num_steps_sampled": 69000, "sample_time_ms": 13.639, "replay_time_ms": 4.625, "grad_time_ms": 6.793, "update_time_ms": 6.296, "opt_peak_throughput": 4710.964, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -88.78250122070312, "min_q": -178.11117553710938, "max_q": -63.49671936035156, "mean_td_error": 5.900670051574707}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 69000, "episodes_total": 68, "training_iteration": 69, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-42-35", "timestamp": 1565080955, "time_this_iter_s": 8.531450033187866, "time_total_s": 544.8760714530945, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 544.8760714530945, "timesteps_since_restore": 69000, "iterations_since_restore": 69}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3225.057971014493, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7666982246348086, "mean_processing_ms": 0.17668806588908717, "mean_inference_ms": 0.794005613349833}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 138, "num_steps_trained": 552000, "num_steps_sampled": 70000, "sample_time_ms": 13.149, "replay_time_ms": 4.128, "grad_time_ms": 5.794, "update_time_ms": 6.41, "opt_peak_throughput": 5522.954, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -97.44347381591797, "min_q": -362.140625, "max_q": -63.00648498535156, "mean_td_error": 7.6649065017700195}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 70000, "episodes_total": 69, "training_iteration": 70, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-42-44", "timestamp": 1565080964, "time_this_iter_s": 8.49063229560852, "time_total_s": 553.366703748703, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 553.366703748703, "timesteps_since_restore": 70000, "iterations_since_restore": 70}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3208.157142857143, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7662819162887042, "mean_processing_ms": 0.17666619290673213, "mean_inference_ms": 0.7937263940770306}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 140, "num_steps_trained": 560000, "num_steps_sampled": 71000, "sample_time_ms": 12.941, "replay_time_ms": 4.914, "grad_time_ms": 6.637, "update_time_ms": 6.152, "opt_peak_throughput": 4821.784, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -98.64952087402344, "min_q": -200.87451171875, "max_q": -62.25554656982422, "mean_td_error": 0.11144876480102539}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 71000, "episodes_total": 70, "training_iteration": 71, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-42-51", "timestamp": 1565080971, "time_this_iter_s": 7.688189268112183, "time_total_s": 561.0548930168152, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 561.0548930168152, "timesteps_since_restore": 71000, "iterations_since_restore": 71}
{"episode_reward_max": -1230.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3186.7464788732395, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7659445167990896, "mean_processing_ms": 0.17666196319037392, "mean_inference_ms": 0.7935424651870642}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 142, "num_steps_trained": 568000, "num_steps_sampled": 72000, "sample_time_ms": 26.501, "replay_time_ms": 9.093, "grad_time_ms": 12.084, "update_time_ms": 13.047, "opt_peak_throughput": 2648.186, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -119.19660949707031, "min_q": -627.7567138671875, "max_q": -63.7647819519043, "mean_td_error": -0.4609701633453369}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 72000, "episodes_total": 71, "training_iteration": 72, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-43-03", "timestamp": 1565080983, "time_this_iter_s": 11.52344036102295, "time_total_s": 572.5783333778381, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 572.5783333778381, "timesteps_since_restore": 72000, "iterations_since_restore": 72}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3159.402777777778, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7656585836449038, "mean_processing_ms": 0.1766691225250489, "mean_inference_ms": 0.7934318103224429}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 144, "num_steps_trained": 576000, "num_steps_sampled": 73000, "sample_time_ms": 11.662, "replay_time_ms": 4.146, "grad_time_ms": 6.035, "update_time_ms": 5.565, "opt_peak_throughput": 5302.513, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -123.49003601074219, "min_q": -537.001708984375, "max_q": -61.32224655151367, "mean_td_error": 2.812690258026123}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 73000, "episodes_total": 72, "training_iteration": 73, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-43-14", "timestamp": 1565080994, "time_this_iter_s": 10.742443561553955, "time_total_s": 583.3207769393921, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 583.3207769393921, "timesteps_since_restore": 73000, "iterations_since_restore": 73}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3137.821917808219, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7653662943590914, "mean_processing_ms": 0.1766729291584305, "mean_inference_ms": 0.7933044716800038}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 146, "num_steps_trained": 584000, "num_steps_sampled": 74000, "sample_time_ms": 11.442, "replay_time_ms": 4.288, "grad_time_ms": 6.107, "update_time_ms": 5.5, "opt_peak_throughput": 5239.626, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -96.96049499511719, "min_q": -160.05174255371094, "max_q": -63.618194580078125, "mean_td_error": -0.753838300704956}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 74000, "episodes_total": 73, "training_iteration": 74, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-43-21", "timestamp": 1565081001, "time_this_iter_s": 7.202757120132446, "time_total_s": 590.5235340595245, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 590.5235340595245, "timesteps_since_restore": 74000, "iterations_since_restore": 74}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3130.2027027027025, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7650545778897054, "mean_processing_ms": 0.1766702589476366, "mean_inference_ms": 0.793150067626388}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 148, "num_steps_trained": 592000, "num_steps_sampled": 75000, "sample_time_ms": 10.475, "replay_time_ms": 3.788, "grad_time_ms": 5.257, "update_time_ms": 4.836, "opt_peak_throughput": 6086.806, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -101.0063705444336, "min_q": -232.32919311523438, "max_q": -61.8789176940918, "mean_td_error": 8.599627494812012}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 75000, "episodes_total": 74, "training_iteration": 75, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-43-27", "timestamp": 1565081007, "time_this_iter_s": 6.480022668838501, "time_total_s": 597.003556728363, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 597.003556728363, "timesteps_since_restore": 75000, "iterations_since_restore": 75}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3109.76, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7647267250326457, "mean_processing_ms": 0.17666179930619383, "mean_inference_ms": 0.7929720536989603}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 150, "num_steps_trained": 600000, "num_steps_sampled": 76000, "sample_time_ms": 10.832, "replay_time_ms": 4.288, "grad_time_ms": 5.662, "update_time_ms": 5.088, "opt_peak_throughput": 5652.106, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -105.22213745117188, "min_q": -158.7622528076172, "max_q": -65.1894760131836, "mean_td_error": -4.721662521362305}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 76000, "episodes_total": 75, "training_iteration": 76, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-43-34", "timestamp": 1565081014, "time_this_iter_s": 6.639680624008179, "time_total_s": 603.6432373523712, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 603.6432373523712, "timesteps_since_restore": 76000, "iterations_since_restore": 76}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3093.8552631578946, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7643843845037527, "mean_processing_ms": 0.17664808196558576, "mean_inference_ms": 0.7927722460863174}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 152, "num_steps_trained": 608000, "num_steps_sampled": 77000, "sample_time_ms": 11.248, "replay_time_ms": 3.737, "grad_time_ms": 5.357, "update_time_ms": 5.038, "opt_peak_throughput": 5973.888, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -108.5804443359375, "min_q": -274.20489501953125, "max_q": -65.1480941772461, "mean_td_error": 2.947397232055664}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 77000, "episodes_total": 76, "training_iteration": 77, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-43-41", "timestamp": 1565081021, "time_this_iter_s": 6.669102191925049, "time_total_s": 610.3123395442963, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 610.3123395442963, "timesteps_since_restore": 77000, "iterations_since_restore": 77}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3083.3896103896104, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7640295812947803, "mean_processing_ms": 0.17662973770744492, "mean_inference_ms": 0.7925535609865396}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 154, "num_steps_trained": 616000, "num_steps_sampled": 78000, "sample_time_ms": 12.472, "replay_time_ms": 3.97, "grad_time_ms": 5.589, "update_time_ms": 5.511, "opt_peak_throughput": 5725.939, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -99.12684631347656, "min_q": -173.60879516601562, "max_q": -65.95162963867188, "mean_td_error": -0.2934744358062744}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 78000, "episodes_total": 77, "training_iteration": 78, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-43-47", "timestamp": 1565081027, "time_this_iter_s": 6.699541807174683, "time_total_s": 617.011881351471, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 617.011881351471, "timesteps_since_restore": 78000, "iterations_since_restore": 78}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3065.9615384615386, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7636870753815731, "mean_processing_ms": 0.17661293326967042, "mean_inference_ms": 0.7923378833393473}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 156, "num_steps_trained": 624000, "num_steps_sampled": 79000, "sample_time_ms": 12.698, "replay_time_ms": 4.696, "grad_time_ms": 6.733, "update_time_ms": 6.038, "opt_peak_throughput": 4752.55, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -118.3843765258789, "min_q": -601.820068359375, "max_q": -66.55184173583984, "mean_td_error": 4.305941581726074}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 79000, "episodes_total": 78, "training_iteration": 79, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-43-55", "timestamp": 1565081035, "time_this_iter_s": 8.115402460098267, "time_total_s": 625.1272838115692, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 625.1272838115692, "timesteps_since_restore": 79000, "iterations_since_restore": 79}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3052.012658227848, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7633309688444624, "mean_processing_ms": 0.17659137644927414, "mean_inference_ms": 0.7921041855557953}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 158, "num_steps_trained": 632000, "num_steps_sampled": 80000, "sample_time_ms": 11.418, "replay_time_ms": 3.743, "grad_time_ms": 5.551, "update_time_ms": 5.269, "opt_peak_throughput": 5764.673, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -117.3840560913086, "min_q": -459.59356689453125, "max_q": -67.05669403076172, "mean_td_error": 0.623307466506958}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 80000, "episodes_total": 79, "training_iteration": 80, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-02", "timestamp": 1565081042, "time_this_iter_s": 6.723423719406128, "time_total_s": 631.8507075309753, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 631.8507075309753, "timesteps_since_restore": 80000, "iterations_since_restore": 80}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3032.95, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7629652349305138, "mean_processing_ms": 0.17656628526682977, "mean_inference_ms": 0.7918556803252492}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 160, "num_steps_trained": 640000, "num_steps_sampled": 81000, "sample_time_ms": 10.84, "replay_time_ms": 3.926, "grad_time_ms": 5.378, "update_time_ms": 5.207, "opt_peak_throughput": 5950.027, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -133.93836975097656, "min_q": -1174.6051025390625, "max_q": -66.24961853027344, "mean_td_error": 5.959657669067383}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 81000, "episodes_total": 80, "training_iteration": 81, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-09", "timestamp": 1565081049, "time_this_iter_s": 6.8028178215026855, "time_total_s": 638.653525352478, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 638.653525352478, "timesteps_since_restore": 81000, "iterations_since_restore": 81}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -3012.5185185185187, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7625896458467399, "mean_processing_ms": 0.17653755011030467, "mean_inference_ms": 0.7915918410800206}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 162, "num_steps_trained": 648000, "num_steps_sampled": 82000, "sample_time_ms": 10.931, "replay_time_ms": 4.342, "grad_time_ms": 5.475, "update_time_ms": 5.134, "opt_peak_throughput": 5844.727, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -89.6706314086914, "min_q": -155.9730987548828, "max_q": -67.5887222290039, "mean_td_error": 2.736283302307129}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 82000, "episodes_total": 81, "training_iteration": 82, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-16", "timestamp": 1565081056, "time_this_iter_s": 6.618578910827637, "time_total_s": 645.2721042633057, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 645.2721042633057, "timesteps_since_restore": 82000, "iterations_since_restore": 82}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2990.6585365853657, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7622049831189701, "mean_processing_ms": 0.17650556341291, "mean_inference_ms": 0.7913145095725882}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 164, "num_steps_trained": 656000, "num_steps_sampled": 83000, "sample_time_ms": 11.843, "replay_time_ms": 4.822, "grad_time_ms": 6.121, "update_time_ms": 5.45, "opt_peak_throughput": 5227.524, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -108.72802734375, "min_q": -368.23760986328125, "max_q": -67.30988311767578, "mean_td_error": 4.41721248626709}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 83000, "episodes_total": 82, "training_iteration": 83, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-22", "timestamp": 1565081062, "time_this_iter_s": 6.627740383148193, "time_total_s": 651.8998446464539, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 651.8998446464539, "timesteps_since_restore": 83000, "iterations_since_restore": 83}
{"episode_reward_max": -1218.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2974.8192771084337, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7618115247766103, "mean_processing_ms": 0.17647036287676468, "mean_inference_ms": 0.7910233249090891}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 166, "num_steps_trained": 664000, "num_steps_sampled": 84000, "sample_time_ms": 12.325, "replay_time_ms": 4.415, "grad_time_ms": 6.18, "update_time_ms": 5.709, "opt_peak_throughput": 5177.614, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -97.49357604980469, "min_q": -255.36170959472656, "max_q": -67.04579162597656, "mean_td_error": 4.100776195526123}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 84000, "episodes_total": 83, "training_iteration": 84, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-29", "timestamp": 1565081069, "time_this_iter_s": 6.597586631774902, "time_total_s": 658.4974312782288, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 658.4974312782288, "timesteps_since_restore": 84000, "iterations_since_restore": 84}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2953.4285714285716, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7614284845597121, "mean_processing_ms": 0.1764369611998997, "mean_inference_ms": 0.7907362958602691}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 168, "num_steps_trained": 672000, "num_steps_sampled": 85000, "sample_time_ms": 13.053, "replay_time_ms": 5.012, "grad_time_ms": 6.591, "update_time_ms": 6.162, "opt_peak_throughput": 4855.133, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -92.2972412109375, "min_q": -174.16961669921875, "max_q": -67.88119506835938, "mean_td_error": -0.42627692222595215}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 85000, "episodes_total": 84, "training_iteration": 85, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-37", "timestamp": 1565081077, "time_this_iter_s": 7.9688780307769775, "time_total_s": 666.4663093090057, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 666.4663093090057, "timesteps_since_restore": 85000, "iterations_since_restore": 85}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2933.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7610449200690221, "mean_processing_ms": 0.17640247160687966, "mean_inference_ms": 0.7904444498730483}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 170, "num_steps_trained": 680000, "num_steps_sampled": 86000, "sample_time_ms": 12.279, "replay_time_ms": 3.693, "grad_time_ms": 5.538, "update_time_ms": 5.043, "opt_peak_throughput": 5778.373, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -95.65556335449219, "min_q": -168.72674560546875, "max_q": -67.23294830322266, "mean_td_error": 1.247243881225586}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 86000, "episodes_total": 85, "training_iteration": 86, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-44", "timestamp": 1565081084, "time_this_iter_s": 7.280019760131836, "time_total_s": 673.7463290691376, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 673.7463290691376, "timesteps_since_restore": 86000, "iterations_since_restore": 86}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2921.546511627907, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7606550986211398, "mean_processing_ms": 0.17636530128348, "mean_inference_ms": 0.7901419566064838}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 172, "num_steps_trained": 688000, "num_steps_sampled": 87000, "sample_time_ms": 11.824, "replay_time_ms": 4.573, "grad_time_ms": 6.74, "update_time_ms": 6.54, "opt_peak_throughput": 4747.675, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -98.43307495117188, "min_q": -382.94189453125, "max_q": -67.31573486328125, "mean_td_error": 3.563897132873535}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 87000, "episodes_total": 86, "training_iteration": 87, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-51", "timestamp": 1565081091, "time_this_iter_s": 6.712728977203369, "time_total_s": 680.4590580463409, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 680.4590580463409, "timesteps_since_restore": 87000, "iterations_since_restore": 87}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2904.2183908045977, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7602575174556812, "mean_processing_ms": 0.1763250107662567, "mean_inference_ms": 0.7898268087507021}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 174, "num_steps_trained": 696000, "num_steps_sampled": 88000, "sample_time_ms": 12.886, "replay_time_ms": 4.383, "grad_time_ms": 5.958, "update_time_ms": 5.911, "opt_peak_throughput": 5370.535, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -114.03106689453125, "min_q": -473.6572570800781, "max_q": -64.08958435058594, "mean_td_error": -0.8139636516571045}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 88000, "episodes_total": 87, "training_iteration": 88, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-44-57", "timestamp": 1565081097, "time_this_iter_s": 6.568994045257568, "time_total_s": 687.0280520915985, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 687.0280520915985, "timesteps_since_restore": 88000, "iterations_since_restore": 88}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2895.465909090909, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7598707935081492, "mean_processing_ms": 0.17628598356651473, "mean_inference_ms": 0.7895168449168989}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 176, "num_steps_trained": 704000, "num_steps_sampled": 89000, "sample_time_ms": 12.439, "replay_time_ms": 4.86, "grad_time_ms": 6.422, "update_time_ms": 5.98, "opt_peak_throughput": 4982.672, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -92.53167724609375, "min_q": -145.22491455078125, "max_q": -65.63138580322266, "mean_td_error": -0.4270312786102295}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 89000, "episodes_total": 88, "training_iteration": 89, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-05", "timestamp": 1565081105, "time_this_iter_s": 7.922662019729614, "time_total_s": 694.9507141113281, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 694.9507141113281, "timesteps_since_restore": 89000, "iterations_since_restore": 89}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2881.1573033707864, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7594829783903754, "mean_processing_ms": 0.1762455931119064, "mean_inference_ms": 0.7892019742385821}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 178, "num_steps_trained": 712000, "num_steps_sampled": 90000, "sample_time_ms": 11.358, "replay_time_ms": 3.538, "grad_time_ms": 5.778, "update_time_ms": 5.454, "opt_peak_throughput": 5538.292, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -104.77195739746094, "min_q": -347.869140625, "max_q": -66.10958862304688, "mean_td_error": 3.542471408843994}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 90000, "episodes_total": 89, "training_iteration": 90, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-13", "timestamp": 1565081113, "time_this_iter_s": 7.223392009735107, "time_total_s": 702.1741061210632, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 702.1741061210632, "timesteps_since_restore": 90000, "iterations_since_restore": 90}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2878.0555555555557, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7590912770538659, "mean_processing_ms": 0.17620313648465408, "mean_inference_ms": 0.7888797859295993}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 180, "num_steps_trained": 720000, "num_steps_sampled": 91000, "sample_time_ms": 13.547, "replay_time_ms": 4.232, "grad_time_ms": 6.007, "update_time_ms": 5.792, "opt_peak_throughput": 5327.474, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -98.50967407226562, "min_q": -475.24847412109375, "max_q": -65.64984893798828, "mean_td_error": -11.446958541870117}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 91000, "episodes_total": 90, "training_iteration": 91, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-19", "timestamp": 1565081119, "time_this_iter_s": 6.83563232421875, "time_total_s": 709.009738445282, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 709.009738445282, "timesteps_since_restore": 91000, "iterations_since_restore": 91}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2867.032967032967, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7586941208939699, "mean_processing_ms": 0.17615845171545538, "mean_inference_ms": 0.7885483135554192}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 182, "num_steps_trained": 728000, "num_steps_sampled": 92000, "sample_time_ms": 12.121, "replay_time_ms": 3.989, "grad_time_ms": 5.958, "update_time_ms": 5.467, "opt_peak_throughput": 5370.814, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -139.01974487304688, "min_q": -1146.2015380859375, "max_q": -65.0188980102539, "mean_td_error": -1.3647186756134033}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 92000, "episodes_total": 91, "training_iteration": 92, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-26", "timestamp": 1565081126, "time_this_iter_s": 6.617586135864258, "time_total_s": 715.6273245811462, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 715.6273245811462, "timesteps_since_restore": 92000, "iterations_since_restore": 92}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2860.032608695652, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7582923178398124, "mean_processing_ms": 0.17611166962129712, "mean_inference_ms": 0.7882095680188176}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 184, "num_steps_trained": 736000, "num_steps_sampled": 93000, "sample_time_ms": 11.791, "replay_time_ms": 4.329, "grad_time_ms": 5.525, "update_time_ms": 5.454, "opt_peak_throughput": 5792.138, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -121.43253326416016, "min_q": -1124.7149658203125, "max_q": -64.01470184326172, "mean_td_error": -1.5670275688171387}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 93000, "episodes_total": 92, "training_iteration": 93, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-33", "timestamp": 1565081133, "time_this_iter_s": 6.686970472335815, "time_total_s": 722.314295053482, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 722.314295053482, "timesteps_since_restore": 93000, "iterations_since_restore": 93}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2844.1612903225805, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7578844077444987, "mean_processing_ms": 0.17606245265147566, "mean_inference_ms": 0.7878623098400936}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 186, "num_steps_trained": 744000, "num_steps_sampled": 94000, "sample_time_ms": 11.647, "replay_time_ms": 3.849, "grad_time_ms": 5.337, "update_time_ms": 5.067, "opt_peak_throughput": 5995.905, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -133.87149047851562, "min_q": -1099.3408203125, "max_q": -62.81382369995117, "mean_td_error": 0.9347995519638062}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 94000, "episodes_total": 93, "training_iteration": 94, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-39", "timestamp": 1565081139, "time_this_iter_s": 6.643953561782837, "time_total_s": 728.9582486152649, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 728.9582486152649, "timesteps_since_restore": 94000, "iterations_since_restore": 94}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2835.531914893617, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7574722668271112, "mean_processing_ms": 0.17601117682638182, "mean_inference_ms": 0.7875086739826855}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 188, "num_steps_trained": 752000, "num_steps_sampled": 95000, "sample_time_ms": 10.892, "replay_time_ms": 3.993, "grad_time_ms": 5.345, "update_time_ms": 5.149, "opt_peak_throughput": 5986.518, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -91.37029266357422, "min_q": -165.98243713378906, "max_q": -61.1683349609375, "mean_td_error": 2.1617538928985596}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 95000, "episodes_total": 94, "training_iteration": 95, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-46", "timestamp": 1565081146, "time_this_iter_s": 6.683620452880859, "time_total_s": 735.6418690681458, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 735.6418690681458, "timesteps_since_restore": 95000, "iterations_since_restore": 95}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2819.1894736842105, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7570559033861375, "mean_processing_ms": 0.17595792774133978, "mean_inference_ms": 0.7871482141502015}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 190, "num_steps_trained": 760000, "num_steps_sampled": 96000, "sample_time_ms": 11.56, "replay_time_ms": 3.766, "grad_time_ms": 5.133, "update_time_ms": 5.113, "opt_peak_throughput": 6233.755, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -90.12939453125, "min_q": -145.3328857421875, "max_q": -61.67536544799805, "mean_td_error": -0.3311753273010254}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 96000, "episodes_total": 95, "training_iteration": 96, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-53", "timestamp": 1565081153, "time_this_iter_s": 6.657829999923706, "time_total_s": 742.2996990680695, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 742.2996990680695, "timesteps_since_restore": 96000, "iterations_since_restore": 96}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2806.6041666666665, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7566362963410608, "mean_processing_ms": 0.17590273000769022, "mean_inference_ms": 0.786781576980041}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 192, "num_steps_trained": 768000, "num_steps_sampled": 97000, "sample_time_ms": 12.555, "replay_time_ms": 3.9, "grad_time_ms": 5.744, "update_time_ms": 5.524, "opt_peak_throughput": 5570.865, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -90.30455017089844, "min_q": -146.65235900878906, "max_q": -63.13002395629883, "mean_td_error": -2.3412561416625977}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 97000, "episodes_total": 96, "training_iteration": 97, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-45-59", "timestamp": 1565081159, "time_this_iter_s": 6.555532455444336, "time_total_s": 748.8552315235138, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 748.8552315235138, "timesteps_since_restore": 97000, "iterations_since_restore": 97}
{"episode_reward_max": -1178.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2796.381443298969, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7562122493556187, "mean_processing_ms": 0.17584577545645652, "mean_inference_ms": 0.7864087670787925}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 194, "num_steps_trained": 776000, "num_steps_sampled": 98000, "sample_time_ms": 11.992, "replay_time_ms": 4.396, "grad_time_ms": 6.186, "update_time_ms": 5.95, "opt_peak_throughput": 5172.984, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -94.02268981933594, "min_q": -152.0721893310547, "max_q": -63.01540756225586, "mean_td_error": 1.122196912765503}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 98000, "episodes_total": 97, "training_iteration": 98, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-46-06", "timestamp": 1565081166, "time_this_iter_s": 6.54939341545105, "time_total_s": 755.4046249389648, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 755.4046249389648, "timesteps_since_restore": 98000, "iterations_since_restore": 98}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2779.530612244898, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7557991465028507, "mean_processing_ms": 0.17579066544676938, "mean_inference_ms": 0.7860426487552014}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 196, "num_steps_trained": 784000, "num_steps_sampled": 99000, "sample_time_ms": 12.954, "replay_time_ms": 4.911, "grad_time_ms": 6.284, "update_time_ms": 6.078, "opt_peak_throughput": 5092.299, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -100.70640563964844, "min_q": -269.6622009277344, "max_q": -63.72649383544922, "mean_td_error": 1.6044658422470093}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 99000, "episodes_total": 98, "training_iteration": 99, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-46-14", "timestamp": 1565081174, "time_this_iter_s": 7.940758466720581, "time_total_s": 763.3453834056854, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 763.3453834056854, "timesteps_since_restore": 99000, "iterations_since_restore": 99}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2810.4141414141413, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7553869268190341, "mean_processing_ms": 0.17573460675657052, "mean_inference_ms": 0.7856741176808008}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 198, "num_steps_trained": 792000, "num_steps_sampled": 100000, "sample_time_ms": 10.737, "replay_time_ms": 3.686, "grad_time_ms": 5.196, "update_time_ms": 5.241, "opt_peak_throughput": 6159.065, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -104.44371032714844, "min_q": -438.5398864746094, "max_q": -63.33477783203125, "mean_td_error": 6.723499774932861}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 100000, "episodes_total": 99, "training_iteration": 100, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-46-21", "timestamp": 1565081181, "time_this_iter_s": 6.986934423446655, "time_total_s": 770.3323178291321, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 770.3323178291321, "timesteps_since_restore": 100000, "iterations_since_restore": 100}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2795.59, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7549713822074159, "mean_processing_ms": 0.17567692929726697, "mean_inference_ms": 0.7853003140058747}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 200, "num_steps_trained": 800000, "num_steps_sampled": 101000, "sample_time_ms": 11.873, "replay_time_ms": 4.903, "grad_time_ms": 6.423, "update_time_ms": 5.736, "opt_peak_throughput": 4982.024, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -92.26181030273438, "min_q": -137.2437286376953, "max_q": -64.78144073486328, "mean_td_error": -1.0946813821792603}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 101000, "episodes_total": 100, "training_iteration": 101, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-46-27", "timestamp": 1565081187, "time_this_iter_s": 6.685477256774902, "time_total_s": 777.017795085907, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 777.017795085907, "timesteps_since_restore": 101000, "iterations_since_restore": 101}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2706.6, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7513471441220738, "mean_processing_ms": 0.17527143463206968, "mean_inference_ms": 0.7819385119027426}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 202, "num_steps_trained": 808000, "num_steps_sampled": 102000, "sample_time_ms": 11.411, "replay_time_ms": 4.541, "grad_time_ms": 5.598, "update_time_ms": 5.179, "opt_peak_throughput": 5715.941, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -90.4453125, "min_q": -143.72174072265625, "max_q": -64.55764770507812, "mean_td_error": 0.5672130584716797}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 102000, "episodes_total": 101, "training_iteration": 102, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-46-34", "timestamp": 1565081194, "time_this_iter_s": 6.5396568775177, "time_total_s": 783.5574519634247, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 783.5574519634247, "timesteps_since_restore": 102000, "iterations_since_restore": 102}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2597.93, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7487413830003073, "mean_processing_ms": 0.17499923500091563, "mean_inference_ms": 0.7797036007476241}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 204, "num_steps_trained": 816000, "num_steps_sampled": 103000, "sample_time_ms": 11.876, "replay_time_ms": 4.497, "grad_time_ms": 6.309, "update_time_ms": 6.013, "opt_peak_throughput": 5072.17, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -97.74655151367188, "min_q": -138.2318572998047, "max_q": -65.7786865234375, "mean_td_error": 2.2657201290130615}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 103000, "episodes_total": 102, "training_iteration": 103, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-46-41", "timestamp": 1565081201, "time_this_iter_s": 6.573992490768433, "time_total_s": 790.1314444541931, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 790.1314444541931, "timesteps_since_restore": 103000, "iterations_since_restore": 103}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2512.08, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7467252864467311, "mean_processing_ms": 0.17478310158064747, "mean_inference_ms": 0.7780119607515303}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 206, "num_steps_trained": 824000, "num_steps_sampled": 104000, "sample_time_ms": 13.319, "replay_time_ms": 4.868, "grad_time_ms": 6.68, "update_time_ms": 6.328, "opt_peak_throughput": 4790.565, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -94.16610717773438, "min_q": -178.66307067871094, "max_q": -65.11834716796875, "mean_td_error": 3.559019088745117}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 104000, "episodes_total": 103, "training_iteration": 104, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-46-48", "timestamp": 1565081208, "time_this_iter_s": 7.809740304946899, "time_total_s": 797.94118475914, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 797.94118475914, "timesteps_since_restore": 104000, "iterations_since_restore": 104}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2448.5, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7450469995487896, "mean_processing_ms": 0.17461195483560618, "mean_inference_ms": 0.7766776296050757}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 208, "num_steps_trained": 832000, "num_steps_sampled": 105000, "sample_time_ms": 12.11, "replay_time_ms": 4.283, "grad_time_ms": 6.385, "update_time_ms": 5.904, "opt_peak_throughput": 5011.584, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -90.44374084472656, "min_q": -169.97711181640625, "max_q": -65.31089782714844, "mean_td_error": 0.4548802375793457}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 105000, "episodes_total": 104, "training_iteration": 105, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-46-56", "timestamp": 1565081216, "time_this_iter_s": 7.120502948760986, "time_total_s": 805.061687707901, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 805.061687707901, "timesteps_since_restore": 105000, "iterations_since_restore": 105}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2382.75, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7436341327799574, "mean_processing_ms": 0.17447027781002858, "mean_inference_ms": 0.7755758348857077}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 210, "num_steps_trained": 840000, "num_steps_sampled": 106000, "sample_time_ms": 16.311, "replay_time_ms": 5.693, "grad_time_ms": 7.794, "update_time_ms": 7.489, "opt_peak_throughput": 4105.585, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.60030364990234, "min_q": -141.21966552734375, "max_q": -66.53514862060547, "mean_td_error": 1.5286507606506348}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 106000, "episodes_total": 105, "training_iteration": 106, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-47-03", "timestamp": 1565081223, "time_this_iter_s": 7.056214809417725, "time_total_s": 812.1179025173187, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 812.1179025173187, "timesteps_since_restore": 106000, "iterations_since_restore": 106}
{"episode_reward_max": -1145.0, "episode_reward_min": -13801.0, "episode_reward_mean": -2341.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7423452717936361, "mean_processing_ms": 0.17434956085829356, "mean_inference_ms": 0.774670958551514}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 212, "num_steps_trained": 848000, "num_steps_sampled": 107000, "sample_time_ms": 14.559, "replay_time_ms": 4.114, "grad_time_ms": 6.43, "update_time_ms": 6.461, "opt_peak_throughput": 4976.483, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -91.68870544433594, "min_q": -186.90243530273438, "max_q": -67.86955261230469, "mean_td_error": 6.049099922180176}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 107000, "episodes_total": 106, "training_iteration": 107, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-47-12", "timestamp": 1565081232, "time_this_iter_s": 9.450182676315308, "time_total_s": 821.568085193634, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 821.568085193634, "timesteps_since_restore": 107000, "iterations_since_restore": 107}
{"episode_reward_max": -1145.0, "episode_reward_min": -7391.0, "episode_reward_mean": -2228.57, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7412346725010395, "mean_processing_ms": 0.17424615894950246, "mean_inference_ms": 0.7738960443585627}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 214, "num_steps_trained": 856000, "num_steps_sampled": 108000, "sample_time_ms": 11.516, "replay_time_ms": 3.904, "grad_time_ms": 5.619, "update_time_ms": 5.657, "opt_peak_throughput": 5695.252, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -96.46147155761719, "min_q": -159.2742919921875, "max_q": -68.1178207397461, "mean_td_error": 3.1117801666259766}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 108000, "episodes_total": 107, "training_iteration": 108, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-47-19", "timestamp": 1565081239, "time_this_iter_s": 7.148612022399902, "time_total_s": 828.7166972160339, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 828.7166972160339, "timesteps_since_restore": 108000, "iterations_since_restore": 108}
{"episode_reward_max": -1145.0, "episode_reward_min": -7391.0, "episode_reward_mean": -2230.83, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7402162453374038, "mean_processing_ms": 0.1741519397009421, "mean_inference_ms": 0.7732046747325235}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 216, "num_steps_trained": 864000, "num_steps_sampled": 109000, "sample_time_ms": 12.518, "replay_time_ms": 4.061, "grad_time_ms": 5.949, "update_time_ms": 5.923, "opt_peak_throughput": 5378.886, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -147.1291046142578, "min_q": -775.327880859375, "max_q": -70.00464630126953, "mean_td_error": 2.3249237537384033}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 109000, "episodes_total": 108, "training_iteration": 109, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-47-26", "timestamp": 1565081246, "time_this_iter_s": 7.270906925201416, "time_total_s": 835.9876041412354, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 835.9876041412354, "timesteps_since_restore": 109000, "iterations_since_restore": 109}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2300.18, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7393060956424297, "mean_processing_ms": 0.17407549087099133, "mean_inference_ms": 0.7725966243885742}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 218, "num_steps_trained": 872000, "num_steps_sampled": 110000, "sample_time_ms": 11.883, "replay_time_ms": 3.522, "grad_time_ms": 6.163, "update_time_ms": 6.058, "opt_peak_throughput": 5192.557, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -119.25757598876953, "min_q": -683.1268920898438, "max_q": -70.125, "mean_td_error": 1.5611000061035156}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 110000, "episodes_total": 109, "training_iteration": 110, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-47-34", "timestamp": 1565081254, "time_this_iter_s": 7.226396322250366, "time_total_s": 843.2140004634857, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 843.2140004634857, "timesteps_since_restore": 110000, "iterations_since_restore": 110}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2244.05, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7383696803199159, "mean_processing_ms": 0.1739851701337036, "mean_inference_ms": 0.7719438484507734}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 220, "num_steps_trained": 880000, "num_steps_sampled": 111000, "sample_time_ms": 11.072, "replay_time_ms": 3.776, "grad_time_ms": 5.712, "update_time_ms": 6.167, "opt_peak_throughput": 5601.835, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -103.86878204345703, "min_q": -354.5399475097656, "max_q": -70.61805725097656, "mean_td_error": 0.16384506225585938}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 111000, "episodes_total": 110, "training_iteration": 111, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-47-41", "timestamp": 1565081261, "time_this_iter_s": 7.142342567443848, "time_total_s": 850.3563430309296, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 850.3563430309296, "timesteps_since_restore": 111000, "iterations_since_restore": 111}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2200.34, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7375154356705252, "mean_processing_ms": 0.1739045613961753, "mean_inference_ms": 0.7713527631311049}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 222, "num_steps_trained": 888000, "num_steps_sampled": 112000, "sample_time_ms": 17.39, "replay_time_ms": 5.895, "grad_time_ms": 7.72, "update_time_ms": 7.51, "opt_peak_throughput": 4144.876, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.33997344970703, "min_q": -368.07513427734375, "max_q": -70.64288330078125, "mean_td_error": 3.2389392852783203}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 112000, "episodes_total": 111, "training_iteration": 112, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-47-49", "timestamp": 1565081269, "time_this_iter_s": 8.022164344787598, "time_total_s": 858.3785073757172, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 858.3785073757172, "timesteps_since_restore": 112000, "iterations_since_restore": 112}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2189.47, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7366993077284409, "mean_processing_ms": 0.17381921594437258, "mean_inference_ms": 0.7707534292801586}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 224, "num_steps_trained": 896000, "num_steps_sampled": 113000, "sample_time_ms": 13.684, "replay_time_ms": 4.944, "grad_time_ms": 7.043, "update_time_ms": 5.896, "opt_peak_throughput": 4543.424, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -94.64714050292969, "min_q": -144.623046875, "max_q": -70.47677612304688, "mean_td_error": 4.760616302490234}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 113000, "episodes_total": 112, "training_iteration": 113, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-47-58", "timestamp": 1565081278, "time_this_iter_s": 8.662880420684814, "time_total_s": 867.041387796402, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 867.041387796402, "timesteps_since_restore": 113000, "iterations_since_restore": 113}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2183.2, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7359502288389919, "mean_processing_ms": 0.17373724410098834, "mean_inference_ms": 0.7701965995008532}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 226, "num_steps_trained": 904000, "num_steps_sampled": 114000, "sample_time_ms": 13.067, "replay_time_ms": 4.346, "grad_time_ms": 6.216, "update_time_ms": 5.904, "opt_peak_throughput": 5147.708, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -106.70669555664062, "min_q": -389.74609375, "max_q": -72.0263442993164, "mean_td_error": 3.702686309814453}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 114000, "episodes_total": 113, "training_iteration": 114, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-48-05", "timestamp": 1565081285, "time_this_iter_s": 7.253087043762207, "time_total_s": 874.2944748401642, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 874.2944748401642, "timesteps_since_restore": 114000, "iterations_since_restore": 114}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2177.76, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7352518582838664, "mean_processing_ms": 0.17365816779871268, "mean_inference_ms": 0.76966930942611}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 228, "num_steps_trained": 912000, "num_steps_sampled": 115000, "sample_time_ms": 12.845, "replay_time_ms": 4.342, "grad_time_ms": 6.404, "update_time_ms": 6.132, "opt_peak_throughput": 4996.491, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.24706268310547, "min_q": -406.4063415527344, "max_q": -72.30050659179688, "mean_td_error": -0.5233263969421387}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 115000, "episodes_total": 114, "training_iteration": 115, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-48-12", "timestamp": 1565081292, "time_this_iter_s": 7.201162338256836, "time_total_s": 881.495637178421, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 881.495637178421, "timesteps_since_restore": 115000, "iterations_since_restore": 115}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2174.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7346019019212914, "mean_processing_ms": 0.1735815857161433, "mean_inference_ms": 0.7691565714872982}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 230, "num_steps_trained": 920000, "num_steps_sampled": 116000, "sample_time_ms": 13.877, "replay_time_ms": 4.903, "grad_time_ms": 7.351, "update_time_ms": 7.178, "opt_peak_throughput": 4353.054, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -133.40867614746094, "min_q": -695.2083740234375, "max_q": -73.40904998779297, "mean_td_error": -4.698284149169922}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 116000, "episodes_total": 115, "training_iteration": 116, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-48-20", "timestamp": 1565081300, "time_this_iter_s": 8.267196893692017, "time_total_s": 889.762834072113, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 889.762834072113, "timesteps_since_restore": 116000, "iterations_since_restore": 116}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2176.75, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7339866981896976, "mean_processing_ms": 0.1735073172680323, "mean_inference_ms": 0.7686662169491773}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 232, "num_steps_trained": 928000, "num_steps_sampled": 117000, "sample_time_ms": 13.178, "replay_time_ms": 5.627, "grad_time_ms": 6.725, "update_time_ms": 6.359, "opt_peak_throughput": 4758.178, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -131.3677978515625, "min_q": -792.8215942382812, "max_q": -72.71861267089844, "mean_td_error": -3.105942487716675}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 117000, "episodes_total": 116, "training_iteration": 117, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-48-28", "timestamp": 1565081308, "time_this_iter_s": 7.754707336425781, "time_total_s": 897.5175414085388, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 897.5175414085388, "timesteps_since_restore": 117000, "iterations_since_restore": 117}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2175.76, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7334178885047165, "mean_processing_ms": 0.17343957332230756, "mean_inference_ms": 0.7681994869800927}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 234, "num_steps_trained": 936000, "num_steps_sampled": 118000, "sample_time_ms": 15.554, "replay_time_ms": 5.981, "grad_time_ms": 7.869, "update_time_ms": 7.122, "opt_peak_throughput": 4066.501, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -101.5980224609375, "min_q": -183.57821655273438, "max_q": -71.13502502441406, "mean_td_error": 0.7174813747406006}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 118000, "episodes_total": 117, "training_iteration": 118, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-48-37", "timestamp": 1565081317, "time_this_iter_s": 9.318485975265503, "time_total_s": 906.8360273838043, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 906.8360273838043, "timesteps_since_restore": 118000, "iterations_since_restore": 118}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2173.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7329242413247917, "mean_processing_ms": 0.1733851734298003, "mean_inference_ms": 0.7677980771149483}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 236, "num_steps_trained": 944000, "num_steps_sampled": 119000, "sample_time_ms": 13.674, "replay_time_ms": 4.244, "grad_time_ms": 6.086, "update_time_ms": 5.869, "opt_peak_throughput": 5257.791, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -94.47053527832031, "min_q": -150.61834716796875, "max_q": -70.49942779541016, "mean_td_error": 1.434704065322876}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 119000, "episodes_total": 118, "training_iteration": 119, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-48-46", "timestamp": 1565081326, "time_this_iter_s": 8.235652923583984, "time_total_s": 915.0716803073883, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 915.0716803073883, "timesteps_since_restore": 119000, "iterations_since_restore": 119}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2163.6, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7324265770020143, "mean_processing_ms": 0.17332597352998189, "mean_inference_ms": 0.7673923888252099}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 238, "num_steps_trained": 952000, "num_steps_sampled": 120000, "sample_time_ms": 13.228, "replay_time_ms": 4.66, "grad_time_ms": 6.399, "update_time_ms": 6.332, "opt_peak_throughput": 5000.586, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -129.02508544921875, "min_q": -677.4268188476562, "max_q": -72.84001159667969, "mean_td_error": -5.150235176086426}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 120000, "episodes_total": 119, "training_iteration": 120, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-48-54", "timestamp": 1565081334, "time_this_iter_s": 7.891644239425659, "time_total_s": 922.963324546814, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 922.963324546814, "timesteps_since_restore": 120000, "iterations_since_restore": 120}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2163.71, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7319593845894735, "mean_processing_ms": 0.17327141514522382, "mean_inference_ms": 0.767011732029882}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 240, "num_steps_trained": 960000, "num_steps_sampled": 121000, "sample_time_ms": 13.595, "replay_time_ms": 4.134, "grad_time_ms": 6.693, "update_time_ms": 6.189, "opt_peak_throughput": 4780.838, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -92.30094909667969, "min_q": -151.5290985107422, "max_q": -71.06916046142578, "mean_td_error": -0.49098777770996094}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 121000, "episodes_total": 120, "training_iteration": 121, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-49-02", "timestamp": 1565081342, "time_this_iter_s": 7.987478017807007, "time_total_s": 930.950802564621, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 930.950802564621, "timesteps_since_restore": 121000, "iterations_since_restore": 121}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2155.61, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.731542361921795, "mean_processing_ms": 0.1732254797419622, "mean_inference_ms": 0.7666740019575726}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 242, "num_steps_trained": 968000, "num_steps_sampled": 122000, "sample_time_ms": 11.827, "replay_time_ms": 4.663, "grad_time_ms": 6.329, "update_time_ms": 6.142, "opt_peak_throughput": 5055.758, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -114.04549407958984, "min_q": -726.3475341796875, "max_q": -71.72740936279297, "mean_td_error": -2.194953441619873}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 122000, "episodes_total": 121, "training_iteration": 122, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-49-09", "timestamp": 1565081349, "time_this_iter_s": 7.821793079376221, "time_total_s": 938.7725956439972, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 938.7725956439972, "timesteps_since_restore": 122000, "iterations_since_restore": 122}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2155.98, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.731156749973226, "mean_processing_ms": 0.1731854750577755, "mean_inference_ms": 0.7663609267157645}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 244, "num_steps_trained": 976000, "num_steps_sampled": 123000, "sample_time_ms": 12.944, "replay_time_ms": 4.658, "grad_time_ms": 6.511, "update_time_ms": 5.555, "opt_peak_throughput": 4914.996, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -106.16040802001953, "min_q": -159.08502197265625, "max_q": -70.4896469116211, "mean_td_error": 1.2493886947631836}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 123000, "episodes_total": 122, "training_iteration": 123, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-49-17", "timestamp": 1565081357, "time_this_iter_s": 7.905221700668335, "time_total_s": 946.6778173446655, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 946.6778173446655, "timesteps_since_restore": 123000, "iterations_since_restore": 123}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2148.53, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7307444680455208, "mean_processing_ms": 0.17313584221180225, "mean_inference_ms": 0.7660181092289338}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 246, "num_steps_trained": 984000, "num_steps_sampled": 124000, "sample_time_ms": 12.421, "replay_time_ms": 4.276, "grad_time_ms": 6.533, "update_time_ms": 6.366, "opt_peak_throughput": 4897.903, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -121.42681884765625, "min_q": -830.7717895507812, "max_q": -69.86272430419922, "mean_td_error": -0.3690505027770996}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 124000, "episodes_total": 123, "training_iteration": 124, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-49-25", "timestamp": 1565081365, "time_this_iter_s": 7.870799779891968, "time_total_s": 954.5486171245575, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 954.5486171245575, "timesteps_since_restore": 124000, "iterations_since_restore": 124}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2148.95, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7303815142965512, "mean_processing_ms": 0.1730968575736566, "mean_inference_ms": 0.7657241511991977}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 248, "num_steps_trained": 992000, "num_steps_sampled": 125000, "sample_time_ms": 28.146, "replay_time_ms": 8.061, "grad_time_ms": 12.502, "update_time_ms": 12.349, "opt_peak_throughput": 2559.609, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -99.04362487792969, "min_q": -156.28085327148438, "max_q": -70.95367431640625, "mean_td_error": -0.16895413398742676}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 125000, "episodes_total": 124, "training_iteration": 125, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-49-34", "timestamp": 1565081374, "time_this_iter_s": 8.97282862663269, "time_total_s": 963.5214457511902, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 963.5214457511902, "timesteps_since_restore": 125000, "iterations_since_restore": 125}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2129.01, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7300309830845724, "mean_processing_ms": 0.1730587620752639, "mean_inference_ms": 0.7654415332644262}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 250, "num_steps_trained": 1000000, "num_steps_sampled": 126000, "sample_time_ms": 14.798, "replay_time_ms": 4.937, "grad_time_ms": 7.478, "update_time_ms": 6.538, "opt_peak_throughput": 4278.947, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -162.02578735351562, "min_q": -921.3018188476562, "max_q": -71.13184356689453, "mean_td_error": 4.143518924713135}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 126000, "episodes_total": 125, "training_iteration": 126, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-49-44", "timestamp": 1565081384, "time_this_iter_s": 9.469417810440063, "time_total_s": 972.9908635616302, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 972.9908635616302, "timesteps_since_restore": 126000, "iterations_since_restore": 126}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2124.52, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7296920523574698, "mean_processing_ms": 0.17302142181878657, "mean_inference_ms": 0.765164477460869}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 251, "num_steps_trained": 1008000, "num_steps_sampled": 127000, "sample_time_ms": 15.072, "replay_time_ms": 5.772, "grad_time_ms": 7.229, "update_time_ms": 6.712, "opt_peak_throughput": 4426.531, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -103.25929260253906, "min_q": -154.95484924316406, "max_q": -71.40814208984375, "mean_td_error": 3.0746047496795654}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 127000, "episodes_total": 126, "training_iteration": 127, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-49-52", "timestamp": 1565081392, "time_this_iter_s": 8.20822024345398, "time_total_s": 981.1990838050842, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 981.1990838050842, "timesteps_since_restore": 127000, "iterations_since_restore": 127}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2131.6, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7293804472947769, "mean_processing_ms": 0.17298775157294966, "mean_inference_ms": 0.7649076368661322}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 253, "num_steps_trained": 1016000, "num_steps_sampled": 128000, "sample_time_ms": 11.402, "replay_time_ms": 4.158, "grad_time_ms": 5.866, "update_time_ms": 5.682, "opt_peak_throughput": 5455.362, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -100.12782287597656, "min_q": -159.1285400390625, "max_q": -71.11573028564453, "mean_td_error": 1.8367798328399658}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 128000, "episodes_total": 127, "training_iteration": 128, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-49-59", "timestamp": 1565081399, "time_this_iter_s": 7.033280849456787, "time_total_s": 988.232364654541, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 988.232364654541, "timesteps_since_restore": 128000, "iterations_since_restore": 128}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2134.03, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7290985797836345, "mean_processing_ms": 0.172959321277813, "mean_inference_ms": 0.7646729988354007}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 255, "num_steps_trained": 1024000, "num_steps_sampled": 129000, "sample_time_ms": 11.383, "replay_time_ms": 4.105, "grad_time_ms": 5.744, "update_time_ms": 4.91, "opt_peak_throughput": 5571.05, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -148.0430145263672, "min_q": -937.1426391601562, "max_q": -70.59197235107422, "mean_td_error": 2.4216701984405518}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 129000, "episodes_total": 128, "training_iteration": 129, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-50-06", "timestamp": 1565081406, "time_this_iter_s": 6.866976261138916, "time_total_s": 995.0993409156799, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 995.0993409156799, "timesteps_since_restore": 129000, "iterations_since_restore": 129}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2133.65, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7288104660710383, "mean_processing_ms": 0.17292759152213882, "mean_inference_ms": 0.7644352352749059}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 257, "num_steps_trained": 1032000, "num_steps_sampled": 130000, "sample_time_ms": 16.342, "replay_time_ms": 6.055, "grad_time_ms": 7.78, "update_time_ms": 7.442, "opt_peak_throughput": 4112.869, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -102.83195495605469, "min_q": -289.7011413574219, "max_q": -71.18000793457031, "mean_td_error": -3.250985622406006}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 130000, "episodes_total": 129, "training_iteration": 130, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-50-13", "timestamp": 1565081413, "time_this_iter_s": 7.240870952606201, "time_total_s": 1002.3402118682861, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1002.3402118682861, "timesteps_since_restore": 130000, "iterations_since_restore": 130}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2129.28, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.728539577743055, "mean_processing_ms": 0.17289805205053813, "mean_inference_ms": 0.764204965428906}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 259, "num_steps_trained": 1040000, "num_steps_sampled": 131000, "sample_time_ms": 12.904, "replay_time_ms": 4.062, "grad_time_ms": 5.852, "update_time_ms": 5.489, "opt_peak_throughput": 5467.941, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -95.59571838378906, "min_q": -144.33218383789062, "max_q": -71.86177062988281, "mean_td_error": -1.4274492263793945}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 131000, "episodes_total": 130, "training_iteration": 131, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-50-21", "timestamp": 1565081421, "time_this_iter_s": 7.947881460189819, "time_total_s": 1010.288093328476, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1010.288093328476, "timesteps_since_restore": 131000, "iterations_since_restore": 131}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2126.23, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.728281537529196, "mean_processing_ms": 0.1728705123340858, "mean_inference_ms": 0.7639847250189511}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 261, "num_steps_trained": 1048000, "num_steps_sampled": 132000, "sample_time_ms": 12.036, "replay_time_ms": 4.189, "grad_time_ms": 5.679, "update_time_ms": 5.511, "opt_peak_throughput": 5634.476, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -124.00170135498047, "min_q": -823.5477294921875, "max_q": -72.74400329589844, "mean_td_error": 0.22548532485961914}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 132000, "episodes_total": 131, "training_iteration": 132, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-50-28", "timestamp": 1565081428, "time_this_iter_s": 7.421611547470093, "time_total_s": 1017.709704875946, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1017.709704875946, "timesteps_since_restore": 132000, "iterations_since_restore": 132}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2109.45, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7279697805826295, "mean_processing_ms": 0.17283189582336952, "mean_inference_ms": 0.763718853953395}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 263, "num_steps_trained": 1056000, "num_steps_sampled": 133000, "sample_time_ms": 11.261, "replay_time_ms": 3.717, "grad_time_ms": 5.311, "update_time_ms": 5.031, "opt_peak_throughput": 6024.811, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -138.79336547851562, "min_q": -879.6029052734375, "max_q": -70.74471282958984, "mean_td_error": 0.45766234397888184}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 133000, "episodes_total": 132, "training_iteration": 133, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-50-35", "timestamp": 1565081435, "time_this_iter_s": 6.723856687545776, "time_total_s": 1024.4335615634918, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1024.4335615634918, "timesteps_since_restore": 133000, "iterations_since_restore": 133}
{"episode_reward_max": -1145.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2092.06, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7276536701699068, "mean_processing_ms": 0.17278978905104175, "mean_inference_ms": 0.763441248974625}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 265, "num_steps_trained": 1064000, "num_steps_sampled": 134000, "sample_time_ms": 14.722, "replay_time_ms": 5.208, "grad_time_ms": 7.478, "update_time_ms": 7.045, "opt_peak_throughput": 4279.192, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -151.11582946777344, "min_q": -1054.9312744140625, "max_q": -71.96732330322266, "mean_td_error": 1.3225975036621094}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 134000, "episodes_total": 133, "training_iteration": 134, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-50-43", "timestamp": 1565081443, "time_this_iter_s": 7.562500715255737, "time_total_s": 1031.9960622787476, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1031.9960622787476, "timesteps_since_restore": 134000, "iterations_since_restore": 134}
{"episode_reward_max": -1115.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2086.71, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7273461976150825, "mean_processing_ms": 0.17274877891707174, "mean_inference_ms": 0.7631689920396587}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 267, "num_steps_trained": 1072000, "num_steps_sampled": 135000, "sample_time_ms": 11.93, "replay_time_ms": 4.231, "grad_time_ms": 5.794, "update_time_ms": 5.534, "opt_peak_throughput": 5522.954, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.90728759765625, "min_q": -372.22540283203125, "max_q": -72.07369995117188, "mean_td_error": 3.3394827842712402}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 135000, "episodes_total": 134, "training_iteration": 135, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-50-50", "timestamp": 1565081450, "time_this_iter_s": 7.66452431678772, "time_total_s": 1039.6605865955353, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1039.6605865955353, "timesteps_since_restore": 135000, "iterations_since_restore": 135}
{"episode_reward_max": -1115.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2085.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7270210183596849, "mean_processing_ms": 0.17270334483199176, "mean_inference_ms": 0.7628802012480338}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 269, "num_steps_trained": 1080000, "num_steps_sampled": 136000, "sample_time_ms": 12.249, "replay_time_ms": 4.539, "grad_time_ms": 6.046, "update_time_ms": 5.766, "opt_peak_throughput": 5293.019, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -120.21675109863281, "min_q": -747.3025512695312, "max_q": -72.23747253417969, "mean_td_error": 3.062873601913452}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 136000, "episodes_total": 135, "training_iteration": 136, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-50-57", "timestamp": 1565081457, "time_this_iter_s": 6.713579893112183, "time_total_s": 1046.3741664886475, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1046.3741664886475, "timesteps_since_restore": 136000, "iterations_since_restore": 136}
{"episode_reward_max": -1115.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2082.12, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7266746784225551, "mean_processing_ms": 0.1726522074774006, "mean_inference_ms": 0.7625722565344752}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 271, "num_steps_trained": 1088000, "num_steps_sampled": 137000, "sample_time_ms": 15.359, "replay_time_ms": 4.798, "grad_time_ms": 6.282, "update_time_ms": 6.073, "opt_peak_throughput": 5094.309, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -100.03832244873047, "min_q": -161.57064819335938, "max_q": -73.31181335449219, "mean_td_error": -0.13362503051757812}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 137000, "episodes_total": 136, "training_iteration": 137, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-51-05", "timestamp": 1565081465, "time_this_iter_s": 8.08284592628479, "time_total_s": 1054.4570124149323, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1054.4570124149323, "timesteps_since_restore": 137000, "iterations_since_restore": 137}
{"episode_reward_max": -1115.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2083.27, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7263144619151798, "mean_processing_ms": 0.17259574250612153, "mean_inference_ms": 0.762251203943569}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 273, "num_steps_trained": 1096000, "num_steps_sampled": 138000, "sample_time_ms": 11.689, "replay_time_ms": 4.028, "grad_time_ms": 5.515, "update_time_ms": 4.962, "opt_peak_throughput": 5802.881, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -125.94497680664062, "min_q": -1113.35888671875, "max_q": -73.63578796386719, "mean_td_error": -0.11067771911621094}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 138000, "episodes_total": 137, "training_iteration": 138, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-51-12", "timestamp": 1565081472, "time_this_iter_s": 7.203473329544067, "time_total_s": 1061.6604857444763, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1061.6604857444763, "timesteps_since_restore": 138000, "iterations_since_restore": 138}
{"episode_reward_max": -1115.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2087.49, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7259371834985069, "mean_processing_ms": 0.17253345361230976, "mean_inference_ms": 0.7619119665396176}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 275, "num_steps_trained": 1104000, "num_steps_sampled": 139000, "sample_time_ms": 11.551, "replay_time_ms": 4.379, "grad_time_ms": 6.247, "update_time_ms": 5.626, "opt_peak_throughput": 5122.228, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -92.01077270507812, "min_q": -218.87046813964844, "max_q": -71.51793670654297, "mean_td_error": 1.7047724723815918}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 139000, "episodes_total": 138, "training_iteration": 139, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-51-19", "timestamp": 1565081479, "time_this_iter_s": 6.815217018127441, "time_total_s": 1068.4757027626038, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1068.4757027626038, "timesteps_since_restore": 139000, "iterations_since_restore": 139}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2081.2, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.725560969740054, "mean_processing_ms": 0.17247034308655512, "mean_inference_ms": 0.761571709711627}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 277, "num_steps_trained": 1112000, "num_steps_sampled": 140000, "sample_time_ms": 14.822, "replay_time_ms": 4.083, "grad_time_ms": 5.673, "update_time_ms": 5.864, "opt_peak_throughput": 5640.585, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -108.9198226928711, "min_q": -303.3738708496094, "max_q": -71.51383972167969, "mean_td_error": 3.4497125148773193}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 140000, "episodes_total": 139, "training_iteration": 140, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-51-26", "timestamp": 1565081486, "time_this_iter_s": 6.704245567321777, "time_total_s": 1075.1799483299255, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1075.1799483299255, "timesteps_since_restore": 140000, "iterations_since_restore": 140}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2069.17, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7251905363223264, "mean_processing_ms": 0.17240767429785506, "mean_inference_ms": 0.7612349897570823}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 279, "num_steps_trained": 1120000, "num_steps_sampled": 141000, "sample_time_ms": 12.606, "replay_time_ms": 4.123, "grad_time_ms": 5.695, "update_time_ms": 5.445, "opt_peak_throughput": 5618.79, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -123.0934829711914, "min_q": -1172.4306640625, "max_q": -71.39073944091797, "mean_td_error": 4.545865058898926}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 141000, "episodes_total": 140, "training_iteration": 141, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-51-33", "timestamp": 1565081493, "time_this_iter_s": 6.712976694107056, "time_total_s": 1081.8929250240326, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1081.8929250240326, "timesteps_since_restore": 141000, "iterations_since_restore": 141}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2053.84, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7248326005966057, "mean_processing_ms": 0.17234700825908725, "mean_inference_ms": 0.7609084597682418}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 281, "num_steps_trained": 1128000, "num_steps_sampled": 142000, "sample_time_ms": 12.141, "replay_time_ms": 3.977, "grad_time_ms": 5.586, "update_time_ms": 5.346, "opt_peak_throughput": 5728.505, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -134.17127990722656, "min_q": -1112.517822265625, "max_q": -72.50015258789062, "mean_td_error": 3.625325918197632}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 142000, "episodes_total": 141, "training_iteration": 142, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-51-39", "timestamp": 1565081499, "time_this_iter_s": 6.677325248718262, "time_total_s": 1088.5702502727509, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1088.5702502727509, "timesteps_since_restore": 142000, "iterations_since_restore": 142}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2045.74, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7244951309317882, "mean_processing_ms": 0.1722901835717256, "mean_inference_ms": 0.7605975135043497}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 283, "num_steps_trained": 1136000, "num_steps_sampled": 143000, "sample_time_ms": 14.794, "replay_time_ms": 5.781, "grad_time_ms": 7.587, "update_time_ms": 7.622, "opt_peak_throughput": 4217.474, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -129.3061981201172, "min_q": -1031.2532958984375, "max_q": -72.3652114868164, "mean_td_error": 1.1583242416381836}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 143000, "episodes_total": 142, "training_iteration": 143, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-51-47", "timestamp": 1565081507, "time_this_iter_s": 7.643290758132935, "time_total_s": 1096.2135410308838, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1096.2135410308838, "timesteps_since_restore": 143000, "iterations_since_restore": 143}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2032.61, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7241650447189251, "mean_processing_ms": 0.17223408632122428, "mean_inference_ms": 0.7602905142698618}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 285, "num_steps_trained": 1144000, "num_steps_sampled": 144000, "sample_time_ms": 12.058, "replay_time_ms": 4.571, "grad_time_ms": 5.884, "update_time_ms": 5.821, "opt_peak_throughput": 5438.65, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -138.37767028808594, "min_q": -1088.8798828125, "max_q": -73.57534790039062, "mean_td_error": -6.88801908493042}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 144000, "episodes_total": 143, "training_iteration": 144, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-51-55", "timestamp": 1565081515, "time_this_iter_s": 7.599611759185791, "time_total_s": 1103.8131527900696, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1103.8131527900696, "timesteps_since_restore": 144000, "iterations_since_restore": 144}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2028.49, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7238256662774201, "mean_processing_ms": 0.1721751405493419, "mean_inference_ms": 0.7599747225065997}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 287, "num_steps_trained": 1152000, "num_steps_sampled": 145000, "sample_time_ms": 14.202, "replay_time_ms": 4.714, "grad_time_ms": 6.366, "update_time_ms": 6.959, "opt_peak_throughput": 5026.881, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -161.62533569335938, "min_q": -1206.481689453125, "max_q": -73.91683197021484, "mean_td_error": 4.832068920135498}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 145000, "episodes_total": 144, "training_iteration": 145, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-52-02", "timestamp": 1565081522, "time_this_iter_s": 7.132124662399292, "time_total_s": 1110.9452774524689, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1110.9452774524689, "timesteps_since_restore": 145000, "iterations_since_restore": 145}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2021.87, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7234884579429468, "mean_processing_ms": 0.17211644002326687, "mean_inference_ms": 0.759665719040354}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 289, "num_steps_trained": 1160000, "num_steps_sampled": 146000, "sample_time_ms": 12.914, "replay_time_ms": 4.166, "grad_time_ms": 5.932, "update_time_ms": 6.197, "opt_peak_throughput": 5394.365, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -134.31265258789062, "min_q": -996.69970703125, "max_q": -73.17169952392578, "mean_td_error": 1.7916195392608643}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 146000, "episodes_total": 145, "training_iteration": 146, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-52-09", "timestamp": 1565081529, "time_this_iter_s": 7.037425994873047, "time_total_s": 1117.982703447342, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1117.982703447342, "timesteps_since_restore": 146000, "iterations_since_restore": 146}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2013.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7231614900025847, "mean_processing_ms": 0.17205946582085363, "mean_inference_ms": 0.7593645078562549}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 291, "num_steps_trained": 1168000, "num_steps_sampled": 147000, "sample_time_ms": 13.322, "replay_time_ms": 4.488, "grad_time_ms": 6.089, "update_time_ms": 5.813, "opt_peak_throughput": 5255.382, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -170.95077514648438, "min_q": -1257.983154296875, "max_q": -72.99088287353516, "mean_td_error": 2.627415180206299}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 147000, "episodes_total": 146, "training_iteration": 147, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-52-17", "timestamp": 1565081537, "time_this_iter_s": 8.18671727180481, "time_total_s": 1126.1694207191467, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1126.1694207191467, "timesteps_since_restore": 147000, "iterations_since_restore": 147}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -2009.91, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7228401236333347, "mean_processing_ms": 0.17200332318417064, "mean_inference_ms": 0.7590689846592649}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 293, "num_steps_trained": 1176000, "num_steps_sampled": 148000, "sample_time_ms": 13.965, "replay_time_ms": 4.967, "grad_time_ms": 6.412, "update_time_ms": 6.104, "opt_peak_throughput": 4990.546, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -101.1351318359375, "min_q": -169.91705322265625, "max_q": -75.13815307617188, "mean_td_error": 5.219995975494385}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 148000, "episodes_total": 147, "training_iteration": 148, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-52-25", "timestamp": 1565081545, "time_this_iter_s": 7.8782570362091064, "time_total_s": 1134.0476777553558, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1134.0476777553558, "timesteps_since_restore": 148000, "iterations_since_restore": 148}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1959.88, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7225249471420905, "mean_processing_ms": 0.17194723948392318, "mean_inference_ms": 0.7587765957759263}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 295, "num_steps_trained": 1184000, "num_steps_sampled": 149000, "sample_time_ms": 11.077, "replay_time_ms": 3.625, "grad_time_ms": 5.115, "update_time_ms": 4.958, "opt_peak_throughput": 6256.303, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -111.59979248046875, "min_q": -178.9715118408203, "max_q": -73.62469482421875, "mean_td_error": 3.866460084915161}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 149000, "episodes_total": 148, "training_iteration": 149, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-52-33", "timestamp": 1565081553, "time_this_iter_s": 8.043769121170044, "time_total_s": 1142.0914468765259, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1142.0914468765259, "timesteps_since_restore": 149000, "iterations_since_restore": 149}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1963.19, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7222232463314404, "mean_processing_ms": 0.17189339930580325, "mean_inference_ms": 0.7584884431259694}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 297, "num_steps_trained": 1192000, "num_steps_sampled": 150000, "sample_time_ms": 12.414, "replay_time_ms": 4.251, "grad_time_ms": 5.613, "update_time_ms": 5.243, "opt_peak_throughput": 5701.106, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -117.14942932128906, "min_q": -194.33543395996094, "max_q": -74.0036849975586, "mean_td_error": -0.06754899024963379}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 150000, "episodes_total": 149, "training_iteration": 150, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-52-40", "timestamp": 1565081560, "time_this_iter_s": 6.6922125816345215, "time_total_s": 1148.7836594581604, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1148.7836594581604, "timesteps_since_restore": 150000, "iterations_since_restore": 150}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1964.32, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7219126276847376, "mean_processing_ms": 0.17183696786591945, "mean_inference_ms": 0.758195106300596}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 299, "num_steps_trained": 1200000, "num_steps_sampled": 151000, "sample_time_ms": 13.62, "replay_time_ms": 4.553, "grad_time_ms": 5.996, "update_time_ms": 5.605, "opt_peak_throughput": 5336.859, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -131.5411376953125, "min_q": -716.5043334960938, "max_q": -74.73823547363281, "mean_td_error": 0.7097053527832031}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 151000, "episodes_total": 150, "training_iteration": 151, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-52-47", "timestamp": 1565081567, "time_this_iter_s": 7.11585259437561, "time_total_s": 1155.899512052536, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1155.899512052536, "timesteps_since_restore": 151000, "iterations_since_restore": 151}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1958.78, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7216171521309553, "mean_processing_ms": 0.1717837938653922, "mean_inference_ms": 0.7579171840331764}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 301, "num_steps_trained": 1208000, "num_steps_sampled": 152000, "sample_time_ms": 13.512, "replay_time_ms": 4.523, "grad_time_ms": 6.069, "update_time_ms": 5.907, "opt_peak_throughput": 5272.952, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -121.1412582397461, "min_q": -938.7050170898438, "max_q": -75.71219635009766, "mean_td_error": 3.526719093322754}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 152000, "episodes_total": 151, "training_iteration": 152, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-52-56", "timestamp": 1565081576, "time_this_iter_s": 8.985946416854858, "time_total_s": 1164.8854584693909, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1164.8854584693909, "timesteps_since_restore": 152000, "iterations_since_restore": 152}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1946.01, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7212956275566473, "mean_processing_ms": 0.17172443303796112, "mean_inference_ms": 0.7576171753933039}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 303, "num_steps_trained": 1216000, "num_steps_sampled": 153000, "sample_time_ms": 10.509, "replay_time_ms": 4.024, "grad_time_ms": 5.563, "update_time_ms": 5.194, "opt_peak_throughput": 5752.295, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -102.93031311035156, "min_q": -180.01348876953125, "max_q": -74.94234466552734, "mean_td_error": -1.559283971786499}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 153000, "episodes_total": 152, "training_iteration": 153, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-03", "timestamp": 1565081583, "time_this_iter_s": 7.008101463317871, "time_total_s": 1171.8935599327087, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1171.8935599327087, "timesteps_since_restore": 153000, "iterations_since_restore": 153}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1943.58, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7209580509847592, "mean_processing_ms": 0.1716603921676289, "mean_inference_ms": 0.7572965878694127}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 305, "num_steps_trained": 1224000, "num_steps_sampled": 154000, "sample_time_ms": 11.951, "replay_time_ms": 4.065, "grad_time_ms": 5.376, "update_time_ms": 4.903, "opt_peak_throughput": 5952.296, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -113.9292221069336, "min_q": -212.31556701660156, "max_q": -76.3542709350586, "mean_td_error": 2.620880365371704}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 154000, "episodes_total": 153, "training_iteration": 154, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-09", "timestamp": 1565081589, "time_this_iter_s": 6.711220026016235, "time_total_s": 1178.604779958725, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1178.604779958725, "timesteps_since_restore": 154000, "iterations_since_restore": 154}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1947.3, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7206097783346636, "mean_processing_ms": 0.171595562246485, "mean_inference_ms": 0.7569745561964879}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 307, "num_steps_trained": 1232000, "num_steps_sampled": 155000, "sample_time_ms": 14.587, "replay_time_ms": 5.165, "grad_time_ms": 6.67, "update_time_ms": 6.519, "opt_peak_throughput": 4797.551, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -106.81095123291016, "min_q": -202.83998107910156, "max_q": -75.72386932373047, "mean_td_error": 1.1198041439056396}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 155000, "episodes_total": 154, "training_iteration": 155, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-16", "timestamp": 1565081596, "time_this_iter_s": 7.044708490371704, "time_total_s": 1185.6494884490967, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1185.6494884490967, "timesteps_since_restore": 155000, "iterations_since_restore": 155}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1954.04, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7202603291178299, "mean_processing_ms": 0.1715296378102276, "mean_inference_ms": 0.756648713274088}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 309, "num_steps_trained": 1240000, "num_steps_sampled": 156000, "sample_time_ms": 12.006, "replay_time_ms": 3.974, "grad_time_ms": 5.757, "update_time_ms": 5.605, "opt_peak_throughput": 5558.199, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -142.6974639892578, "min_q": -1197.1229248046875, "max_q": -75.3195571899414, "mean_td_error": 3.553600311279297}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 156000, "episodes_total": 155, "training_iteration": 156, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-23", "timestamp": 1565081603, "time_this_iter_s": 6.750732421875, "time_total_s": 1192.4002208709717, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1192.4002208709717, "timesteps_since_restore": 156000, "iterations_since_restore": 156}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1950.92, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7199097296158627, "mean_processing_ms": 0.1714625790404383, "mean_inference_ms": 0.7563170779553938}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 311, "num_steps_trained": 1248000, "num_steps_sampled": 157000, "sample_time_ms": 12.365, "replay_time_ms": 4.483, "grad_time_ms": 6.036, "update_time_ms": 5.301, "opt_peak_throughput": 5301.759, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -107.43183135986328, "min_q": -158.84657287597656, "max_q": -74.86190795898438, "mean_td_error": 2.0491528511047363}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 157000, "episodes_total": 156, "training_iteration": 157, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-30", "timestamp": 1565081610, "time_this_iter_s": 6.5841875076293945, "time_total_s": 1198.984408378601, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1198.984408378601, "timesteps_since_restore": 157000, "iterations_since_restore": 157}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1954.29, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7195289326742943, "mean_processing_ms": 0.17138780352345911, "mean_inference_ms": 0.7559558428180436}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 313, "num_steps_trained": 1256000, "num_steps_sampled": 158000, "sample_time_ms": 12.512, "replay_time_ms": 4.022, "grad_time_ms": 5.602, "update_time_ms": 5.3, "opt_peak_throughput": 5712.146, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -141.6531219482422, "min_q": -1411.7293701171875, "max_q": -74.20914459228516, "mean_td_error": -1.2276251316070557}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 158000, "episodes_total": 157, "training_iteration": 158, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-37", "timestamp": 1565081617, "time_this_iter_s": 6.665602922439575, "time_total_s": 1205.6500113010406, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1205.6500113010406, "timesteps_since_restore": 158000, "iterations_since_restore": 158}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1947.46, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7191344612549868, "mean_processing_ms": 0.17130900200616161, "mean_inference_ms": 0.7555810574745904}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 315, "num_steps_trained": 1264000, "num_steps_sampled": 159000, "sample_time_ms": 11.754, "replay_time_ms": 3.69, "grad_time_ms": 5.335, "update_time_ms": 5.179, "opt_peak_throughput": 5997.888, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -112.65093994140625, "min_q": -198.18553161621094, "max_q": -73.39399719238281, "mean_td_error": 2.2789437770843506}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 159000, "episodes_total": 158, "training_iteration": 159, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-43", "timestamp": 1565081623, "time_this_iter_s": 6.74065637588501, "time_total_s": 1212.3906676769257, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1212.3906676769257, "timesteps_since_restore": 159000, "iterations_since_restore": 159}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1949.97, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7187406557348072, "mean_processing_ms": 0.1712300567447049, "mean_inference_ms": 0.7552053992832727}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 317, "num_steps_trained": 1272000, "num_steps_sampled": 160000, "sample_time_ms": 11.097, "replay_time_ms": 3.747, "grad_time_ms": 5.317, "update_time_ms": 4.814, "opt_peak_throughput": 6017.896, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.57435607910156, "min_q": -257.733154296875, "max_q": -73.45194244384766, "mean_td_error": 1.1837856769561768}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 160000, "episodes_total": 159, "training_iteration": 160, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-50", "timestamp": 1565081630, "time_this_iter_s": 6.725130558013916, "time_total_s": 1219.1157982349396, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1219.1157982349396, "timesteps_since_restore": 160000, "iterations_since_restore": 160}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1947.56, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7183449216981418, "mean_processing_ms": 0.1711503569768352, "mean_inference_ms": 0.7548260073513319}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 319, "num_steps_trained": 1280000, "num_steps_sampled": 161000, "sample_time_ms": 15.828, "replay_time_ms": 5.765, "grad_time_ms": 7.744, "update_time_ms": 6.884, "opt_peak_throughput": 4132.396, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -114.16029357910156, "min_q": -196.65310668945312, "max_q": -73.16651916503906, "mean_td_error": 6.271132469177246}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 161000, "episodes_total": 160, "training_iteration": 161, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-53-57", "timestamp": 1565081637, "time_this_iter_s": 7.0336222648620605, "time_total_s": 1226.1494204998016, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1226.1494204998016, "timesteps_since_restore": 161000, "iterations_since_restore": 161}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1952.45, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7179654258586516, "mean_processing_ms": 0.17107405720335453, "mean_inference_ms": 0.7544565350430229}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 321, "num_steps_trained": 1288000, "num_steps_sampled": 162000, "sample_time_ms": 13.419, "replay_time_ms": 4.309, "grad_time_ms": 6.114, "update_time_ms": 5.344, "opt_peak_throughput": 5233.619, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -103.07838439941406, "min_q": -184.98648071289062, "max_q": -75.39241027832031, "mean_td_error": 4.533637046813965}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 162000, "episodes_total": 161, "training_iteration": 162, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-54-05", "timestamp": 1565081645, "time_this_iter_s": 7.904305696487427, "time_total_s": 1234.053726196289, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1234.053726196289, "timesteps_since_restore": 162000, "iterations_since_restore": 162}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1955.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7175981363778005, "mean_processing_ms": 0.17100071223522062, "mean_inference_ms": 0.7540985012791617}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 323, "num_steps_trained": 1296000, "num_steps_sampled": 163000, "sample_time_ms": 13.849, "replay_time_ms": 4.9, "grad_time_ms": 6.841, "update_time_ms": 5.977, "opt_peak_throughput": 4677.929, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -132.54208374023438, "min_q": -389.44610595703125, "max_q": -73.84087371826172, "mean_td_error": 4.6882004737854}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 163000, "episodes_total": 162, "training_iteration": 163, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-54-13", "timestamp": 1565081653, "time_this_iter_s": 7.756981372833252, "time_total_s": 1241.8107075691223, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1241.8107075691223, "timesteps_since_restore": 163000, "iterations_since_restore": 163}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1923.47, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7172222367718578, "mean_processing_ms": 0.17092524140674303, "mean_inference_ms": 0.753732330958125}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 325, "num_steps_trained": 1304000, "num_steps_sampled": 164000, "sample_time_ms": 13.041, "replay_time_ms": 4.293, "grad_time_ms": 6.013, "update_time_ms": 5.672, "opt_peak_throughput": 5321.687, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -116.1718521118164, "min_q": -293.6190185546875, "max_q": -74.2117919921875, "mean_td_error": 4.338464736938477}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 164000, "episodes_total": 163, "training_iteration": 164, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-54-20", "timestamp": 1565081660, "time_this_iter_s": 7.140776872634888, "time_total_s": 1248.9514844417572, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1248.9514844417572, "timesteps_since_restore": 164000, "iterations_since_restore": 164}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1941.98, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7168654698463085, "mean_processing_ms": 0.1708530989413099, "mean_inference_ms": 0.753381798930057}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 327, "num_steps_trained": 1312000, "num_steps_sampled": 165000, "sample_time_ms": 15.352, "replay_time_ms": 5.589, "grad_time_ms": 7.488, "update_time_ms": 7.405, "opt_peak_throughput": 4273.348, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -114.69877624511719, "min_q": -286.3007507324219, "max_q": -74.57539367675781, "mean_td_error": 6.917398452758789}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 165000, "episodes_total": 164, "training_iteration": 165, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-54-28", "timestamp": 1565081668, "time_this_iter_s": 7.876170635223389, "time_total_s": 1256.8276550769806, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1256.8276550769806, "timesteps_since_restore": 165000, "iterations_since_restore": 165}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1942.04, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7165054245190515, "mean_processing_ms": 0.17077959775823076, "mean_inference_ms": 0.7530246295066579}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 329, "num_steps_trained": 1320000, "num_steps_sampled": 166000, "sample_time_ms": 11.528, "replay_time_ms": 4.206, "grad_time_ms": 5.895, "update_time_ms": 5.277, "opt_peak_throughput": 5428.268, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -98.72944641113281, "min_q": -156.3045654296875, "max_q": -72.90019226074219, "mean_td_error": -6.898748397827148}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 166000, "episodes_total": 165, "training_iteration": 166, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-54-35", "timestamp": 1565081675, "time_this_iter_s": 7.666461229324341, "time_total_s": 1264.494116306305, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1264.494116306305, "timesteps_since_restore": 166000, "iterations_since_restore": 166}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1935.7, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7161603148904355, "mean_processing_ms": 0.170709112623504, "mean_inference_ms": 0.7526802373484242}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 331, "num_steps_trained": 1328000, "num_steps_sampled": 167000, "sample_time_ms": 16.446, "replay_time_ms": 6.001, "grad_time_ms": 7.666, "update_time_ms": 7.367, "opt_peak_throughput": 4174.28, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -103.52876281738281, "min_q": -164.26065063476562, "max_q": -73.47943115234375, "mean_td_error": 0.9703631401062012}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 167000, "episodes_total": 166, "training_iteration": 167, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-54-44", "timestamp": 1565081684, "time_this_iter_s": 9.008189916610718, "time_total_s": 1273.5023062229156, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1273.5023062229156, "timesteps_since_restore": 167000, "iterations_since_restore": 167}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1927.5, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7158318542891883, "mean_processing_ms": 0.17064204556845067, "mean_inference_ms": 0.7523471379571564}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 333, "num_steps_trained": 1336000, "num_steps_sampled": 168000, "sample_time_ms": 12.521, "replay_time_ms": 4.111, "grad_time_ms": 5.675, "update_time_ms": 5.657, "opt_peak_throughput": 5638.903, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -99.62387084960938, "min_q": -165.363525390625, "max_q": -71.13633728027344, "mean_td_error": 0.24872446060180664}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 168000, "episodes_total": 167, "training_iteration": 168, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-54-53", "timestamp": 1565081693, "time_this_iter_s": 8.090866327285767, "time_total_s": 1281.5931725502014, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1281.5931725502014, "timesteps_since_restore": 168000, "iterations_since_restore": 168}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1931.75, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7154939421074059, "mean_processing_ms": 0.1705727592846458, "mean_inference_ms": 0.7520071086555135}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 335, "num_steps_trained": 1344000, "num_steps_sampled": 169000, "sample_time_ms": 12.308, "replay_time_ms": 4.494, "grad_time_ms": 6.17, "update_time_ms": 5.632, "opt_peak_throughput": 5186.237, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -93.77117919921875, "min_q": -154.2917938232422, "max_q": -73.3976821899414, "mean_td_error": 0.3400273323059082}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 169000, "episodes_total": 168, "training_iteration": 169, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-00", "timestamp": 1565081700, "time_this_iter_s": 7.584309816360474, "time_total_s": 1289.177482366562, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1289.177482366562, "timesteps_since_restore": 169000, "iterations_since_restore": 169}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1926.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7151454221786915, "mean_processing_ms": 0.17050055997464952, "mean_inference_ms": 0.7516579890996189}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 337, "num_steps_trained": 1352000, "num_steps_sampled": 170000, "sample_time_ms": 10.795, "replay_time_ms": 3.526, "grad_time_ms": 5.124, "update_time_ms": 4.719, "opt_peak_throughput": 6245.299, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -101.16912078857422, "min_q": -218.65736389160156, "max_q": -72.36865997314453, "mean_td_error": -1.3754940032958984}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 170000, "episodes_total": 169, "training_iteration": 170, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-07", "timestamp": 1565081707, "time_this_iter_s": 7.00537633895874, "time_total_s": 1296.1828587055206, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1296.1828587055206, "timesteps_since_restore": 170000, "iterations_since_restore": 170}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1922.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7148007005055567, "mean_processing_ms": 0.1704290100908795, "mean_inference_ms": 0.7513112225639604}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 339, "num_steps_trained": 1360000, "num_steps_sampled": 171000, "sample_time_ms": 16.814, "replay_time_ms": 5.755, "grad_time_ms": 7.497, "update_time_ms": 7.227, "opt_peak_throughput": 4268.346, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.59054565429688, "min_q": -197.85372924804688, "max_q": -71.83695983886719, "mean_td_error": 3.8816890716552734}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 171000, "episodes_total": 170, "training_iteration": 171, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-15", "timestamp": 1565081715, "time_this_iter_s": 7.652375936508179, "time_total_s": 1303.8352346420288, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1303.8352346420288, "timesteps_since_restore": 171000, "iterations_since_restore": 171}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1925.46, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7144085956692156, "mean_processing_ms": 0.17034553272048572, "mean_inference_ms": 0.7509020949898058}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 341, "num_steps_trained": 1368000, "num_steps_sampled": 172000, "sample_time_ms": 11.569, "replay_time_ms": 4.482, "grad_time_ms": 5.867, "update_time_ms": 5.422, "opt_peak_throughput": 5454.431, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -102.96749877929688, "min_q": -165.9234619140625, "max_q": -75.2567138671875, "mean_td_error": 1.0058274269104004}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 172000, "episodes_total": 171, "training_iteration": 172, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-22", "timestamp": 1565081722, "time_this_iter_s": 7.688249111175537, "time_total_s": 1311.5234837532043, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1311.5234837532043, "timesteps_since_restore": 172000, "iterations_since_restore": 172}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1929.39, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.713981070203729, "mean_processing_ms": 0.1702526470389046, "mean_inference_ms": 0.7504388114281402}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 343, "num_steps_trained": 1376000, "num_steps_sampled": 173000, "sample_time_ms": 11.705, "replay_time_ms": 4.461, "grad_time_ms": 5.886, "update_time_ms": 5.737, "opt_peak_throughput": 5436.623, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -107.26309204101562, "min_q": -182.612548828125, "max_q": -73.51712799072266, "mean_td_error": 0.9301989078521729}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 173000, "episodes_total": 172, "training_iteration": 173, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-29", "timestamp": 1565081729, "time_this_iter_s": 6.703351736068726, "time_total_s": 1318.226835489273, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1318.226835489273, "timesteps_since_restore": 173000, "iterations_since_restore": 173}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1934.61, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7135588202532918, "mean_processing_ms": 0.1701609187469092, "mean_inference_ms": 0.7499850531565815}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 345, "num_steps_trained": 1384000, "num_steps_sampled": 174000, "sample_time_ms": 10.969, "replay_time_ms": 3.782, "grad_time_ms": 5.363, "update_time_ms": 4.946, "opt_peak_throughput": 5966.717, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -112.68414306640625, "min_q": -236.54409790039062, "max_q": -73.6489486694336, "mean_td_error": -0.8275895118713379}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 174000, "episodes_total": 173, "training_iteration": 174, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-36", "timestamp": 1565081736, "time_this_iter_s": 6.759450435638428, "time_total_s": 1324.9862859249115, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1324.9862859249115, "timesteps_since_restore": 174000, "iterations_since_restore": 174}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1926.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7131517494618151, "mean_processing_ms": 0.17007276718610367, "mean_inference_ms": 0.7495487612427225}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 347, "num_steps_trained": 1392000, "num_steps_sampled": 175000, "sample_time_ms": 11.734, "replay_time_ms": 4.099, "grad_time_ms": 5.516, "update_time_ms": 5.068, "opt_peak_throughput": 5800.824, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -93.09568786621094, "min_q": -154.40316772460938, "max_q": -71.54650115966797, "mean_td_error": 1.643618106842041}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 175000, "episodes_total": 174, "training_iteration": 175, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-43", "timestamp": 1565081743, "time_this_iter_s": 6.866631031036377, "time_total_s": 1331.8529169559479, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1331.8529169559479, "timesteps_since_restore": 175000, "iterations_since_restore": 175}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1923.78, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.712757904303106, "mean_processing_ms": 0.16998781643235503, "mean_inference_ms": 0.7491283797231881}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 349, "num_steps_trained": 1400000, "num_steps_sampled": 176000, "sample_time_ms": 10.938, "replay_time_ms": 3.587, "grad_time_ms": 5.141, "update_time_ms": 5.289, "opt_peak_throughput": 6224.792, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -106.91206359863281, "min_q": -182.1302490234375, "max_q": -71.27338409423828, "mean_td_error": -1.7581701278686523}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 176000, "episodes_total": 175, "training_iteration": 176, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-50", "timestamp": 1565081750, "time_this_iter_s": 6.816960334777832, "time_total_s": 1338.6698772907257, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1338.6698772907257, "timesteps_since_restore": 176000, "iterations_since_restore": 176}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1922.09, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7123790121460075, "mean_processing_ms": 0.16990639356053283, "mean_inference_ms": 0.7487252543403068}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 351, "num_steps_trained": 1408000, "num_steps_sampled": 177000, "sample_time_ms": 15.107, "replay_time_ms": 5.266, "grad_time_ms": 7.458, "update_time_ms": 7.042, "opt_peak_throughput": 4290.601, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -100.21874237060547, "min_q": -200.42137145996094, "max_q": -73.76363372802734, "mean_td_error": -0.8187315464019775}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 177000, "episodes_total": 176, "training_iteration": 177, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-55-57", "timestamp": 1565081757, "time_this_iter_s": 7.115046977996826, "time_total_s": 1345.7849242687225, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1345.7849242687225, "timesteps_since_restore": 177000, "iterations_since_restore": 177}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1916.6, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.712020232363753, "mean_processing_ms": 0.16982969219050542, "mean_inference_ms": 0.7483428832423894}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 353, "num_steps_trained": 1416000, "num_steps_sampled": 178000, "sample_time_ms": 12.94, "replay_time_ms": 4.428, "grad_time_ms": 5.876, "update_time_ms": 5.304, "opt_peak_throughput": 5445.778, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -102.64159393310547, "min_q": -275.44439697265625, "max_q": -72.80680084228516, "mean_td_error": -2.051290512084961}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 178000, "episodes_total": 177, "training_iteration": 178, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-56-05", "timestamp": 1565081765, "time_this_iter_s": 8.03702425956726, "time_total_s": 1353.8219485282898, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1353.8219485282898, "timesteps_since_restore": 178000, "iterations_since_restore": 178}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1916.31, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7116536942791057, "mean_processing_ms": 0.16975095632302875, "mean_inference_ms": 0.7479573317634997}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 355, "num_steps_trained": 1424000, "num_steps_sampled": 179000, "sample_time_ms": 11.533, "replay_time_ms": 3.568, "grad_time_ms": 5.236, "update_time_ms": 5.09, "opt_peak_throughput": 6111.918, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -109.48760986328125, "min_q": -172.1938934326172, "max_q": -72.87871551513672, "mean_td_error": -2.2991504669189453}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 179000, "episodes_total": 178, "training_iteration": 179, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-56-12", "timestamp": 1565081772, "time_this_iter_s": 6.743403196334839, "time_total_s": 1360.5653517246246, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1360.5653517246246, "timesteps_since_restore": 179000, "iterations_since_restore": 179}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1911.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7112993936315193, "mean_processing_ms": 0.16967512517252, "mean_inference_ms": 0.7475848102747611}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 357, "num_steps_trained": 1432000, "num_steps_sampled": 180000, "sample_time_ms": 11.337, "replay_time_ms": 3.605, "grad_time_ms": 5.392, "update_time_ms": 4.873, "opt_peak_throughput": 5935.161, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -106.13994598388672, "min_q": -172.20944213867188, "max_q": -71.88693237304688, "mean_td_error": -2.602954387664795}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 180000, "episodes_total": 179, "training_iteration": 180, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-56-18", "timestamp": 1565081778, "time_this_iter_s": 6.77848219871521, "time_total_s": 1367.3438339233398, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1367.3438339233398, "timesteps_since_restore": 180000, "iterations_since_restore": 180}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1910.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.710955311909202, "mean_processing_ms": 0.16960148642775466, "mean_inference_ms": 0.7472240675237125}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 359, "num_steps_trained": 1440000, "num_steps_sampled": 181000, "sample_time_ms": 10.74, "replay_time_ms": 3.797, "grad_time_ms": 5.246, "update_time_ms": 4.966, "opt_peak_throughput": 6099.392, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -124.36141967773438, "min_q": -453.46307373046875, "max_q": -70.31925201416016, "mean_td_error": -0.4117400646209717}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 181000, "episodes_total": 180, "training_iteration": 181, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-56-25", "timestamp": 1565081785, "time_this_iter_s": 6.842543125152588, "time_total_s": 1374.1863770484924, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1374.1863770484924, "timesteps_since_restore": 181000, "iterations_since_restore": 181}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1916.12, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7106230071008264, "mean_processing_ms": 0.1695303967462631, "mean_inference_ms": 0.7468768227595135}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 361, "num_steps_trained": 1448000, "num_steps_sampled": 182000, "sample_time_ms": 12.898, "replay_time_ms": 4.597, "grad_time_ms": 7.396, "update_time_ms": 6.537, "opt_peak_throughput": 4326.631, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -115.20710754394531, "min_q": -208.10972595214844, "max_q": -70.83804321289062, "mean_td_error": -2.7253904342651367}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 182000, "episodes_total": 181, "training_iteration": 182, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-56-32", "timestamp": 1565081792, "time_this_iter_s": 6.950632333755493, "time_total_s": 1381.137009382248, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1381.137009382248, "timesteps_since_restore": 182000, "iterations_since_restore": 182}
{"episode_reward_max": -834.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1926.68, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7103094398995519, "mean_processing_ms": 0.1694634883197027, "mean_inference_ms": 0.7465486433224976}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 363, "num_steps_trained": 1456000, "num_steps_sampled": 183000, "sample_time_ms": 12.398, "replay_time_ms": 4.451, "grad_time_ms": 5.973, "update_time_ms": 5.674, "opt_peak_throughput": 5357.437, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -102.03958892822266, "min_q": -211.18414306640625, "max_q": -68.55066680908203, "mean_td_error": 1.2999064922332764}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 183000, "episodes_total": 182, "training_iteration": 183, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-56-40", "timestamp": 1565081800, "time_this_iter_s": 8.267201662063599, "time_total_s": 1389.4042110443115, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1389.4042110443115, "timesteps_since_restore": 183000, "iterations_since_restore": 183}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1918.24, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7100061435774476, "mean_processing_ms": 0.1693987891958847, "mean_inference_ms": 0.7462321609360767}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 365, "num_steps_trained": 1464000, "num_steps_sampled": 184000, "sample_time_ms": 11.807, "replay_time_ms": 3.727, "grad_time_ms": 5.256, "update_time_ms": 5.356, "opt_peak_throughput": 6087.911, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -113.47257232666016, "min_q": -538.8004150390625, "max_q": -70.01769256591797, "mean_td_error": -3.878660202026367}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 184000, "episodes_total": 183, "training_iteration": 184, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-56-47", "timestamp": 1565081807, "time_this_iter_s": 6.772098064422607, "time_total_s": 1396.1763091087341, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1396.1763091087341, "timesteps_since_restore": 184000, "iterations_since_restore": 184}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1924.04, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7097021196764095, "mean_processing_ms": 0.1693332362474634, "mean_inference_ms": 0.7459173385974285}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 367, "num_steps_trained": 1472000, "num_steps_sampled": 185000, "sample_time_ms": 16.09, "replay_time_ms": 5.732, "grad_time_ms": 7.09, "update_time_ms": 6.806, "opt_peak_throughput": 4513.553, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -101.52535247802734, "min_q": -190.4785614013672, "max_q": -68.04729461669922, "mean_td_error": 4.605774879455566}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 185000, "episodes_total": 184, "training_iteration": 185, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-56-55", "timestamp": 1565081815, "time_this_iter_s": 7.619930028915405, "time_total_s": 1403.7962391376495, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1403.7962391376495, "timesteps_since_restore": 185000, "iterations_since_restore": 185}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1923.14, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7094068624496402, "mean_processing_ms": 0.1692693874211673, "mean_inference_ms": 0.7456128506995755}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 369, "num_steps_trained": 1480000, "num_steps_sampled": 186000, "sample_time_ms": 11.836, "replay_time_ms": 4.65, "grad_time_ms": 6.58, "update_time_ms": 5.962, "opt_peak_throughput": 4863.208, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.15129089355469, "min_q": -190.5012969970703, "max_q": -68.63148498535156, "mean_td_error": 1.7204420566558838}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 186000, "episodes_total": 185, "training_iteration": 186, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-03", "timestamp": 1565081823, "time_this_iter_s": 7.760030269622803, "time_total_s": 1411.5562694072723, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1411.5562694072723, "timesteps_since_restore": 186000, "iterations_since_restore": 186}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1917.77, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7091207200294363, "mean_processing_ms": 0.16920757380875012, "mean_inference_ms": 0.7453193022903793}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 371, "num_steps_trained": 1488000, "num_steps_sampled": 187000, "sample_time_ms": 12.099, "replay_time_ms": 4.505, "grad_time_ms": 5.927, "update_time_ms": 5.427, "opt_peak_throughput": 5398.683, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -97.068115234375, "min_q": -182.2337188720703, "max_q": -68.05760192871094, "mean_td_error": -0.773190975189209}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 187000, "episodes_total": 186, "training_iteration": 187, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-09", "timestamp": 1565081829, "time_this_iter_s": 6.791409730911255, "time_total_s": 1418.3476791381836, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1418.3476791381836, "timesteps_since_restore": 187000, "iterations_since_restore": 187}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1921.93, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.708844906053947, "mean_processing_ms": 0.16914831750728043, "mean_inference_ms": 0.7450383450983361}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 373, "num_steps_trained": 1496000, "num_steps_sampled": 188000, "sample_time_ms": 11.708, "replay_time_ms": 4.288, "grad_time_ms": 5.603, "update_time_ms": 5.261, "opt_peak_throughput": 5711.052, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -119.07652282714844, "min_q": -468.4765319824219, "max_q": -67.44305419921875, "mean_td_error": 6.181326866149902}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 188000, "episodes_total": 187, "training_iteration": 188, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-16", "timestamp": 1565081836, "time_this_iter_s": 6.8666698932647705, "time_total_s": 1425.2143490314484, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1425.2143490314484, "timesteps_since_restore": 188000, "iterations_since_restore": 188}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1917.81, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7085639045901952, "mean_processing_ms": 0.16908791488701136, "mean_inference_ms": 0.7447552332894543}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 375, "num_steps_trained": 1504000, "num_steps_sampled": 189000, "sample_time_ms": 12.177, "replay_time_ms": 4.115, "grad_time_ms": 5.672, "update_time_ms": 5.257, "opt_peak_throughput": 5642.245, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -97.4842529296875, "min_q": -228.2615509033203, "max_q": -66.80936431884766, "mean_td_error": 9.120759963989258}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 189000, "episodes_total": 188, "training_iteration": 189, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-23", "timestamp": 1565081843, "time_this_iter_s": 6.8503594398498535, "time_total_s": 1432.0647084712982, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1432.0647084712982, "timesteps_since_restore": 189000, "iterations_since_restore": 189}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1919.77, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7082870646976235, "mean_processing_ms": 0.16902846822535633, "mean_inference_ms": 0.74447813564927}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 376, "num_steps_trained": 1512000, "num_steps_sampled": 190000, "sample_time_ms": 11.439, "replay_time_ms": 3.817, "grad_time_ms": 5.319, "update_time_ms": 4.911, "opt_peak_throughput": 6016.115, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -104.40493774414062, "min_q": -189.60792541503906, "max_q": -66.2712173461914, "mean_td_error": -0.9712510108947754}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 190000, "episodes_total": 189, "training_iteration": 190, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-30", "timestamp": 1565081850, "time_this_iter_s": 6.805870056152344, "time_total_s": 1438.8705785274506, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1438.8705785274506, "timesteps_since_restore": 190000, "iterations_since_restore": 190}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1904.92, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7080178830919176, "mean_processing_ms": 0.1689708630581196, "mean_inference_ms": 0.7442101018514906}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 378, "num_steps_trained": 1520000, "num_steps_sampled": 191000, "sample_time_ms": 12.446, "replay_time_ms": 3.982, "grad_time_ms": 5.917, "update_time_ms": 5.551, "opt_peak_throughput": 5408.516, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -93.87460327148438, "min_q": -188.44520568847656, "max_q": -67.42163848876953, "mean_td_error": -2.078435182571411}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 191000, "episodes_total": 190, "training_iteration": 191, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-37", "timestamp": 1565081857, "time_this_iter_s": 6.886096477508545, "time_total_s": 1445.756675004959, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1445.756675004959, "timesteps_since_restore": 191000, "iterations_since_restore": 191}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1901.24, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7077579822840399, "mean_processing_ms": 0.16891540102248065, "mean_inference_ms": 0.7439535611404069}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 380, "num_steps_trained": 1528000, "num_steps_sampled": 192000, "sample_time_ms": 13.161, "replay_time_ms": 4.241, "grad_time_ms": 5.762, "update_time_ms": 5.298, "opt_peak_throughput": 5553.508, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -88.13774871826172, "min_q": -156.81552124023438, "max_q": -67.49853515625, "mean_td_error": 2.5327932834625244}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 192000, "episodes_total": 191, "training_iteration": 192, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-44", "timestamp": 1565081864, "time_this_iter_s": 6.844151496887207, "time_total_s": 1452.6008265018463, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1452.6008265018463, "timesteps_since_restore": 192000, "iterations_since_restore": 192}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1892.94, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7075135731374006, "mean_processing_ms": 0.16886371310244802, "mean_inference_ms": 0.7437131732662915}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 382, "num_steps_trained": 1536000, "num_steps_sampled": 193000, "sample_time_ms": 15.361, "replay_time_ms": 4.475, "grad_time_ms": 6.136, "update_time_ms": 6.874, "opt_peak_throughput": 5214.81, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -118.17878723144531, "min_q": -552.3985595703125, "max_q": -66.60059356689453, "mean_td_error": -1.830920696258545}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 193000, "episodes_total": 192, "training_iteration": 193, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-52", "timestamp": 1565081872, "time_this_iter_s": 8.234920501708984, "time_total_s": 1460.8357470035553, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1460.8357470035553, "timesteps_since_restore": 193000, "iterations_since_restore": 193}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1888.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7072787692724993, "mean_processing_ms": 0.16881445397205092, "mean_inference_ms": 0.743483895888903}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 384, "num_steps_trained": 1544000, "num_steps_sampled": 194000, "sample_time_ms": 11.339, "replay_time_ms": 3.937, "grad_time_ms": 5.427, "update_time_ms": 5.259, "opt_peak_throughput": 5896.907, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -111.835205078125, "min_q": -172.9061737060547, "max_q": -66.2784423828125, "mean_td_error": -4.987715721130371}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 194000, "episodes_total": 193, "training_iteration": 194, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-57-59", "timestamp": 1565081879, "time_this_iter_s": 6.884530782699585, "time_total_s": 1467.7202777862549, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1467.7202777862549, "timesteps_since_restore": 194000, "iterations_since_restore": 194}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1880.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7070518191809214, "mean_processing_ms": 0.1687671745534211, "mean_inference_ms": 0.7432633634945277}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 386, "num_steps_trained": 1552000, "num_steps_sampled": 195000, "sample_time_ms": 11.212, "replay_time_ms": 3.851, "grad_time_ms": 5.191, "update_time_ms": 4.633, "opt_peak_throughput": 6164.128, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -93.55722045898438, "min_q": -160.9298095703125, "max_q": -66.10028076171875, "mean_td_error": 3.0635530948638916}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 195000, "episodes_total": 194, "training_iteration": 195, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-58-06", "timestamp": 1565081886, "time_this_iter_s": 6.794502258300781, "time_total_s": 1474.5147800445557, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1474.5147800445557, "timesteps_since_restore": 195000, "iterations_since_restore": 195}
{"episode_reward_max": -832.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1877.32, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7068320503520362, "mean_processing_ms": 0.1687216607126754, "mean_inference_ms": 0.7430515976651622}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 388, "num_steps_trained": 1560000, "num_steps_sampled": 196000, "sample_time_ms": 10.837, "replay_time_ms": 3.931, "grad_time_ms": 5.436, "update_time_ms": 5.21, "opt_peak_throughput": 5886.742, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -96.84144592285156, "min_q": -172.67002868652344, "max_q": -66.52584075927734, "mean_td_error": 3.2051613330841064}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 196000, "episodes_total": 195, "training_iteration": 196, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-58-12", "timestamp": 1565081892, "time_this_iter_s": 6.8032567501068115, "time_total_s": 1481.3180367946625, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1481.3180367946625, "timesteps_since_restore": 196000, "iterations_since_restore": 196}
{"episode_reward_max": -788.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1869.09, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7066185155376601, "mean_processing_ms": 0.16867789853057308, "mean_inference_ms": 0.7428481510058853}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 390, "num_steps_trained": 1568000, "num_steps_sampled": 197000, "sample_time_ms": 12.566, "replay_time_ms": 4.592, "grad_time_ms": 6.154, "update_time_ms": 5.526, "opt_peak_throughput": 5200.161, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -94.07559204101562, "min_q": -145.52696228027344, "max_q": -65.57881164550781, "mean_td_error": 8.370922088623047}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 197000, "episodes_total": 196, "training_iteration": 197, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-58-19", "timestamp": 1565081899, "time_this_iter_s": 6.722874402999878, "time_total_s": 1488.0409111976624, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1488.0409111976624, "timesteps_since_restore": 197000, "iterations_since_restore": 197}
{"episode_reward_max": -788.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1865.62, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7064128125504534, "mean_processing_ms": 0.16863587112490794, "mean_inference_ms": 0.7426533435721073}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 392, "num_steps_trained": 1576000, "num_steps_sampled": 198000, "sample_time_ms": 11.972, "replay_time_ms": 4.381, "grad_time_ms": 5.748, "update_time_ms": 5.297, "opt_peak_throughput": 5566.729, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -98.60540771484375, "min_q": -163.6414794921875, "max_q": -65.7116470336914, "mean_td_error": 4.618720054626465}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 198000, "episodes_total": 197, "training_iteration": 198, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-58-26", "timestamp": 1565081906, "time_this_iter_s": 6.74428391456604, "time_total_s": 1494.7851951122284, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1494.7851951122284, "timesteps_since_restore": 198000, "iterations_since_restore": 198}
{"episode_reward_max": -788.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1865.64, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.706206184969729, "mean_processing_ms": 0.16859362786340276, "mean_inference_ms": 0.7424601080512554}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 394, "num_steps_trained": 1584000, "num_steps_sampled": 199000, "sample_time_ms": 13.171, "replay_time_ms": 4.679, "grad_time_ms": 6.753, "update_time_ms": 6.488, "opt_peak_throughput": 4738.373, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -97.482666015625, "min_q": -225.8321990966797, "max_q": -66.0533676147461, "mean_td_error": 4.354338645935059}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 199000, "episodes_total": 198, "training_iteration": 199, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-58-34", "timestamp": 1565081914, "time_this_iter_s": 7.940968036651611, "time_total_s": 1502.72616314888, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1502.72616314888, "timesteps_since_restore": 199000, "iterations_since_restore": 199}
{"episode_reward_max": -788.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1820.67, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7060045962011913, "mean_processing_ms": 0.16855291597315475, "mean_inference_ms": 0.7422740659082223}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 396, "num_steps_trained": 1592000, "num_steps_sampled": 200000, "sample_time_ms": 12.918, "replay_time_ms": 4.877, "grad_time_ms": 7.005, "update_time_ms": 6.467, "opt_peak_throughput": 4568.477, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -103.66490173339844, "min_q": -178.7818603515625, "max_q": -66.13021850585938, "mean_td_error": 2.068481683731079}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 200000, "episodes_total": 199, "training_iteration": 200, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-58-41", "timestamp": 1565081921, "time_this_iter_s": 7.19187068939209, "time_total_s": 1509.918033838272, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1509.918033838272, "timesteps_since_restore": 200000, "iterations_since_restore": 200}
{"episode_reward_max": -788.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1820.26, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7058131481662064, "mean_processing_ms": 0.16851462446234905, "mean_inference_ms": 0.7420988261832271}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 398, "num_steps_trained": 1600000, "num_steps_sampled": 201000, "sample_time_ms": 12.322, "replay_time_ms": 4.245, "grad_time_ms": 5.822, "update_time_ms": 5.759, "opt_peak_throughput": 5496.514, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -94.21748352050781, "min_q": -151.66517639160156, "max_q": -66.1340560913086, "mean_td_error": 0.06565070152282715}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 201000, "episodes_total": 200, "training_iteration": 201, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-58-48", "timestamp": 1565081928, "time_this_iter_s": 7.249135494232178, "time_total_s": 1517.1671693325043, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1517.1671693325043, "timesteps_since_restore": 201000, "iterations_since_restore": 201}
{"episode_reward_max": -788.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1819.05, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7056310941822121, "mean_processing_ms": 0.16847883800304353, "mean_inference_ms": 0.7419336641938814}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 400, "num_steps_trained": 1608000, "num_steps_sampled": 202000, "sample_time_ms": 11.561, "replay_time_ms": 4.101, "grad_time_ms": 5.854, "update_time_ms": 5.414, "opt_peak_throughput": 5465.982, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -100.36235046386719, "min_q": -154.87191772460938, "max_q": -65.85653686523438, "mean_td_error": -1.5559155941009521}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 202000, "episodes_total": 201, "training_iteration": 202, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-58-56", "timestamp": 1565081936, "time_this_iter_s": 7.197416305541992, "time_total_s": 1524.3645856380463, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1524.3645856380463, "timesteps_since_restore": 202000, "iterations_since_restore": 202}
{"episode_reward_max": -788.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1812.2, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.705463832261444, "mean_processing_ms": 0.16844639055031185, "mean_inference_ms": 0.741783101237134}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 402, "num_steps_trained": 1616000, "num_steps_sampled": 203000, "sample_time_ms": 18.444, "replay_time_ms": 6.152, "grad_time_ms": 8.184, "update_time_ms": 7.542, "opt_peak_throughput": 3910.044, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -98.13047790527344, "min_q": -145.4842529296875, "max_q": -67.7231216430664, "mean_td_error": -0.46080636978149414}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 203000, "episodes_total": 202, "training_iteration": 203, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-04", "timestamp": 1565081944, "time_this_iter_s": 8.361194372177124, "time_total_s": 1532.7257800102234, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1532.7257800102234, "timesteps_since_restore": 203000, "iterations_since_restore": 203}
{"episode_reward_max": -788.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1809.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7052973047084994, "mean_processing_ms": 0.16841453838911907, "mean_inference_ms": 0.741635170941811}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 404, "num_steps_trained": 1624000, "num_steps_sampled": 204000, "sample_time_ms": 12.805, "replay_time_ms": 4.719, "grad_time_ms": 6.414, "update_time_ms": 5.891, "opt_peak_throughput": 4988.895, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -103.65127563476562, "min_q": -187.35755920410156, "max_q": -66.04429626464844, "mean_td_error": 2.882107734680176}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 204000, "episodes_total": 203, "training_iteration": 204, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-12", "timestamp": 1565081952, "time_this_iter_s": 8.240464687347412, "time_total_s": 1540.9662446975708, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1540.9662446975708, "timesteps_since_restore": 204000, "iterations_since_restore": 204}
{"episode_reward_max": -637.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1801.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7051308380324393, "mean_processing_ms": 0.16838289813568083, "mean_inference_ms": 0.7414878482161444}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 406, "num_steps_trained": 1632000, "num_steps_sampled": 205000, "sample_time_ms": 10.445, "replay_time_ms": 3.793, "grad_time_ms": 5.127, "update_time_ms": 4.975, "opt_peak_throughput": 6241.727, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -91.93716430664062, "min_q": -142.531982421875, "max_q": -65.588623046875, "mean_td_error": 3.146688222885132}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 205000, "episodes_total": 204, "training_iteration": 205, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-19", "timestamp": 1565081959, "time_this_iter_s": 6.785731077194214, "time_total_s": 1547.751975774765, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1547.751975774765, "timesteps_since_restore": 205000, "iterations_since_restore": 205}
{"episode_reward_max": -637.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1792.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7049661921431736, "mean_processing_ms": 0.16835159494283855, "mean_inference_ms": 0.7413418495890337}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 408, "num_steps_trained": 1640000, "num_steps_sampled": 206000, "sample_time_ms": 10.512, "replay_time_ms": 3.551, "grad_time_ms": 5.425, "update_time_ms": 5.041, "opt_peak_throughput": 5898.954, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.61897277832031, "min_q": -130.01278686523438, "max_q": -65.15718841552734, "mean_td_error": 0.6065409183502197}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 206000, "episodes_total": 205, "training_iteration": 206, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-26", "timestamp": 1565081966, "time_this_iter_s": 6.820437431335449, "time_total_s": 1554.5724132061005, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1554.5724132061005, "timesteps_since_restore": 206000, "iterations_since_restore": 206}
{"episode_reward_max": -637.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1785.29, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7047822167256189, "mean_processing_ms": 0.16831588792321667, "mean_inference_ms": 0.7411709388465195}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 410, "num_steps_trained": 1648000, "num_steps_sampled": 207000, "sample_time_ms": 10.402, "replay_time_ms": 3.809, "grad_time_ms": 5.391, "update_time_ms": 4.971, "opt_peak_throughput": 5935.686, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -93.59019470214844, "min_q": -144.2794952392578, "max_q": -64.60084533691406, "mean_td_error": 2.369744300842285}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 207000, "episodes_total": 206, "training_iteration": 207, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-33", "timestamp": 1565081973, "time_this_iter_s": 6.761949777603149, "time_total_s": 1561.3343629837036, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1561.3343629837036, "timesteps_since_restore": 207000, "iterations_since_restore": 207}
{"episode_reward_max": -637.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1777.14, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7046017794246056, "mean_processing_ms": 0.1682807895919634, "mean_inference_ms": 0.7410012824961951}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 412, "num_steps_trained": 1656000, "num_steps_sampled": 208000, "sample_time_ms": 11.944, "replay_time_ms": 4.206, "grad_time_ms": 5.685, "update_time_ms": 5.881, "opt_peak_throughput": 5628.38, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -96.45411682128906, "min_q": -204.6396484375, "max_q": -65.52223205566406, "mean_td_error": -0.08419394493103027}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 208000, "episodes_total": 207, "training_iteration": 208, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-39", "timestamp": 1565081979, "time_this_iter_s": 6.675827503204346, "time_total_s": 1568.010190486908, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1568.010190486908, "timesteps_since_restore": 208000, "iterations_since_restore": 208}
{"episode_reward_max": -637.0, "episode_reward_min": -14326.0, "episode_reward_mean": -1774.18, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7044145406738831, "mean_processing_ms": 0.16824508952060666, "mean_inference_ms": 0.7408297570293807}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 414, "num_steps_trained": 1664000, "num_steps_sampled": 209000, "sample_time_ms": 11.877, "replay_time_ms": 4.441, "grad_time_ms": 5.966, "update_time_ms": 5.635, "opt_peak_throughput": 5363.517, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -97.9896240234375, "min_q": -173.06341552734375, "max_q": -64.95323944091797, "mean_td_error": 5.450969696044922}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 209000, "episodes_total": 208, "training_iteration": 209, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-46", "timestamp": 1565081986, "time_this_iter_s": 6.583940029144287, "time_total_s": 1574.5941305160522, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1574.5941305160522, "timesteps_since_restore": 209000, "iterations_since_restore": 209}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1646.72, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7042258807774754, "mean_processing_ms": 0.16820938932742316, "mean_inference_ms": 0.7406569876695207}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 416, "num_steps_trained": 1672000, "num_steps_sampled": 210000, "sample_time_ms": 12.499, "replay_time_ms": 4.151, "grad_time_ms": 5.627, "update_time_ms": 5.485, "opt_peak_throughput": 5687.12, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -104.78746032714844, "min_q": -299.0930480957031, "max_q": -66.05388641357422, "mean_td_error": -5.813431739807129}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 210000, "episodes_total": 209, "training_iteration": 210, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-52", "timestamp": 1565081992, "time_this_iter_s": 6.56958532333374, "time_total_s": 1581.163715839386, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1581.163715839386, "timesteps_since_restore": 210000, "iterations_since_restore": 210}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1640.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7040402033884335, "mean_processing_ms": 0.1681739407117513, "mean_inference_ms": 0.7404849627726943}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 418, "num_steps_trained": 1680000, "num_steps_sampled": 211000, "sample_time_ms": 10.876, "replay_time_ms": 4.162, "grad_time_ms": 5.816, "update_time_ms": 5.345, "opt_peak_throughput": 5501.606, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -90.5448989868164, "min_q": -151.11965942382812, "max_q": -64.26099395751953, "mean_td_error": 1.0221607685089111}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 211000, "episodes_total": 210, "training_iteration": 211, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_16-59-59", "timestamp": 1565081999, "time_this_iter_s": 6.726265907287598, "time_total_s": 1587.8899817466736, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1587.8899817466736, "timesteps_since_restore": 211000, "iterations_since_restore": 211}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1637.79, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7038491480291594, "mean_processing_ms": 0.16813662481656913, "mean_inference_ms": 0.7403029464899744}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 420, "num_steps_trained": 1688000, "num_steps_sampled": 212000, "sample_time_ms": 10.81, "replay_time_ms": 3.948, "grad_time_ms": 5.396, "update_time_ms": 4.947, "opt_peak_throughput": 5930.493, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -95.10580444335938, "min_q": -168.46240234375, "max_q": -63.288177490234375, "mean_td_error": 3.906442642211914}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 212000, "episodes_total": 211, "training_iteration": 212, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-00-06", "timestamp": 1565082006, "time_this_iter_s": 6.78176474571228, "time_total_s": 1594.6717464923859, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1594.6717464923859, "timesteps_since_restore": 212000, "iterations_since_restore": 212}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1639.54, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7036491929514596, "mean_processing_ms": 0.16809662406424333, "mean_inference_ms": 0.7401095709209787}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 422, "num_steps_trained": 1696000, "num_steps_sampled": 213000, "sample_time_ms": 14.284, "replay_time_ms": 6.215, "grad_time_ms": 7.584, "update_time_ms": 6.973, "opt_peak_throughput": 4219.675, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -93.00347137451172, "min_q": -384.4604797363281, "max_q": -62.02050018310547, "mean_td_error": -0.6013767719268799}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 213000, "episodes_total": 212, "training_iteration": 213, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-00-13", "timestamp": 1565082013, "time_this_iter_s": 7.187723398208618, "time_total_s": 1601.8594698905945, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1601.8594698905945, "timesteps_since_restore": 213000, "iterations_since_restore": 213}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1629.53, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7034571208491617, "mean_processing_ms": 0.16805840455090848, "mean_inference_ms": 0.7399206335552574}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 424, "num_steps_trained": 1704000, "num_steps_sampled": 214000, "sample_time_ms": 11.838, "replay_time_ms": 4.609, "grad_time_ms": 5.647, "update_time_ms": 5.7, "opt_peak_throughput": 5667.045, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -88.04273223876953, "min_q": -149.16859436035156, "max_q": -62.31925964355469, "mean_td_error": -1.4248771667480469}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 214000, "episodes_total": 213, "training_iteration": 214, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-00-21", "timestamp": 1565082021, "time_this_iter_s": 8.051480770111084, "time_total_s": 1609.9109506607056, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1609.9109506607056, "timesteps_since_restore": 214000, "iterations_since_restore": 214}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1626.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7032704649368963, "mean_processing_ms": 0.16802137445605353, "mean_inference_ms": 0.7397359029147538}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 426, "num_steps_trained": 1712000, "num_steps_sampled": 215000, "sample_time_ms": 11.714, "replay_time_ms": 3.968, "grad_time_ms": 6.146, "update_time_ms": 6.165, "opt_peak_throughput": 5206.516, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -80.75761413574219, "min_q": -128.16387939453125, "max_q": -63.29557800292969, "mean_td_error": 1.1748217344284058}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 215000, "episodes_total": 214, "training_iteration": 215, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-00-29", "timestamp": 1565082029, "time_this_iter_s": 7.668330430984497, "time_total_s": 1617.57928109169, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1617.57928109169, "timesteps_since_restore": 215000, "iterations_since_restore": 215}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1618.65, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7030766816531431, "mean_processing_ms": 0.16798276565133816, "mean_inference_ms": 0.7395447639325471}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 428, "num_steps_trained": 1720000, "num_steps_sampled": 216000, "sample_time_ms": 12.174, "replay_time_ms": 3.615, "grad_time_ms": 5.303, "update_time_ms": 4.974, "opt_peak_throughput": 6034.319, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -96.50516510009766, "min_q": -200.4972686767578, "max_q": -61.82769775390625, "mean_td_error": -4.5276899337768555}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 216000, "episodes_total": 215, "training_iteration": 216, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-00-36", "timestamp": 1565082036, "time_this_iter_s": 6.834035158157349, "time_total_s": 1624.4133162498474, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1624.4133162498474, "timesteps_since_restore": 216000, "iterations_since_restore": 216}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1616.58, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7028846012084295, "mean_processing_ms": 0.16794431850652855, "mean_inference_ms": 0.7393541051884882}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 430, "num_steps_trained": 1728000, "num_steps_sampled": 217000, "sample_time_ms": 15.217, "replay_time_ms": 5.411, "grad_time_ms": 7.065, "update_time_ms": 6.829, "opt_peak_throughput": 4529.333, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -86.94552612304688, "min_q": -145.63380432128906, "max_q": -61.65275955200195, "mean_td_error": 1.0819740295410156}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 217000, "episodes_total": 216, "training_iteration": 217, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-00-44", "timestamp": 1565082044, "time_this_iter_s": 7.98895001411438, "time_total_s": 1632.4022662639618, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1632.4022662639618, "timesteps_since_restore": 217000, "iterations_since_restore": 217}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1608.26, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.702681759703161, "mean_processing_ms": 0.16790340524492517, "mean_inference_ms": 0.7391537292903826}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 432, "num_steps_trained": 1736000, "num_steps_sampled": 218000, "sample_time_ms": 15.089, "replay_time_ms": 5.169, "grad_time_ms": 6.944, "update_time_ms": 6.82, "opt_peak_throughput": 4608.445, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -89.28024291992188, "min_q": -154.31036376953125, "max_q": -61.305198669433594, "mean_td_error": 2.9791650772094727}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 218000, "episodes_total": 217, "training_iteration": 218, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-00-52", "timestamp": 1565082052, "time_this_iter_s": 8.248399496078491, "time_total_s": 1640.6506657600403, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1640.6506657600403, "timesteps_since_restore": 218000, "iterations_since_restore": 218}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1598.53, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.702473511223398, "mean_processing_ms": 0.16786070121890748, "mean_inference_ms": 0.7389451072815014}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 434, "num_steps_trained": 1744000, "num_steps_sampled": 219000, "sample_time_ms": 12.378, "replay_time_ms": 4.508, "grad_time_ms": 5.865, "update_time_ms": 5.464, "opt_peak_throughput": 5456.56, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -89.63636779785156, "min_q": -176.9782257080078, "max_q": -59.315025329589844, "mean_td_error": 3.5960516929626465}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 219000, "episodes_total": 218, "training_iteration": 219, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-00-59", "timestamp": 1565082059, "time_this_iter_s": 7.2572948932647705, "time_total_s": 1647.907960653305, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1647.907960653305, "timesteps_since_restore": 219000, "iterations_since_restore": 219}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1596.42, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7022643978970389, "mean_processing_ms": 0.16781745233310733, "mean_inference_ms": 0.7387324304097285}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 436, "num_steps_trained": 1752000, "num_steps_sampled": 220000, "sample_time_ms": 12.585, "replay_time_ms": 4.506, "grad_time_ms": 5.826, "update_time_ms": 5.908, "opt_peak_throughput": 5492.87, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -91.78570556640625, "min_q": -152.5384063720703, "max_q": -59.063697814941406, "mean_td_error": 1.2651681900024414}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 220000, "episodes_total": 219, "training_iteration": 220, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-01-07", "timestamp": 1565082067, "time_this_iter_s": 7.301499128341675, "time_total_s": 1655.2094597816467, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1655.2094597816467, "timesteps_since_restore": 220000, "iterations_since_restore": 220}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1592.85, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.702054025235165, "mean_processing_ms": 0.16777351540514196, "mean_inference_ms": 0.7385160868602715}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 438, "num_steps_trained": 1760000, "num_steps_sampled": 221000, "sample_time_ms": 12.559, "replay_time_ms": 4.248, "grad_time_ms": 5.906, "update_time_ms": 5.72, "opt_peak_throughput": 5417.991, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -111.50196838378906, "min_q": -539.8055419921875, "max_q": -58.74957275390625, "mean_td_error": -4.001646041870117}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 221000, "episodes_total": 220, "training_iteration": 221, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-01-14", "timestamp": 1565082074, "time_this_iter_s": 7.3688342571258545, "time_total_s": 1662.5782940387726, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1662.5782940387726, "timesteps_since_restore": 221000, "iterations_since_restore": 221}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1583.48, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.701839115732894, "mean_processing_ms": 0.1677283950881051, "mean_inference_ms": 0.7382942132493412}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 440, "num_steps_trained": 1768000, "num_steps_sampled": 222000, "sample_time_ms": 11.794, "replay_time_ms": 4.47, "grad_time_ms": 5.807, "update_time_ms": 5.729, "opt_peak_throughput": 5510.324, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -85.76085662841797, "min_q": -135.9783477783203, "max_q": -58.2767333984375, "mean_td_error": -2.745549201965332}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 222000, "episodes_total": 221, "training_iteration": 222, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-01-21", "timestamp": 1565082081, "time_this_iter_s": 6.645253658294678, "time_total_s": 1669.2235476970673, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1669.2235476970673, "timesteps_since_restore": 222000, "iterations_since_restore": 222}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1580.15, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7016192359612117, "mean_processing_ms": 0.16768183283335086, "mean_inference_ms": 0.73806620662363}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 442, "num_steps_trained": 1776000, "num_steps_sampled": 223000, "sample_time_ms": 11.038, "replay_time_ms": 3.744, "grad_time_ms": 5.464, "update_time_ms": 5.253, "opt_peak_throughput": 5856.663, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -83.80328369140625, "min_q": -149.4036102294922, "max_q": -58.6192512512207, "mean_td_error": 3.7812604904174805}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 223000, "episodes_total": 222, "training_iteration": 223, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-01-27", "timestamp": 1565082087, "time_this_iter_s": 6.734383583068848, "time_total_s": 1675.957931280136, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1675.957931280136, "timesteps_since_restore": 223000, "iterations_since_restore": 223}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1565.72, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7013962716299385, "mean_processing_ms": 0.1676342013734974, "mean_inference_ms": 0.7378320441526305}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 444, "num_steps_trained": 1784000, "num_steps_sampled": 224000, "sample_time_ms": 11.074, "replay_time_ms": 3.502, "grad_time_ms": 5.354, "update_time_ms": 4.983, "opt_peak_throughput": 5977.054, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -82.96856689453125, "min_q": -158.26722717285156, "max_q": -58.65676498413086, "mean_td_error": -2.012847900390625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 224000, "episodes_total": 223, "training_iteration": 224, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-01-34", "timestamp": 1565082094, "time_this_iter_s": 6.684078931808472, "time_total_s": 1682.6420102119446, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1682.6420102119446, "timesteps_since_restore": 224000, "iterations_since_restore": 224}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1557.18, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7011603804976185, "mean_processing_ms": 0.16758294817748604, "mean_inference_ms": 0.7375808683008717}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 446, "num_steps_trained": 1792000, "num_steps_sampled": 225000, "sample_time_ms": 14.575, "replay_time_ms": 5.651, "grad_time_ms": 7.325, "update_time_ms": 6.937, "opt_peak_throughput": 4368.313, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -88.62789916992188, "min_q": -149.06289672851562, "max_q": -58.071346282958984, "mean_td_error": -1.3589712381362915}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 225000, "episodes_total": 224, "training_iteration": 225, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-01-41", "timestamp": 1565082101, "time_this_iter_s": 6.845867872238159, "time_total_s": 1689.4878780841827, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1689.4878780841827, "timesteps_since_restore": 225000, "iterations_since_restore": 225}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1557.43, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7009134397091052, "mean_processing_ms": 0.16752868332947066, "mean_inference_ms": 0.737316017247234}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 448, "num_steps_trained": 1800000, "num_steps_sampled": 226000, "sample_time_ms": 11.319, "replay_time_ms": 4.133, "grad_time_ms": 5.88, "update_time_ms": 5.39, "opt_peak_throughput": 5442.046, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.75613403320312, "min_q": -129.96202087402344, "max_q": -58.007816314697266, "mean_td_error": 3.4225916862487793}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 226000, "episodes_total": 225, "training_iteration": 226, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-01-49", "timestamp": 1565082109, "time_this_iter_s": 8.128328084945679, "time_total_s": 1697.6162061691284, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1697.6162061691284, "timesteps_since_restore": 226000, "iterations_since_restore": 226}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1553.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7006588442368424, "mean_processing_ms": 0.16747251359957066, "mean_inference_ms": 0.7370420990215243}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 450, "num_steps_trained": 1808000, "num_steps_sampled": 227000, "sample_time_ms": 10.589, "replay_time_ms": 3.614, "grad_time_ms": 5.344, "update_time_ms": 4.948, "opt_peak_throughput": 5988.387, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -77.32389831542969, "min_q": -116.02506256103516, "max_q": -59.29616928100586, "mean_td_error": 3.1042425632476807}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 227000, "episodes_total": 226, "training_iteration": 227, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-01-56", "timestamp": 1565082116, "time_this_iter_s": 6.661287546157837, "time_total_s": 1704.2774937152863, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1704.2774937152863, "timesteps_since_restore": 227000, "iterations_since_restore": 227}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1539.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7004079850882864, "mean_processing_ms": 0.16741722444585883, "mean_inference_ms": 0.7367706406157069}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 452, "num_steps_trained": 1816000, "num_steps_sampled": 228000, "sample_time_ms": 11.155, "replay_time_ms": 4.022, "grad_time_ms": 5.333, "update_time_ms": 5.228, "opt_peak_throughput": 5999.952, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -82.5513916015625, "min_q": -140.94883728027344, "max_q": -59.43284225463867, "mean_td_error": 5.324370861053467}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 228000, "episodes_total": 227, "training_iteration": 228, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-02", "timestamp": 1565082122, "time_this_iter_s": 6.775943279266357, "time_total_s": 1711.0534369945526, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1711.0534369945526, "timesteps_since_restore": 228000, "iterations_since_restore": 228}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1523.81, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.7001603987873409, "mean_processing_ms": 0.16736270779483886, "mean_inference_ms": 0.7365027009086117}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 454, "num_steps_trained": 1824000, "num_steps_sampled": 229000, "sample_time_ms": 10.882, "replay_time_ms": 3.919, "grad_time_ms": 5.25, "update_time_ms": 4.95, "opt_peak_throughput": 6095.099, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -83.51211547851562, "min_q": -146.8782501220703, "max_q": -59.53203582763672, "mean_td_error": 1.3067659139633179}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 229000, "episodes_total": 228, "training_iteration": 229, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-09", "timestamp": 1565082129, "time_this_iter_s": 6.7158191204071045, "time_total_s": 1717.7692561149597, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1717.7692561149597, "timesteps_since_restore": 229000, "iterations_since_restore": 229}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1515.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6999121202814383, "mean_processing_ms": 0.16730804988873504, "mean_inference_ms": 0.7362354519713423}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 456, "num_steps_trained": 1832000, "num_steps_sampled": 230000, "sample_time_ms": 11.474, "replay_time_ms": 4.354, "grad_time_ms": 6.398, "update_time_ms": 6.221, "opt_peak_throughput": 5001.536, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -83.49069213867188, "min_q": -153.08316040039062, "max_q": -59.56562805175781, "mean_td_error": 0.9070084095001221}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 230000, "episodes_total": 229, "training_iteration": 230, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-16", "timestamp": 1565082136, "time_this_iter_s": 6.72224235534668, "time_total_s": 1724.4914984703064, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1724.4914984703064, "timesteps_since_restore": 230000, "iterations_since_restore": 230}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1508.41, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6996645432647433, "mean_processing_ms": 0.1672533636770545, "mean_inference_ms": 0.7359698614711554}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 458, "num_steps_trained": 1840000, "num_steps_sampled": 231000, "sample_time_ms": 13.108, "replay_time_ms": 4.408, "grad_time_ms": 6.131, "update_time_ms": 5.965, "opt_peak_throughput": 5219.068, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -81.84477233886719, "min_q": -141.67745971679688, "max_q": -59.26632308959961, "mean_td_error": 5.216719627380371}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 231000, "episodes_total": 230, "training_iteration": 231, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-24", "timestamp": 1565082144, "time_this_iter_s": 8.130153894424438, "time_total_s": 1732.6216523647308, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1732.6216523647308, "timesteps_since_restore": 231000, "iterations_since_restore": 231}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1508.71, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6994174324919135, "mean_processing_ms": 0.16719872305661884, "mean_inference_ms": 0.7357054334474167}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 460, "num_steps_trained": 1848000, "num_steps_sampled": 232000, "sample_time_ms": 11.658, "replay_time_ms": 4.008, "grad_time_ms": 5.69, "update_time_ms": 5.181, "opt_peak_throughput": 5623.805, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -79.2284927368164, "min_q": -130.45864868164062, "max_q": -59.15530014038086, "mean_td_error": 2.9191102981567383}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 232000, "episodes_total": 231, "training_iteration": 232, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-31", "timestamp": 1565082151, "time_this_iter_s": 6.82980489730835, "time_total_s": 1739.4514572620392, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1739.4514572620392, "timesteps_since_restore": 232000, "iterations_since_restore": 232}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1504.71, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6991752743794253, "mean_processing_ms": 0.167145197239191, "mean_inference_ms": 0.735445331897154}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 462, "num_steps_trained": 1856000, "num_steps_sampled": 233000, "sample_time_ms": 11.142, "replay_time_ms": 3.945, "grad_time_ms": 5.244, "update_time_ms": 5.458, "opt_peak_throughput": 6102.637, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -86.41047668457031, "min_q": -150.28582763671875, "max_q": -58.929039001464844, "mean_td_error": -7.324606418609619}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 233000, "episodes_total": 232, "training_iteration": 233, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-38", "timestamp": 1565082158, "time_this_iter_s": 6.742374658584595, "time_total_s": 1746.1938319206238, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1746.1938319206238, "timesteps_since_restore": 233000, "iterations_since_restore": 233}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1497.31, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6989302486449307, "mean_processing_ms": 0.16709120989641793, "mean_inference_ms": 0.7351839694148101}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 464, "num_steps_trained": 1864000, "num_steps_sampled": 234000, "sample_time_ms": 11.723, "replay_time_ms": 4.244, "grad_time_ms": 5.62, "update_time_ms": 5.332, "opt_peak_throughput": 5694.237, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.20905303955078, "min_q": -123.10693359375, "max_q": -59.26691436767578, "mean_td_error": 1.3800904750823975}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 234000, "episodes_total": 233, "training_iteration": 234, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-44", "timestamp": 1565082164, "time_this_iter_s": 6.722645044326782, "time_total_s": 1752.9164769649506, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1752.9164769649506, "timesteps_since_restore": 234000, "iterations_since_restore": 234}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1494.32, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6986821060710682, "mean_processing_ms": 0.16703660855489882, "mean_inference_ms": 0.7349208430104806}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 466, "num_steps_trained": 1872000, "num_steps_sampled": 235000, "sample_time_ms": 12.439, "replay_time_ms": 4.166, "grad_time_ms": 5.876, "update_time_ms": 6.071, "opt_peak_throughput": 5445.468, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -82.81048583984375, "min_q": -148.99571228027344, "max_q": -59.30070877075195, "mean_td_error": -3.544689893722534}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 235000, "episodes_total": 234, "training_iteration": 235, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-51", "timestamp": 1565082171, "time_this_iter_s": 6.626631259918213, "time_total_s": 1759.5431082248688, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1759.5431082248688, "timesteps_since_restore": 235000, "iterations_since_restore": 235}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1486.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6984378200584698, "mean_processing_ms": 0.16698299882119486, "mean_inference_ms": 0.7346617258760656}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 468, "num_steps_trained": 1880000, "num_steps_sampled": 236000, "sample_time_ms": 14.478, "replay_time_ms": 4.328, "grad_time_ms": 6.065, "update_time_ms": 6.058, "opt_peak_throughput": 5276.02, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -82.07316589355469, "min_q": -149.13150024414062, "max_q": -59.27476501464844, "mean_td_error": 1.156749963760376}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 236000, "episodes_total": 235, "training_iteration": 236, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-02-58", "timestamp": 1565082178, "time_this_iter_s": 6.695162773132324, "time_total_s": 1766.238270998001, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1766.238270998001, "timesteps_since_restore": 236000, "iterations_since_restore": 236}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1484.42, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6981855128941551, "mean_processing_ms": 0.1669278365174133, "mean_inference_ms": 0.7343970812229463}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 470, "num_steps_trained": 1888000, "num_steps_sampled": 237000, "sample_time_ms": 11.699, "replay_time_ms": 3.552, "grad_time_ms": 5.309, "update_time_ms": 5.278, "opt_peak_throughput": 6027.598, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -81.66822052001953, "min_q": -139.87600708007812, "max_q": -59.15828323364258, "mean_td_error": 1.262969732284546}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 237000, "episodes_total": 236, "training_iteration": 237, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-03-04", "timestamp": 1565082184, "time_this_iter_s": 6.690216302871704, "time_total_s": 1772.9284873008728, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1772.9284873008728, "timesteps_since_restore": 237000, "iterations_since_restore": 237}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1469.83, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6979341959268317, "mean_processing_ms": 0.16687291124382259, "mean_inference_ms": 0.7341337021978699}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 472, "num_steps_trained": 1896000, "num_steps_sampled": 238000, "sample_time_ms": 11.317, "replay_time_ms": 3.557, "grad_time_ms": 5.072, "update_time_ms": 4.849, "opt_peak_throughput": 6309.062, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.98530578613281, "min_q": -135.71493530273438, "max_q": -58.597869873046875, "mean_td_error": -4.123523235321045}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 238000, "episodes_total": 237, "training_iteration": 238, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-03-11", "timestamp": 1565082191, "time_this_iter_s": 6.768840074539185, "time_total_s": 1779.697327375412, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1779.697327375412, "timesteps_since_restore": 238000, "iterations_since_restore": 238}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1460.16, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6976892061432642, "mean_processing_ms": 0.16681935467953107, "mean_inference_ms": 0.733876077306835}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 474, "num_steps_trained": 1904000, "num_steps_sampled": 239000, "sample_time_ms": 14.918, "replay_time_ms": 5.885, "grad_time_ms": 7.436, "update_time_ms": 7.453, "opt_peak_throughput": 4303.161, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -89.87788391113281, "min_q": -149.79052734375, "max_q": -59.260345458984375, "mean_td_error": 7.522483825683594}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 239000, "episodes_total": 238, "training_iteration": 239, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-03-18", "timestamp": 1565082198, "time_this_iter_s": 7.317167043685913, "time_total_s": 1787.014494419098, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1787.014494419098, "timesteps_since_restore": 239000, "iterations_since_restore": 239}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1461.03, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.697452133080928, "mean_processing_ms": 0.16676750390717865, "mean_inference_ms": 0.733625989825908}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 476, "num_steps_trained": 1912000, "num_steps_sampled": 240000, "sample_time_ms": 11.489, "replay_time_ms": 3.872, "grad_time_ms": 5.606, "update_time_ms": 5.459, "opt_peak_throughput": 5708.381, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.79730224609375, "min_q": -149.51275634765625, "max_q": -57.87184524536133, "mean_td_error": -0.07289862632751465}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 240000, "episodes_total": 239, "training_iteration": 240, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-03-26", "timestamp": 1565082206, "time_this_iter_s": 7.749160289764404, "time_total_s": 1794.7636547088623, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1794.7636547088623, "timesteps_since_restore": 240000, "iterations_since_restore": 240}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1465.71, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6972190729137072, "mean_processing_ms": 0.16671646494076728, "mean_inference_ms": 0.7333797884634526}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 478, "num_steps_trained": 1920000, "num_steps_sampled": 241000, "sample_time_ms": 12.978, "replay_time_ms": 3.973, "grad_time_ms": 5.775, "update_time_ms": 5.612, "opt_peak_throughput": 5541.493, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.56694030761719, "min_q": -112.83164978027344, "max_q": -57.036705017089844, "mean_td_error": 4.490406036376953}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 241000, "episodes_total": 240, "training_iteration": 241, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-03-33", "timestamp": 1565082213, "time_this_iter_s": 6.660025119781494, "time_total_s": 1801.4236798286438, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1801.4236798286438, "timesteps_since_restore": 241000, "iterations_since_restore": 241}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1463.47, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6969903520848862, "mean_processing_ms": 0.166666376536787, "mean_inference_ms": 0.733137070512515}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 480, "num_steps_trained": 1928000, "num_steps_sampled": 242000, "sample_time_ms": 11.978, "replay_time_ms": 3.734, "grad_time_ms": 5.644, "update_time_ms": 5.147, "opt_peak_throughput": 5669.463, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -75.17578887939453, "min_q": -109.7175064086914, "max_q": -57.04057693481445, "mean_td_error": 1.7425295114517212}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 242000, "episodes_total": 241, "training_iteration": 242, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-03-40", "timestamp": 1565082220, "time_this_iter_s": 6.707814693450928, "time_total_s": 1808.1314945220947, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1808.1314945220947, "timesteps_since_restore": 242000, "iterations_since_restore": 242}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1456.39, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967591608250824, "mean_processing_ms": 0.16661600580663977, "mean_inference_ms": 0.7328924833342821}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 482, "num_steps_trained": 1936000, "num_steps_sampled": 243000, "sample_time_ms": 11.158, "replay_time_ms": 3.587, "grad_time_ms": 5.146, "update_time_ms": 4.693, "opt_peak_throughput": 6218.044, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -85.72383117675781, "min_q": -168.85342407226562, "max_q": -56.77972412109375, "mean_td_error": -0.8038362264633179}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 243000, "episodes_total": 242, "training_iteration": 243, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-03-46", "timestamp": 1565082226, "time_this_iter_s": 6.734735488891602, "time_total_s": 1814.8662300109863, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1814.8662300109863, "timesteps_since_restore": 243000, "iterations_since_restore": 243}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1471.24, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6965280672466114, "mean_processing_ms": 0.16656551204833062, "mean_inference_ms": 0.7326474469325257}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 484, "num_steps_trained": 1944000, "num_steps_sampled": 244000, "sample_time_ms": 15.276, "replay_time_ms": 6.014, "grad_time_ms": 7.958, "update_time_ms": 7.493, "opt_peak_throughput": 4021.204, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -85.00232696533203, "min_q": -147.202880859375, "max_q": -56.40655517578125, "mean_td_error": 1.644312858581543}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 244000, "episodes_total": 243, "training_iteration": 244, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-03-53", "timestamp": 1565082233, "time_this_iter_s": 7.062856912612915, "time_total_s": 1821.9290869235992, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1821.9290869235992, "timesteps_since_restore": 244000, "iterations_since_restore": 244}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1464.4, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6963041630161664, "mean_processing_ms": 0.16651654498489463, "mean_inference_ms": 0.7324073475442975}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 486, "num_steps_trained": 1952000, "num_steps_sampled": 245000, "sample_time_ms": 13.045, "replay_time_ms": 4.166, "grad_time_ms": 5.769, "update_time_ms": 5.459, "opt_peak_throughput": 5546.623, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -80.46481323242188, "min_q": -155.40138244628906, "max_q": -56.32464599609375, "mean_td_error": 2.221693277359009}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 245000, "episodes_total": 244, "training_iteration": 245, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-01", "timestamp": 1565082241, "time_this_iter_s": 7.990648984909058, "time_total_s": 1829.9197359085083, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1829.9197359085083, "timesteps_since_restore": 245000, "iterations_since_restore": 245}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1457.29, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6960816932080516, "mean_processing_ms": 0.16646777048198394, "mean_inference_ms": 0.7321662988391563}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 488, "num_steps_trained": 1960000, "num_steps_sampled": 246000, "sample_time_ms": 10.685, "replay_time_ms": 3.729, "grad_time_ms": 5.407, "update_time_ms": 5.086, "opt_peak_throughput": 5917.837, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -86.1747817993164, "min_q": -126.27603149414062, "max_q": -55.77529525756836, "mean_td_error": -0.9373152256011963}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 246000, "episodes_total": 245, "training_iteration": 246, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-08", "timestamp": 1565082248, "time_this_iter_s": 6.623991012573242, "time_total_s": 1836.5437269210815, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1836.5437269210815, "timesteps_since_restore": 246000, "iterations_since_restore": 246}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1453.54, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958533908624477, "mean_processing_ms": 0.16641772311725486, "mean_inference_ms": 0.7319197864229307}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 490, "num_steps_trained": 1968000, "num_steps_sampled": 247000, "sample_time_ms": 11.121, "replay_time_ms": 4.21, "grad_time_ms": 5.687, "update_time_ms": 4.986, "opt_peak_throughput": 5626.634, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -83.38583374023438, "min_q": -164.7391815185547, "max_q": -56.58554458618164, "mean_td_error": -2.8463516235351562}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 247000, "episodes_total": 246, "training_iteration": 247, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-15", "timestamp": 1565082255, "time_this_iter_s": 6.72424840927124, "time_total_s": 1843.2679753303528, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1843.2679753303528, "timesteps_since_restore": 247000, "iterations_since_restore": 247}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1445.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956198665992147, "mean_processing_ms": 0.16636663217219408, "mean_inference_ms": 0.7316674708773363}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 492, "num_steps_trained": 1976000, "num_steps_sampled": 248000, "sample_time_ms": 10.77, "replay_time_ms": 3.806, "grad_time_ms": 5.443, "update_time_ms": 5.449, "opt_peak_throughput": 5879.213, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.98385620117188, "min_q": -146.92063903808594, "max_q": -57.10612106323242, "mean_td_error": -0.9035422801971436}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 248000, "episodes_total": 247, "training_iteration": 248, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-22", "timestamp": 1565082262, "time_this_iter_s": 6.742037296295166, "time_total_s": 1850.010012626648, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1850.010012626648, "timesteps_since_restore": 248000, "iterations_since_restore": 248}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1429.97, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6953786763369151, "mean_processing_ms": 0.16631417916792957, "mean_inference_ms": 0.7314079205002498}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 494, "num_steps_trained": 1984000, "num_steps_sampled": 249000, "sample_time_ms": 12.169, "replay_time_ms": 4.105, "grad_time_ms": 5.755, "update_time_ms": 5.402, "opt_peak_throughput": 5560.456, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -88.32052612304688, "min_q": -141.04087829589844, "max_q": -57.14506530761719, "mean_td_error": 2.099050998687744}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 249000, "episodes_total": 248, "training_iteration": 249, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-28", "timestamp": 1565082268, "time_this_iter_s": 6.745438814163208, "time_total_s": 1856.7554514408112, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1856.7554514408112, "timesteps_since_restore": 249000, "iterations_since_restore": 249}
{"episode_reward_max": -637.0, "episode_reward_min": -3410.0, "episode_reward_mean": -1429.01, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6951533774112306, "mean_processing_ms": 0.166264069772549, "mean_inference_ms": 0.7311578867778504}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 496, "num_steps_trained": 1992000, "num_steps_sampled": 250000, "sample_time_ms": 14.405, "replay_time_ms": 5.203, "grad_time_ms": 6.348, "update_time_ms": 6.027, "opt_peak_throughput": 5041.098, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -151.08453369140625, "min_q": -680.0685424804688, "max_q": -56.96983337402344, "mean_td_error": 7.3073344230651855}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 250000, "episodes_total": 249, "training_iteration": 250, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-37", "timestamp": 1565082277, "time_this_iter_s": 8.33640432357788, "time_total_s": 1865.091855764389, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1865.091855764389, "timesteps_since_restore": 250000, "iterations_since_restore": 250}
{"episode_reward_max": -637.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1698.36, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6949322899952137, "mean_processing_ms": 0.16621401205544903, "mean_inference_ms": 0.7309068617144677}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 498, "num_steps_trained": 2000000, "num_steps_sampled": 251000, "sample_time_ms": 11.813, "replay_time_ms": 3.508, "grad_time_ms": 5.148, "update_time_ms": 5.103, "opt_peak_throughput": 6215.712, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -109.64342498779297, "min_q": -947.0844116210938, "max_q": -55.804962158203125, "mean_td_error": -1.220648169517517}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 251000, "episodes_total": 250, "training_iteration": 251, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-43", "timestamp": 1565082283, "time_this_iter_s": 6.793522596359253, "time_total_s": 1871.8853783607483, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1871.8853783607483, "timesteps_since_restore": 251000, "iterations_since_restore": 251}
{"episode_reward_max": -637.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1692.81, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6947000386721568, "mean_processing_ms": 0.16616099214142, "mean_inference_ms": 0.7306426636890068}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 500, "num_steps_trained": 2008000, "num_steps_sampled": 252000, "sample_time_ms": 10.801, "replay_time_ms": 3.463, "grad_time_ms": 5.174, "update_time_ms": 4.941, "opt_peak_throughput": 6185.32, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -108.14842224121094, "min_q": -973.4633178710938, "max_q": -57.47332763671875, "mean_td_error": -2.600224494934082}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 252000, "episodes_total": 251, "training_iteration": 252, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-50", "timestamp": 1565082290, "time_this_iter_s": 6.7931671142578125, "time_total_s": 1878.678545475006, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1878.678545475006, "timesteps_since_restore": 252000, "iterations_since_restore": 252}
{"episode_reward_max": -637.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1687.54, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6944700465974681, "mean_processing_ms": 0.16610852958546485, "mean_inference_ms": 0.7303799940288017}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 501, "num_steps_trained": 2016000, "num_steps_sampled": 253000, "sample_time_ms": 10.509, "replay_time_ms": 3.906, "grad_time_ms": 5.195, "update_time_ms": 4.864, "opt_peak_throughput": 6159.602, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -108.25526428222656, "min_q": -989.478759765625, "max_q": -56.50015640258789, "mean_td_error": -1.1118379831314087}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 253000, "episodes_total": 252, "training_iteration": 253, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-04-57", "timestamp": 1565082297, "time_this_iter_s": 6.75182580947876, "time_total_s": 1885.4303712844849, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1885.4303712844849, "timesteps_since_restore": 253000, "iterations_since_restore": 253}
{"episode_reward_max": -637.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1679.52, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.694243361517968, "mean_processing_ms": 0.16605685735836176, "mean_inference_ms": 0.7301214387920306}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 503, "num_steps_trained": 2024000, "num_steps_sampled": 254000, "sample_time_ms": 11.813, "replay_time_ms": 4.785, "grad_time_ms": 6.493, "update_time_ms": 6.098, "opt_peak_throughput": 4928.297, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -87.58186340332031, "min_q": -466.74713134765625, "max_q": -56.54169845581055, "mean_td_error": 1.6682652235031128}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 254000, "episodes_total": 253, "training_iteration": 254, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-05-04", "timestamp": 1565082304, "time_this_iter_s": 6.715445518493652, "time_total_s": 1892.1458168029785, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1892.1458168029785, "timesteps_since_restore": 254000, "iterations_since_restore": 254}
{"episode_reward_max": -637.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1673.49, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6940169497485891, "mean_processing_ms": 0.16600501851500202, "mean_inference_ms": 0.7298617580422853}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 505, "num_steps_trained": 2032000, "num_steps_sampled": 255000, "sample_time_ms": 12.783, "replay_time_ms": 4.181, "grad_time_ms": 5.659, "update_time_ms": 5.229, "opt_peak_throughput": 5654.82, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -83.78790283203125, "min_q": -156.284423828125, "max_q": -55.9413948059082, "mean_td_error": -2.7693071365356445}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 255000, "episodes_total": 254, "training_iteration": 255, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-05-10", "timestamp": 1565082310, "time_this_iter_s": 6.573312759399414, "time_total_s": 1898.719129562378, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1898.719129562378, "timesteps_since_restore": 255000, "iterations_since_restore": 255}
{"episode_reward_max": -637.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1664.71, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6937933793311071, "mean_processing_ms": 0.1659540542509498, "mean_inference_ms": 0.7296054834007315}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 507, "num_steps_trained": 2040000, "num_steps_sampled": 256000, "sample_time_ms": 12.771, "replay_time_ms": 4.408, "grad_time_ms": 6.32, "update_time_ms": 5.816, "opt_peak_throughput": 5063.368, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -77.5157470703125, "min_q": -134.93533325195312, "max_q": -56.61972427368164, "mean_td_error": 0.3103066682815552}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 256000, "episodes_total": 255, "training_iteration": 256, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-05-17", "timestamp": 1565082317, "time_this_iter_s": 6.608281135559082, "time_total_s": 1905.327410697937, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1905.327410697937, "timesteps_since_restore": 256000, "iterations_since_restore": 256}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1653.86, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6935733436328938, "mean_processing_ms": 0.16590404941530892, "mean_inference_ms": 0.7293535958537547}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 509, "num_steps_trained": 2048000, "num_steps_sampled": 257000, "sample_time_ms": 10.78, "replay_time_ms": 4.338, "grad_time_ms": 5.367, "update_time_ms": 5.139, "opt_peak_throughput": 5961.841, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.37589263916016, "min_q": -148.89515686035156, "max_q": -55.995887756347656, "mean_td_error": -1.8227533102035522}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 257000, "episodes_total": 256, "training_iteration": 257, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-05-24", "timestamp": 1565082324, "time_this_iter_s": 6.789815425872803, "time_total_s": 1912.1172261238098, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1912.1172261238098, "timesteps_since_restore": 257000, "iterations_since_restore": 257}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1660.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6933611617902293, "mean_processing_ms": 0.16585581647380543, "mean_inference_ms": 0.7291091744595682}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 511, "num_steps_trained": 2056000, "num_steps_sampled": 258000, "sample_time_ms": 16.334, "replay_time_ms": 5.38, "grad_time_ms": 6.981, "update_time_ms": 6.748, "opt_peak_throughput": 4584.095, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.32462310791016, "min_q": -170.76791381835938, "max_q": -56.163177490234375, "mean_td_error": -3.0479769706726074}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 258000, "episodes_total": 257, "training_iteration": 258, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-05-31", "timestamp": 1565082331, "time_this_iter_s": 7.598549127578735, "time_total_s": 1919.7157752513885, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1919.7157752513885, "timesteps_since_restore": 258000, "iterations_since_restore": 258}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1664.94, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6931555984029671, "mean_processing_ms": 0.16580911307418547, "mean_inference_ms": 0.7288713814292958}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 513, "num_steps_trained": 2064000, "num_steps_sampled": 259000, "sample_time_ms": 13.721, "replay_time_ms": 4.315, "grad_time_ms": 5.667, "update_time_ms": 5.62, "opt_peak_throughput": 5646.352, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -113.20195007324219, "min_q": -957.0693359375, "max_q": -55.845733642578125, "mean_td_error": 4.534280776977539}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 259000, "episodes_total": 258, "training_iteration": 259, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-05-39", "timestamp": 1565082339, "time_this_iter_s": 7.583205699920654, "time_total_s": 1927.2989809513092, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1927.2989809513092, "timesteps_since_restore": 259000, "iterations_since_restore": 259}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1660.31, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6929522706343549, "mean_processing_ms": 0.16576303978102264, "mean_inference_ms": 0.7286366675535693}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 515, "num_steps_trained": 2072000, "num_steps_sampled": 260000, "sample_time_ms": 11.722, "replay_time_ms": 3.981, "grad_time_ms": 5.951, "update_time_ms": 5.711, "opt_peak_throughput": 5377.227, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -110.52052307128906, "min_q": -1208.982421875, "max_q": -55.900672912597656, "mean_td_error": -1.7093299627304077}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 260000, "episodes_total": 259, "training_iteration": 260, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-05-46", "timestamp": 1565082346, "time_this_iter_s": 6.629902601242065, "time_total_s": 1933.9288835525513, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1933.9288835525513, "timesteps_since_restore": 260000, "iterations_since_restore": 260}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1656.56, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6927667575656852, "mean_processing_ms": 0.16572108248058334, "mean_inference_ms": 0.7284252797077112}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 517, "num_steps_trained": 2080000, "num_steps_sampled": 261000, "sample_time_ms": 28.612, "replay_time_ms": 10.427, "grad_time_ms": 10.849, "update_time_ms": 13.417, "opt_peak_throughput": 2949.535, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -132.951416015625, "min_q": -1093.2100830078125, "max_q": -54.99959182739258, "mean_td_error": 5.30714225769043}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 261000, "episodes_total": 260, "training_iteration": 261, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-05-57", "timestamp": 1565082357, "time_this_iter_s": 11.519538164138794, "time_total_s": 1945.44842171669, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1945.44842171669, "timesteps_since_restore": 261000, "iterations_since_restore": 261}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1643.64, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6925843554922041, "mean_processing_ms": 0.16567976781468075, "mean_inference_ms": 0.7282202560559451}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 519, "num_steps_trained": 2088000, "num_steps_sampled": 262000, "sample_time_ms": 12.626, "replay_time_ms": 4.457, "grad_time_ms": 6.098, "update_time_ms": 5.532, "opt_peak_throughput": 5247.923, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.70811462402344, "min_q": -136.43138122558594, "max_q": -54.85011291503906, "mean_td_error": 0.5940181016921997}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 262000, "episodes_total": 261, "training_iteration": 262, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-06-06", "timestamp": 1565082366, "time_this_iter_s": 9.29648470878601, "time_total_s": 1954.744906425476, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1954.744906425476, "timesteps_since_restore": 262000, "iterations_since_restore": 262}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1639.23, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6924010449950784, "mean_processing_ms": 0.1656378608897134, "mean_inference_ms": 0.7280125130053893}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 521, "num_steps_trained": 2096000, "num_steps_sampled": 263000, "sample_time_ms": 11.819, "replay_time_ms": 4.115, "grad_time_ms": 5.797, "update_time_ms": 5.488, "opt_peak_throughput": 5520.092, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -74.7627944946289, "min_q": -113.10897827148438, "max_q": -54.797996520996094, "mean_td_error": 2.82843279838562}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 263000, "episodes_total": 262, "training_iteration": 263, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-06-14", "timestamp": 1565082374, "time_this_iter_s": 7.247344017028809, "time_total_s": 1961.9922504425049, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1961.9922504425049, "timesteps_since_restore": 263000, "iterations_since_restore": 263}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1637.09, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6922177296909864, "mean_processing_ms": 0.16559568716641018, "mean_inference_ms": 0.7278025163663859}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 523, "num_steps_trained": 2104000, "num_steps_sampled": 264000, "sample_time_ms": 10.576, "replay_time_ms": 4.329, "grad_time_ms": 5.492, "update_time_ms": 5.272, "opt_peak_throughput": 5826.282, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -82.92277526855469, "min_q": -143.2204132080078, "max_q": -54.297359466552734, "mean_td_error": 1.82722008228302}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 264000, "episodes_total": 263, "training_iteration": 264, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-06-20", "timestamp": 1565082380, "time_this_iter_s": 6.50715446472168, "time_total_s": 1968.4994049072266, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1968.4994049072266, "timesteps_since_restore": 264000, "iterations_since_restore": 264}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1621.67, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6920291065356672, "mean_processing_ms": 0.16555236595824627, "mean_inference_ms": 0.727588239814922}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 525, "num_steps_trained": 2112000, "num_steps_sampled": 265000, "sample_time_ms": 10.49, "replay_time_ms": 3.63, "grad_time_ms": 5.506, "update_time_ms": 5.015, "opt_peak_throughput": 5811.524, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -132.17733764648438, "min_q": -1057.5843505859375, "max_q": -55.39640426635742, "mean_td_error": 6.443428993225098}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 265000, "episodes_total": 264, "training_iteration": 265, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-06-27", "timestamp": 1565082387, "time_this_iter_s": 6.618068218231201, "time_total_s": 1975.1174731254578, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1975.1174731254578, "timesteps_since_restore": 265000, "iterations_since_restore": 265}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1612.19, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6918370497262362, "mean_processing_ms": 0.1655080946766312, "mean_inference_ms": 0.7273704344438015}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 527, "num_steps_trained": 2120000, "num_steps_sampled": 266000, "sample_time_ms": 10.962, "replay_time_ms": 3.865, "grad_time_ms": 5.42, "update_time_ms": 5.017, "opt_peak_throughput": 5904.456, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -77.28279113769531, "min_q": -142.84487915039062, "max_q": -56.26337432861328, "mean_td_error": 4.013387680053711}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 266000, "episodes_total": 265, "training_iteration": 266, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-06-33", "timestamp": 1565082393, "time_this_iter_s": 6.627768516540527, "time_total_s": 1981.7452416419983, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1981.7452416419983, "timesteps_since_restore": 266000, "iterations_since_restore": 266}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1617.77, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6916334337517651, "mean_processing_ms": 0.1654610079755155, "mean_inference_ms": 0.7271400410515705}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 529, "num_steps_trained": 2128000, "num_steps_sampled": 267000, "sample_time_ms": 11.914, "replay_time_ms": 4.377, "grad_time_ms": 5.702, "update_time_ms": 5.388, "opt_peak_throughput": 5612.212, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -80.2732162475586, "min_q": -149.46090698242188, "max_q": -55.889339447021484, "mean_td_error": -2.2920708656311035}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 267000, "episodes_total": 266, "training_iteration": 267, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-06-40", "timestamp": 1565082400, "time_this_iter_s": 6.548076152801514, "time_total_s": 1988.2933177947998, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1988.2933177947998, "timesteps_since_restore": 267000, "iterations_since_restore": 267}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1617.45, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6914239290525335, "mean_processing_ms": 0.16541245256256612, "mean_inference_ms": 0.726904108444336}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 531, "num_steps_trained": 2136000, "num_steps_sampled": 268000, "sample_time_ms": 12.725, "replay_time_ms": 4.557, "grad_time_ms": 5.541, "update_time_ms": 5.348, "opt_peak_throughput": 5774.867, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -121.17703247070312, "min_q": -1077.0400390625, "max_q": -56.47553253173828, "mean_td_error": -1.5634679794311523}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 268000, "episodes_total": 267, "training_iteration": 268, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-06-46", "timestamp": 1565082406, "time_this_iter_s": 6.544037103652954, "time_total_s": 1994.8373548984528, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1994.8373548984528, "timesteps_since_restore": 268000, "iterations_since_restore": 268}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1613.33, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6912106356389561, "mean_processing_ms": 0.1653628645058258, "mean_inference_ms": 0.7266637056289995}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 533, "num_steps_trained": 2144000, "num_steps_sampled": 269000, "sample_time_ms": 11.368, "replay_time_ms": 4.2, "grad_time_ms": 5.959, "update_time_ms": 5.893, "opt_peak_throughput": 5369.998, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -79.55640411376953, "min_q": -147.29769897460938, "max_q": -57.56814956665039, "mean_td_error": 2.331005573272705}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 269000, "episodes_total": 268, "training_iteration": 269, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-06-53", "timestamp": 1565082413, "time_this_iter_s": 6.470359563827515, "time_total_s": 2001.3077144622803, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2001.3077144622803, "timesteps_since_restore": 269000, "iterations_since_restore": 269}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1611.71, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6909989622634097, "mean_processing_ms": 0.16531359974278448, "mean_inference_ms": 0.7264237382066018}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 535, "num_steps_trained": 2152000, "num_steps_sampled": 270000, "sample_time_ms": 10.844, "replay_time_ms": 3.912, "grad_time_ms": 6.029, "update_time_ms": 5.229, "opt_peak_throughput": 5307.398, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -122.6427001953125, "min_q": -1397.083251953125, "max_q": -56.63774490356445, "mean_td_error": -0.41030657291412354}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 270000, "episodes_total": 269, "training_iteration": 270, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-00", "timestamp": 1565082420, "time_this_iter_s": 6.570807218551636, "time_total_s": 2007.878521680832, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2007.878521680832, "timesteps_since_restore": 270000, "iterations_since_restore": 270}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1629.05, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6907865233766873, "mean_processing_ms": 0.16526382318626062, "mean_inference_ms": 0.7261825837118703}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 537, "num_steps_trained": 2160000, "num_steps_sampled": 271000, "sample_time_ms": 15.721, "replay_time_ms": 5.612, "grad_time_ms": 7.186, "update_time_ms": 6.878, "opt_peak_throughput": 4453.246, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -121.79840087890625, "min_q": -1457.208984375, "max_q": -56.38298034667969, "mean_td_error": 4.308318614959717}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 271000, "episodes_total": 270, "training_iteration": 271, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-07", "timestamp": 1565082427, "time_this_iter_s": 7.2277984619140625, "time_total_s": 2015.106320142746, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2015.106320142746, "timesteps_since_restore": 271000, "iterations_since_restore": 271}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1622.54, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6905742021481287, "mean_processing_ms": 0.1652140273509213, "mean_inference_ms": 0.7259415376852743}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 539, "num_steps_trained": 2168000, "num_steps_sampled": 272000, "sample_time_ms": 11.21, "replay_time_ms": 3.978, "grad_time_ms": 5.873, "update_time_ms": 5.452, "opt_peak_throughput": 5448.585, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -85.03791046142578, "min_q": -144.5970916748047, "max_q": -56.29447555541992, "mean_td_error": 9.215834617614746}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 272000, "episodes_total": 271, "training_iteration": 272, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-14", "timestamp": 1565082434, "time_this_iter_s": 7.560040235519409, "time_total_s": 2022.6663603782654, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2022.6663603782654, "timesteps_since_restore": 272000, "iterations_since_restore": 272}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1616.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6903639838315182, "mean_processing_ms": 0.165164787844332, "mean_inference_ms": 0.7257021903110079}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 541, "num_steps_trained": 2176000, "num_steps_sampled": 273000, "sample_time_ms": 11.38, "replay_time_ms": 4.018, "grad_time_ms": 5.837, "update_time_ms": 5.892, "opt_peak_throughput": 5481.944, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -79.60472869873047, "min_q": -157.33131408691406, "max_q": -56.45297622680664, "mean_td_error": -6.240921974182129}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 273000, "episodes_total": 272, "training_iteration": 273, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-21", "timestamp": 1565082441, "time_this_iter_s": 6.531702518463135, "time_total_s": 2029.1980628967285, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2029.1980628967285, "timesteps_since_restore": 273000, "iterations_since_restore": 273}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1611.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6901559395766541, "mean_processing_ms": 0.16511598276993328, "mean_inference_ms": 0.7254640892946589}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 543, "num_steps_trained": 2184000, "num_steps_sampled": 274000, "sample_time_ms": 11.142, "replay_time_ms": 3.474, "grad_time_ms": 5.096, "update_time_ms": 4.691, "opt_peak_throughput": 6279.28, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -129.94046020507812, "min_q": -1524.765625, "max_q": -56.19913864135742, "mean_td_error": -3.080862045288086}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 274000, "episodes_total": 273, "training_iteration": 274, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-28", "timestamp": 1565082448, "time_this_iter_s": 6.6694886684417725, "time_total_s": 2035.8675515651703, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2035.8675515651703, "timesteps_since_restore": 274000, "iterations_since_restore": 274}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1602.3, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6899496861165832, "mean_processing_ms": 0.16506761102997736, "mean_inference_ms": 0.7252275497428528}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 545, "num_steps_trained": 2192000, "num_steps_sampled": 275000, "sample_time_ms": 11.924, "replay_time_ms": 3.5, "grad_time_ms": 4.994, "update_time_ms": 4.874, "opt_peak_throughput": 6407.461, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -146.01528930664062, "min_q": -1762.793212890625, "max_q": -54.68263626098633, "mean_td_error": 7.744826316833496}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 275000, "episodes_total": 274, "training_iteration": 275, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-34", "timestamp": 1565082454, "time_this_iter_s": 6.582193374633789, "time_total_s": 2042.449744939804, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2042.449744939804, "timesteps_since_restore": 275000, "iterations_since_restore": 275}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1603.16, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6897460057997384, "mean_processing_ms": 0.1650197834238273, "mean_inference_ms": 0.7249928485081832}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 547, "num_steps_trained": 2200000, "num_steps_sampled": 276000, "sample_time_ms": 14.592, "replay_time_ms": 5.719, "grad_time_ms": 7.526, "update_time_ms": 7.037, "opt_peak_throughput": 4252.093, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -139.4994659423828, "min_q": -1297.1441650390625, "max_q": -55.68586730957031, "mean_td_error": 0.8263384103775024}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 276000, "episodes_total": 275, "training_iteration": 276, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-41", "timestamp": 1565082461, "time_this_iter_s": 6.732082366943359, "time_total_s": 2049.1818273067474, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2049.1818273067474, "timesteps_since_restore": 276000, "iterations_since_restore": 276}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1599.57, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.68954690603469, "mean_processing_ms": 0.16497302525347443, "mean_inference_ms": 0.7247620849865808}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 549, "num_steps_trained": 2208000, "num_steps_sampled": 277000, "sample_time_ms": 11.939, "replay_time_ms": 4.054, "grad_time_ms": 5.77, "update_time_ms": 5.571, "opt_peak_throughput": 5545.683, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.31007385253906, "min_q": -132.87486267089844, "max_q": -55.77275848388672, "mean_td_error": 1.9131447076797485}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 277000, "episodes_total": 276, "training_iteration": 277, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-49", "timestamp": 1565082469, "time_this_iter_s": 7.966150999069214, "time_total_s": 2057.1479783058167, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2057.1479783058167, "timesteps_since_restore": 277000, "iterations_since_restore": 277}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1591.0, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6893409624792731, "mean_processing_ms": 0.1649246260417568, "mean_inference_ms": 0.7245256817211175}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 551, "num_steps_trained": 2216000, "num_steps_sampled": 278000, "sample_time_ms": 10.914, "replay_time_ms": 3.872, "grad_time_ms": 5.281, "update_time_ms": 5.261, "opt_peak_throughput": 6059.491, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -76.32743835449219, "min_q": -114.18961334228516, "max_q": -55.887115478515625, "mean_td_error": 1.230327844619751}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 278000, "episodes_total": 277, "training_iteration": 278, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-07-55", "timestamp": 1565082475, "time_this_iter_s": 6.575261116027832, "time_total_s": 2063.7232394218445, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2063.7232394218445, "timesteps_since_restore": 278000, "iterations_since_restore": 278}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1588.69, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6891399032674934, "mean_processing_ms": 0.16487718230645906, "mean_inference_ms": 0.7242930697622703}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 553, "num_steps_trained": 2224000, "num_steps_sampled": 279000, "sample_time_ms": 14.639, "replay_time_ms": 5.746, "grad_time_ms": 6.924, "update_time_ms": 6.795, "opt_peak_throughput": 4621.536, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -160.43202209472656, "min_q": -1411.480224609375, "max_q": -55.710201263427734, "mean_td_error": 4.552386283874512}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 279000, "episodes_total": 278, "training_iteration": 279, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-03", "timestamp": 1565082483, "time_this_iter_s": 7.2121663093566895, "time_total_s": 2070.935405731201, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2070.935405731201, "timesteps_since_restore": 279000, "iterations_since_restore": 279}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1591.41, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.688945142843569, "mean_processing_ms": 0.1648310770608418, "mean_inference_ms": 0.7240661137692905}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 555, "num_steps_trained": 2232000, "num_steps_sampled": 280000, "sample_time_ms": 13.061, "replay_time_ms": 4.178, "grad_time_ms": 5.628, "update_time_ms": 5.678, "opt_peak_throughput": 5685.795, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -142.03717041015625, "min_q": -1482.3876953125, "max_q": -54.83872604370117, "mean_td_error": 3.3141071796417236}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 280000, "episodes_total": 279, "training_iteration": 280, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-10", "timestamp": 1565082490, "time_this_iter_s": 7.596952676773071, "time_total_s": 2078.5323584079742, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2078.5323584079742, "timesteps_since_restore": 280000, "iterations_since_restore": 280}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1589.09, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6887517831673152, "mean_processing_ms": 0.16478529107830717, "mean_inference_ms": 0.7238406182126874}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 557, "num_steps_trained": 2240000, "num_steps_sampled": 281000, "sample_time_ms": 11.674, "replay_time_ms": 3.854, "grad_time_ms": 5.54, "update_time_ms": 4.974, "opt_peak_throughput": 5775.762, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -121.80580139160156, "min_q": -1390.004638671875, "max_q": -54.33878707885742, "mean_td_error": 3.961338520050049}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 281000, "episodes_total": 280, "training_iteration": 281, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-17", "timestamp": 1565082497, "time_this_iter_s": 6.464138031005859, "time_total_s": 2084.99649643898, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2084.99649643898, "timesteps_since_restore": 281000, "iterations_since_restore": 281}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1578.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6885626940716183, "mean_processing_ms": 0.164740600569911, "mean_inference_ms": 0.7236190650039844}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 559, "num_steps_trained": 2248000, "num_steps_sampled": 282000, "sample_time_ms": 14.232, "replay_time_ms": 5.121, "grad_time_ms": 7.068, "update_time_ms": 6.81, "opt_peak_throughput": 4527.744, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -180.35052490234375, "min_q": -1619.52783203125, "max_q": -55.105018615722656, "mean_td_error": -0.20540392398834229}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 282000, "episodes_total": 281, "training_iteration": 282, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-24", "timestamp": 1565082504, "time_this_iter_s": 7.687942743301392, "time_total_s": 2092.6844391822815, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2092.6844391822815, "timesteps_since_restore": 282000, "iterations_since_restore": 282}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1569.04, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6883691625455214, "mean_processing_ms": 0.1646948637699832, "mean_inference_ms": 0.7233938871135408}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 561, "num_steps_trained": 2256000, "num_steps_sampled": 283000, "sample_time_ms": 12.184, "replay_time_ms": 4.015, "grad_time_ms": 5.649, "update_time_ms": 5.447, "opt_peak_throughput": 5664.247, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -96.54582214355469, "min_q": -528.1869506835938, "max_q": -55.23240661621094, "mean_td_error": 1.784755825996399}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 283000, "episodes_total": 282, "training_iteration": 283, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-32", "timestamp": 1565082512, "time_this_iter_s": 7.308489561080933, "time_total_s": 2099.9929287433624, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2099.9929287433624, "timesteps_since_restore": 283000, "iterations_since_restore": 283}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1576.35, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6881796741048434, "mean_processing_ms": 0.16465003947530657, "mean_inference_ms": 0.7231728887046209}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 563, "num_steps_trained": 2264000, "num_steps_sampled": 284000, "sample_time_ms": 11.986, "replay_time_ms": 4.579, "grad_time_ms": 5.71, "update_time_ms": 5.294, "opt_peak_throughput": 5603.753, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -228.10745239257812, "min_q": -1817.5120849609375, "max_q": -53.52041244506836, "mean_td_error": -1.8493462800979614}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 284000, "episodes_total": 283, "training_iteration": 284, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-39", "timestamp": 1565082519, "time_this_iter_s": 7.1834399700164795, "time_total_s": 2107.176368713379, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2107.176368713379, "timesteps_since_restore": 284000, "iterations_since_restore": 284}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1569.84, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6879868341370171, "mean_processing_ms": 0.16460445585219985, "mean_inference_ms": 0.7229487105487695}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 565, "num_steps_trained": 2272000, "num_steps_sampled": 285000, "sample_time_ms": 11.84, "replay_time_ms": 3.847, "grad_time_ms": 5.373, "update_time_ms": 5.333, "opt_peak_throughput": 5955.175, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.80956268310547, "min_q": -130.08290100097656, "max_q": -53.51087188720703, "mean_td_error": -3.480503559112549}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 285000, "episodes_total": 284, "training_iteration": 285, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-45", "timestamp": 1565082525, "time_this_iter_s": 6.477886199951172, "time_total_s": 2113.65425491333, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2113.65425491333, "timesteps_since_restore": 285000, "iterations_since_restore": 285}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1573.41, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6877902692886352, "mean_processing_ms": 0.1645580468067377, "mean_inference_ms": 0.7227207154512866}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 567, "num_steps_trained": 2280000, "num_steps_sampled": 286000, "sample_time_ms": 10.803, "replay_time_ms": 3.855, "grad_time_ms": 5.231, "update_time_ms": 5.093, "opt_peak_throughput": 6116.932, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -103.63983154296875, "min_q": -892.7484130859375, "max_q": -53.535255432128906, "mean_td_error": 6.062595367431641}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 286000, "episodes_total": 285, "training_iteration": 286, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-52", "timestamp": 1565082532, "time_this_iter_s": 6.478380441665649, "time_total_s": 2120.1326353549957, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2120.1326353549957, "timesteps_since_restore": 286000, "iterations_since_restore": 286}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1569.81, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6875947058578079, "mean_processing_ms": 0.1645118962571136, "mean_inference_ms": 0.7224935752184136}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 569, "num_steps_trained": 2288000, "num_steps_sampled": 287000, "sample_time_ms": 10.75, "replay_time_ms": 3.518, "grad_time_ms": 5.0, "update_time_ms": 4.634, "opt_peak_throughput": 6399.487, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.76615905761719, "min_q": -152.97315979003906, "max_q": -54.006465911865234, "mean_td_error": 8.452488899230957}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 287000, "episodes_total": 286, "training_iteration": 287, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-08-59", "timestamp": 1565082539, "time_this_iter_s": 6.601126432418823, "time_total_s": 2126.7337617874146, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2126.7337617874146, "timesteps_since_restore": 287000, "iterations_since_restore": 287}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1570.97, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6874008085726436, "mean_processing_ms": 0.16446605867661584, "mean_inference_ms": 0.7222677961598921}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 571, "num_steps_trained": 2296000, "num_steps_sampled": 288000, "sample_time_ms": 11.591, "replay_time_ms": 3.833, "grad_time_ms": 5.5, "update_time_ms": 5.063, "opt_peak_throughput": 5818.503, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -115.24722290039062, "min_q": -1460.9749755859375, "max_q": -52.00127410888672, "mean_td_error": 2.8149070739746094}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 288000, "episodes_total": 287, "training_iteration": 288, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-09-05", "timestamp": 1565082545, "time_this_iter_s": 6.649479627609253, "time_total_s": 2133.383241415024, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2133.383241415024, "timesteps_since_restore": 288000, "iterations_since_restore": 288}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1566.96, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6872072198705013, "mean_processing_ms": 0.16442030297500274, "mean_inference_ms": 0.7220425100681027}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 573, "num_steps_trained": 2304000, "num_steps_sampled": 289000, "sample_time_ms": 12.326, "replay_time_ms": 4.262, "grad_time_ms": 5.959, "update_time_ms": 5.506, "opt_peak_throughput": 5370.17, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.6327896118164, "min_q": -294.55914306640625, "max_q": -52.00894546508789, "mean_td_error": 3.6871495246887207}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 289000, "episodes_total": 288, "training_iteration": 289, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-09-12", "timestamp": 1565082552, "time_this_iter_s": 6.561967849731445, "time_total_s": 2139.9452092647552, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2139.9452092647552, "timesteps_since_restore": 289000, "iterations_since_restore": 289}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1562.87, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6870149320843899, "mean_processing_ms": 0.16437479225394364, "mean_inference_ms": 0.721818104033189}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 575, "num_steps_trained": 2312000, "num_steps_sampled": 290000, "sample_time_ms": 11.278, "replay_time_ms": 4.379, "grad_time_ms": 5.945, "update_time_ms": 5.702, "opt_peak_throughput": 5382.337, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -88.00386047363281, "min_q": -345.33062744140625, "max_q": -52.17523956298828, "mean_td_error": 5.389159202575684}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 290000, "episodes_total": 289, "training_iteration": 290, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-09-18", "timestamp": 1565082558, "time_this_iter_s": 6.462970972061157, "time_total_s": 2146.4081802368164, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2146.4081802368164, "timesteps_since_restore": 290000, "iterations_since_restore": 290}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1561.56, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6868229155558787, "mean_processing_ms": 0.16432931252785385, "mean_inference_ms": 0.721593974133444}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 577, "num_steps_trained": 2320000, "num_steps_sampled": 291000, "sample_time_ms": 11.267, "replay_time_ms": 3.563, "grad_time_ms": 5.315, "update_time_ms": 5.396, "opt_peak_throughput": 6020.136, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -141.33387756347656, "min_q": -807.1658935546875, "max_q": -52.353939056396484, "mean_td_error": -13.31379508972168}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 291000, "episodes_total": 290, "training_iteration": 291, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-09-25", "timestamp": 1565082565, "time_this_iter_s": 6.439728498458862, "time_total_s": 2152.8479087352753, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2152.8479087352753, "timesteps_since_restore": 291000, "iterations_since_restore": 291}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1558.76, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6866321353312286, "mean_processing_ms": 0.16428405188007583, "mean_inference_ms": 0.7213706463852517}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 579, "num_steps_trained": 2328000, "num_steps_sampled": 292000, "sample_time_ms": 11.663, "replay_time_ms": 3.88, "grad_time_ms": 5.518, "update_time_ms": 5.829, "opt_peak_throughput": 5798.919, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -83.9767074584961, "min_q": -348.7423400878906, "max_q": -50.936031341552734, "mean_td_error": -2.0546278953552246}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 292000, "episodes_total": 291, "training_iteration": 292, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-09-31", "timestamp": 1565082571, "time_this_iter_s": 6.666585922241211, "time_total_s": 2159.5144946575165, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2159.5144946575165, "timesteps_since_restore": 292000, "iterations_since_restore": 292}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1560.9, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6864434068328326, "mean_processing_ms": 0.16423921043127698, "mean_inference_ms": 0.7211507843069875}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 581, "num_steps_trained": 2336000, "num_steps_sampled": 293000, "sample_time_ms": 14.501, "replay_time_ms": 5.46, "grad_time_ms": 7.651, "update_time_ms": 7.148, "opt_peak_throughput": 4182.502, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -294.9195861816406, "min_q": -1637.0618896484375, "max_q": -51.61793899536133, "mean_td_error": -43.37202072143555}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 293000, "episodes_total": 292, "training_iteration": 293, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-09-40", "timestamp": 1565082580, "time_this_iter_s": 8.96047306060791, "time_total_s": 2168.4749677181244, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2168.4749677181244, "timesteps_since_restore": 293000, "iterations_since_restore": 293}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1564.34, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6862592118329341, "mean_processing_ms": 0.16419528552016277, "mean_inference_ms": 0.720934939827988}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 583, "num_steps_trained": 2344000, "num_steps_sampled": 294000, "sample_time_ms": 11.167, "replay_time_ms": 4.438, "grad_time_ms": 5.614, "update_time_ms": 5.423, "opt_peak_throughput": 5699.557, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -133.635009765625, "min_q": -1512.5306396484375, "max_q": -51.092811584472656, "mean_td_error": 3.4919166564941406}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 294000, "episodes_total": 293, "training_iteration": 294, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-09-48", "timestamp": 1565082588, "time_this_iter_s": 7.531159400939941, "time_total_s": 2176.0061271190643, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2176.0061271190643, "timesteps_since_restore": 294000, "iterations_since_restore": 294}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1558.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6860774634355468, "mean_processing_ms": 0.164152121920391, "mean_inference_ms": 0.7207230707520808}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 585, "num_steps_trained": 2352000, "num_steps_sampled": 295000, "sample_time_ms": 15.729, "replay_time_ms": 4.855, "grad_time_ms": 6.251, "update_time_ms": 5.972, "opt_peak_throughput": 5119.219, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -79.68740844726562, "min_q": -247.71002197265625, "max_q": -50.2374267578125, "mean_td_error": 0.6630924940109253}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 295000, "episodes_total": 294, "training_iteration": 295, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-09-55", "timestamp": 1565082595, "time_this_iter_s": 7.169079065322876, "time_total_s": 2183.175206184387, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2183.175206184387, "timesteps_since_restore": 295000, "iterations_since_restore": 295}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1558.39, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6859035157686934, "mean_processing_ms": 0.1641108611119015, "mean_inference_ms": 0.7205191530180589}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 587, "num_steps_trained": 2360000, "num_steps_sampled": 296000, "sample_time_ms": 15.614, "replay_time_ms": 5.79, "grad_time_ms": 7.247, "update_time_ms": 7.156, "opt_peak_throughput": 4415.362, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -120.93024444580078, "min_q": -1574.52490234375, "max_q": -49.507545471191406, "mean_td_error": 3.8668594360351562}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 296000, "episodes_total": 295, "training_iteration": 296, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-10-03", "timestamp": 1565082603, "time_this_iter_s": 8.313640594482422, "time_total_s": 2191.4888467788696, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2191.4888467788696, "timesteps_since_restore": 296000, "iterations_since_restore": 296}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1562.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6857346131756407, "mean_processing_ms": 0.1640707889699597, "mean_inference_ms": 0.7203201896945741}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 589, "num_steps_trained": 2368000, "num_steps_sampled": 297000, "sample_time_ms": 13.323, "replay_time_ms": 5.148, "grad_time_ms": 6.328, "update_time_ms": 6.091, "opt_peak_throughput": 5056.92, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -125.77033233642578, "min_q": -1566.244384765625, "max_q": -49.68608856201172, "mean_td_error": -0.695643424987793}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 297000, "episodes_total": 296, "training_iteration": 297, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-10-11", "timestamp": 1565082611, "time_this_iter_s": 7.528427839279175, "time_total_s": 2199.017274618149, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2199.017274618149, "timesteps_since_restore": 297000, "iterations_since_restore": 297}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1560.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6855700654753515, "mean_processing_ms": 0.16403165367047218, "mean_inference_ms": 0.7201248647179982}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 591, "num_steps_trained": 2376000, "num_steps_sampled": 298000, "sample_time_ms": 12.564, "replay_time_ms": 4.573, "grad_time_ms": 6.077, "update_time_ms": 5.954, "opt_peak_throughput": 5265.485, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.75502014160156, "min_q": -142.80026245117188, "max_q": -49.39715576171875, "mean_td_error": -0.7366434335708618}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 298000, "episodes_total": 297, "training_iteration": 298, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-10-18", "timestamp": 1565082618, "time_this_iter_s": 7.183525800704956, "time_total_s": 2206.2008004188538, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2206.2008004188538, "timesteps_since_restore": 298000, "iterations_since_restore": 298}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1562.37, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6854044468516132, "mean_processing_ms": 0.16399230732546677, "mean_inference_ms": 0.7199298841493136}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 593, "num_steps_trained": 2384000, "num_steps_sampled": 299000, "sample_time_ms": 13.841, "replay_time_ms": 5.026, "grad_time_ms": 7.556, "update_time_ms": 6.701, "opt_peak_throughput": 4235.294, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -143.42474365234375, "min_q": -2064.8154296875, "max_q": -52.084957122802734, "mean_td_error": 4.582859039306641}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 299000, "episodes_total": 298, "training_iteration": 299, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-10-26", "timestamp": 1565082626, "time_this_iter_s": 7.645563125610352, "time_total_s": 2213.846363544464, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2213.846363544464, "timesteps_since_restore": 299000, "iterations_since_restore": 299}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1555.66, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6852407834111525, "mean_processing_ms": 0.16395346060045227, "mean_inference_ms": 0.7197373805592322}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 595, "num_steps_trained": 2392000, "num_steps_sampled": 300000, "sample_time_ms": 15.216, "replay_time_ms": 4.958, "grad_time_ms": 6.446, "update_time_ms": 6.271, "opt_peak_throughput": 4964.61, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -80.23602294921875, "min_q": -212.42630004882812, "max_q": -50.996273040771484, "mean_td_error": 0.41484570503234863}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 300000, "episodes_total": 299, "training_iteration": 300, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-10-33", "timestamp": 1565082633, "time_this_iter_s": 7.4650959968566895, "time_total_s": 2221.311459541321, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2221.311459541321, "timesteps_since_restore": 300000, "iterations_since_restore": 300}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1553.25, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.685078886921686, "mean_processing_ms": 0.1639151449844104, "mean_inference_ms": 0.7195479837808187}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 597, "num_steps_trained": 2400000, "num_steps_sampled": 301000, "sample_time_ms": 10.927, "replay_time_ms": 4.23, "grad_time_ms": 6.172, "update_time_ms": 5.833, "opt_peak_throughput": 5184.734, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.89492797851562, "min_q": -210.07064819335938, "max_q": -51.47256851196289, "mean_td_error": -0.9902142286300659}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 301000, "episodes_total": 300, "training_iteration": 301, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-10-41", "timestamp": 1565082641, "time_this_iter_s": 7.68317723274231, "time_total_s": 2228.994636774063, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2228.994636774063, "timesteps_since_restore": 301000, "iterations_since_restore": 301}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1547.76, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6849159407661735, "mean_processing_ms": 0.1638766379238251, "mean_inference_ms": 0.7193589744850943}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 599, "num_steps_trained": 2408000, "num_steps_sampled": 302000, "sample_time_ms": 12.347, "replay_time_ms": 4.682, "grad_time_ms": 6.18, "update_time_ms": 5.717, "opt_peak_throughput": 5178.273, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -79.33929443359375, "min_q": -167.6403045654297, "max_q": -51.147315979003906, "mean_td_error": 0.7635042667388916}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 302000, "episodes_total": 301, "training_iteration": 302, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-10-48", "timestamp": 1565082648, "time_this_iter_s": 6.676269054412842, "time_total_s": 2235.670905828476, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2235.670905828476, "timesteps_since_restore": 302000, "iterations_since_restore": 302}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1550.6, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.684746228365828, "mean_processing_ms": 0.16383655374946918, "mean_inference_ms": 0.7191645234571006}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 601, "num_steps_trained": 2416000, "num_steps_sampled": 303000, "sample_time_ms": 13.32, "replay_time_ms": 4.381, "grad_time_ms": 5.618, "update_time_ms": 5.429, "opt_peak_throughput": 5696.267, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -76.49723815917969, "min_q": -120.3147964477539, "max_q": -51.450645446777344, "mean_td_error": -3.093719005584717}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 303000, "episodes_total": 302, "training_iteration": 303, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-10-54", "timestamp": 1565082654, "time_this_iter_s": 6.600140571594238, "time_total_s": 2242.27104640007, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2242.27104640007, "timesteps_since_restore": 303000, "iterations_since_restore": 303}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1548.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6845708322797321, "mean_processing_ms": 0.16379502052346465, "mean_inference_ms": 0.7189649421157204}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 603, "num_steps_trained": 2424000, "num_steps_sampled": 304000, "sample_time_ms": 10.373, "replay_time_ms": 3.552, "grad_time_ms": 5.308, "update_time_ms": 4.903, "opt_peak_throughput": 6028.41, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -69.83497619628906, "min_q": -143.79409790039062, "max_q": -49.8254280090332, "mean_td_error": 1.8969961404800415}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 304000, "episodes_total": 303, "training_iteration": 304, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-01", "timestamp": 1565082661, "time_this_iter_s": 6.572148323059082, "time_total_s": 2248.8431947231293, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2248.8431947231293, "timesteps_since_restore": 304000, "iterations_since_restore": 304}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1552.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6844018573382654, "mean_processing_ms": 0.1637548339287067, "mean_inference_ms": 0.7187711446475085}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 605, "num_steps_trained": 2432000, "num_steps_sampled": 305000, "sample_time_ms": 16.147, "replay_time_ms": 5.417, "grad_time_ms": 7.233, "update_time_ms": 6.857, "opt_peak_throughput": 4424.182, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -81.8782958984375, "min_q": -152.98934936523438, "max_q": -50.445411682128906, "mean_td_error": 1.9479522705078125}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 305000, "episodes_total": 304, "training_iteration": 305, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-09", "timestamp": 1565082669, "time_this_iter_s": 7.7726054191589355, "time_total_s": 2256.615800142288, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2256.615800142288, "timesteps_since_restore": 305000, "iterations_since_restore": 305}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1555.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.684236635134263, "mean_processing_ms": 0.1637155076585303, "mean_inference_ms": 0.7185814284821794}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 607, "num_steps_trained": 2440000, "num_steps_sampled": 306000, "sample_time_ms": 11.616, "replay_time_ms": 4.398, "grad_time_ms": 6.227, "update_time_ms": 6.338, "opt_peak_throughput": 5138.583, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.70376586914062, "min_q": -128.1560516357422, "max_q": -50.244503021240234, "mean_td_error": 1.4485735893249512}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 306000, "episodes_total": 305, "training_iteration": 306, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-16", "timestamp": 1565082676, "time_this_iter_s": 7.3812620639801025, "time_total_s": 2263.9970622062683, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2263.9970622062683, "timesteps_since_restore": 306000, "iterations_since_restore": 306}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1555.46, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6840728938752229, "mean_processing_ms": 0.16367651027057548, "mean_inference_ms": 0.7183935182724731}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 609, "num_steps_trained": 2448000, "num_steps_sampled": 307000, "sample_time_ms": 13.614, "replay_time_ms": 4.011, "grad_time_ms": 5.693, "update_time_ms": 5.423, "opt_peak_throughput": 5620.884, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -77.17074584960938, "min_q": -149.28500366210938, "max_q": -50.493282318115234, "mean_td_error": 0.38824009895324707}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 307000, "episodes_total": 306, "training_iteration": 307, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-23", "timestamp": 1565082683, "time_this_iter_s": 6.575001001358032, "time_total_s": 2270.5720632076263, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2270.5720632076263, "timesteps_since_restore": 307000, "iterations_since_restore": 307}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1547.18, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6839100500964712, "mean_processing_ms": 0.16363777727864362, "mean_inference_ms": 0.7182070529960649}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 611, "num_steps_trained": 2456000, "num_steps_sampled": 308000, "sample_time_ms": 10.885, "replay_time_ms": 3.856, "grad_time_ms": 5.604, "update_time_ms": 5.294, "opt_peak_throughput": 5710.445, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -76.3253173828125, "min_q": -133.00680541992188, "max_q": -50.80067825317383, "mean_td_error": 0.48091864585876465}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 308000, "episodes_total": 307, "training_iteration": 308, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-29", "timestamp": 1565082689, "time_this_iter_s": 6.459814786911011, "time_total_s": 2277.0318779945374, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2277.0318779945374, "timesteps_since_restore": 308000, "iterations_since_restore": 308}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1538.13, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6837497235066903, "mean_processing_ms": 0.16359973842922315, "mean_inference_ms": 0.7180237374679938}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 613, "num_steps_trained": 2464000, "num_steps_sampled": 309000, "sample_time_ms": 12.286, "replay_time_ms": 3.554, "grad_time_ms": 5.323, "update_time_ms": 5.052, "opt_peak_throughput": 6012.046, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.35132598876953, "min_q": -123.23800659179688, "max_q": -51.06748580932617, "mean_td_error": 1.2110403776168823}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 309000, "episodes_total": 308, "training_iteration": 309, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-36", "timestamp": 1565082696, "time_this_iter_s": 6.6444971561431885, "time_total_s": 2283.6763751506805, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2283.6763751506805, "timesteps_since_restore": 309000, "iterations_since_restore": 309}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1533.29, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6835918959796164, "mean_processing_ms": 0.16356231548479122, "mean_inference_ms": 0.7178430000106687}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 615, "num_steps_trained": 2472000, "num_steps_sampled": 310000, "sample_time_ms": 11.61, "replay_time_ms": 3.501, "grad_time_ms": 5.227, "update_time_ms": 4.504, "opt_peak_throughput": 6121.871, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -70.41021728515625, "min_q": -136.0606231689453, "max_q": -49.79560470581055, "mean_td_error": 3.181337356567383}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 310000, "episodes_total": 309, "training_iteration": 310, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-42", "timestamp": 1565082702, "time_this_iter_s": 6.718143463134766, "time_total_s": 2290.3945186138153, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2290.3945186138153, "timesteps_since_restore": 310000, "iterations_since_restore": 310}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1537.74, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683435711612318, "mean_processing_ms": 0.16352527913995726, "mean_inference_ms": 0.7176641436558707}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 617, "num_steps_trained": 2480000, "num_steps_sampled": 311000, "sample_time_ms": 10.952, "replay_time_ms": 3.737, "grad_time_ms": 5.331, "update_time_ms": 5.1, "opt_peak_throughput": 6002.26, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -81.18490600585938, "min_q": -143.39747619628906, "max_q": -49.880348205566406, "mean_td_error": 4.77424430847168}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 311000, "episodes_total": 310, "training_iteration": 311, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-49", "timestamp": 1565082709, "time_this_iter_s": 6.704085350036621, "time_total_s": 2297.098603963852, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2297.098603963852, "timesteps_since_restore": 311000, "iterations_since_restore": 311}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1538.06, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832805863920403, "mean_processing_ms": 0.16348848526645365, "mean_inference_ms": 0.7174863159726206}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 619, "num_steps_trained": 2488000, "num_steps_sampled": 312000, "sample_time_ms": 11.733, "replay_time_ms": 4.446, "grad_time_ms": 5.792, "update_time_ms": 5.214, "opt_peak_throughput": 5525.182, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.78752899169922, "min_q": -154.72242736816406, "max_q": -49.50259017944336, "mean_td_error": 4.566753387451172}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 312000, "episodes_total": 311, "training_iteration": 312, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-11-56", "timestamp": 1565082716, "time_this_iter_s": 6.609510898590088, "time_total_s": 2303.708114862442, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2303.708114862442, "timesteps_since_restore": 312000, "iterations_since_restore": 312}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1536.68, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6831246029915272, "mean_processing_ms": 0.1634513946687406, "mean_inference_ms": 0.7173069632213983}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 621, "num_steps_trained": 2496000, "num_steps_sampled": 313000, "sample_time_ms": 12.911, "replay_time_ms": 4.031, "grad_time_ms": 5.645, "update_time_ms": 5.237, "opt_peak_throughput": 5668.313, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -75.76870727539062, "min_q": -191.16598510742188, "max_q": -50.27760314941406, "mean_td_error": 2.915520191192627}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 313000, "episodes_total": 312, "training_iteration": 313, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-02", "timestamp": 1565082722, "time_this_iter_s": 6.501172065734863, "time_total_s": 2310.209286928177, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2310.209286928177, "timesteps_since_restore": 313000, "iterations_since_restore": 313}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1543.95, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.68296953914147, "mean_processing_ms": 0.16341420790815347, "mean_inference_ms": 0.7171280487660014}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 623, "num_steps_trained": 2504000, "num_steps_sampled": 314000, "sample_time_ms": 14.541, "replay_time_ms": 4.537, "grad_time_ms": 6.24, "update_time_ms": 5.936, "opt_peak_throughput": 5128.432, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -87.75846862792969, "min_q": -307.55804443359375, "max_q": -50.271060943603516, "mean_td_error": 6.487180709838867}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 314000, "episodes_total": 313, "training_iteration": 314, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-10", "timestamp": 1565082730, "time_this_iter_s": 7.9696290493011475, "time_total_s": 2318.178915977478, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2318.178915977478, "timesteps_since_restore": 314000, "iterations_since_restore": 314}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1546.05, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828139186431856, "mean_processing_ms": 0.1633767793868378, "mean_inference_ms": 0.7169478707727573}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 625, "num_steps_trained": 2512000, "num_steps_sampled": 315000, "sample_time_ms": 11.576, "replay_time_ms": 3.705, "grad_time_ms": 5.493, "update_time_ms": 5.056, "opt_peak_throughput": 5825.422, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.10275268554688, "min_q": -153.14402770996094, "max_q": -49.16394805908203, "mean_td_error": 0.9273732900619507}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 315000, "episodes_total": 314, "training_iteration": 315, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-17", "timestamp": 1565082737, "time_this_iter_s": 7.194685220718384, "time_total_s": 2325.3736011981964, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2325.3736011981964, "timesteps_since_restore": 315000, "iterations_since_restore": 315}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1546.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.682658715189032, "mean_processing_ms": 0.1633394288871265, "mean_inference_ms": 0.7167681061010152}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 626, "num_steps_trained": 2520000, "num_steps_sampled": 316000, "sample_time_ms": 11.834, "replay_time_ms": 3.935, "grad_time_ms": 5.664, "update_time_ms": 5.167, "opt_peak_throughput": 5649.512, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -74.90676879882812, "min_q": -136.01052856445312, "max_q": -49.634918212890625, "mean_td_error": 8.010514259338379}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 316000, "episodes_total": 315, "training_iteration": 316, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-24", "timestamp": 1565082744, "time_this_iter_s": 6.670284271240234, "time_total_s": 2332.0438854694366, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2332.0438854694366, "timesteps_since_restore": 316000, "iterations_since_restore": 316}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1539.19, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6824988816244912, "mean_processing_ms": 0.16330092614106292, "mean_inference_ms": 0.7165833166146325}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 628, "num_steps_trained": 2528000, "num_steps_sampled": 317000, "sample_time_ms": 11.797, "replay_time_ms": 4.418, "grad_time_ms": 5.863, "update_time_ms": 5.368, "opt_peak_throughput": 5458.268, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -89.78956604003906, "min_q": -469.7743225097656, "max_q": -49.68358612060547, "mean_td_error": 2.3501110076904297}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 317000, "episodes_total": 316, "training_iteration": 317, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-31", "timestamp": 1565082751, "time_this_iter_s": 6.548614263534546, "time_total_s": 2338.592499732971, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2338.592499732971, "timesteps_since_restore": 317000, "iterations_since_restore": 317}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1544.42, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6823333698415811, "mean_processing_ms": 0.16326090256884776, "mean_inference_ms": 0.7163934939939817}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 630, "num_steps_trained": 2536000, "num_steps_sampled": 318000, "sample_time_ms": 11.945, "replay_time_ms": 4.295, "grad_time_ms": 5.66, "update_time_ms": 5.525, "opt_peak_throughput": 5653.558, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.03608703613281, "min_q": -151.6185760498047, "max_q": -49.67549133300781, "mean_td_error": 3.0879364013671875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 318000, "episodes_total": 317, "training_iteration": 318, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-37", "timestamp": 1565082757, "time_this_iter_s": 6.583905220031738, "time_total_s": 2345.176404953003, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2345.176404953003, "timesteps_since_restore": 318000, "iterations_since_restore": 318}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1548.62, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6821674401579843, "mean_processing_ms": 0.16322073043813043, "mean_inference_ms": 0.7162036769376638}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 632, "num_steps_trained": 2544000, "num_steps_sampled": 319000, "sample_time_ms": 11.386, "replay_time_ms": 3.942, "grad_time_ms": 5.569, "update_time_ms": 5.435, "opt_peak_throughput": 5746.188, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.85307312011719, "min_q": -104.56100463867188, "max_q": -49.91477584838867, "mean_td_error": 1.2251554727554321}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 319000, "episodes_total": 318, "training_iteration": 319, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-44", "timestamp": 1565082764, "time_this_iter_s": 6.715830087661743, "time_total_s": 2351.8922350406647, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2351.8922350406647, "timesteps_since_restore": 319000, "iterations_since_restore": 319}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1552.86, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.682001291634332, "mean_processing_ms": 0.16318036824464094, "mean_inference_ms": 0.7160137593733181}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 634, "num_steps_trained": 2552000, "num_steps_sampled": 320000, "sample_time_ms": 10.888, "replay_time_ms": 3.627, "grad_time_ms": 5.277, "update_time_ms": 4.763, "opt_peak_throughput": 6063.926, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.236328125, "min_q": -108.3043441772461, "max_q": -49.073089599609375, "mean_td_error": 5.003808498382568}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 320000, "episodes_total": 319, "training_iteration": 320, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-51", "timestamp": 1565082771, "time_this_iter_s": 6.6927900314331055, "time_total_s": 2358.585025072098, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2358.585025072098, "timesteps_since_restore": 320000, "iterations_since_restore": 320}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1552.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6818336751927982, "mean_processing_ms": 0.16313968411326712, "mean_inference_ms": 0.7158226930484821}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 636, "num_steps_trained": 2560000, "num_steps_sampled": 321000, "sample_time_ms": 12.141, "replay_time_ms": 3.551, "grad_time_ms": 5.404, "update_time_ms": 4.93, "opt_peak_throughput": 5921.074, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.84954833984375, "min_q": -100.55138397216797, "max_q": -49.74778366088867, "mean_td_error": 3.810225486755371}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 321000, "episodes_total": 320, "training_iteration": 321, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-12-57", "timestamp": 1565082777, "time_this_iter_s": 6.7850501537323, "time_total_s": 2365.37007522583, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2365.37007522583, "timesteps_since_restore": 321000, "iterations_since_restore": 321}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1552.86, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6816680851207999, "mean_processing_ms": 0.1630993899621073, "mean_inference_ms": 0.7156337587165621}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 638, "num_steps_trained": 2568000, "num_steps_sampled": 322000, "sample_time_ms": 12.136, "replay_time_ms": 4.138, "grad_time_ms": 5.782, "update_time_ms": 5.447, "opt_peak_throughput": 5534.295, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -69.46107482910156, "min_q": -145.7227783203125, "max_q": -49.99323272705078, "mean_td_error": 0.6821892261505127}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 322000, "episodes_total": 321, "training_iteration": 322, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-13-04", "timestamp": 1565082784, "time_this_iter_s": 6.697510004043579, "time_total_s": 2372.0675852298737, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2372.0675852298737, "timesteps_since_restore": 322000, "iterations_since_restore": 322}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1553.05, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815086479707314, "mean_processing_ms": 0.1630606152314271, "mean_inference_ms": 0.7154508320184507}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 640, "num_steps_trained": 2576000, "num_steps_sampled": 323000, "sample_time_ms": 12.856, "replay_time_ms": 4.581, "grad_time_ms": 6.404, "update_time_ms": 5.977, "opt_peak_throughput": 4996.732, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -84.24797821044922, "min_q": -390.76788330078125, "max_q": -49.38256072998047, "mean_td_error": 7.025904655456543}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 323000, "episodes_total": 322, "training_iteration": 323, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-13-12", "timestamp": 1565082792, "time_this_iter_s": 8.036915063858032, "time_total_s": 2380.1045002937317, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2380.1045002937317, "timesteps_since_restore": 323000, "iterations_since_restore": 323}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1548.32, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6813516773506307, "mean_processing_ms": 0.16302237840189535, "mean_inference_ms": 0.715270271020603}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 642, "num_steps_trained": 2584000, "num_steps_sampled": 324000, "sample_time_ms": 11.663, "replay_time_ms": 3.6, "grad_time_ms": 5.091, "update_time_ms": 4.725, "opt_peak_throughput": 6286.074, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -76.39854431152344, "min_q": -135.81895446777344, "max_q": -51.14509201049805, "mean_td_error": 0.11976277828216553}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 324000, "episodes_total": 323, "training_iteration": 324, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-13-19", "timestamp": 1565082799, "time_this_iter_s": 6.8961286544799805, "time_total_s": 2387.0006289482117, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2387.0006289482117, "timesteps_since_restore": 324000, "iterations_since_restore": 324}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1553.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811959117247119, "mean_processing_ms": 0.16298443250674044, "mean_inference_ms": 0.7150910350144498}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 644, "num_steps_trained": 2592000, "num_steps_sampled": 325000, "sample_time_ms": 11.227, "replay_time_ms": 3.777, "grad_time_ms": 5.361, "update_time_ms": 5.095, "opt_peak_throughput": 5968.867, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -77.89239501953125, "min_q": -127.1358642578125, "max_q": -51.029117584228516, "mean_td_error": 1.7982258796691895}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 325000, "episodes_total": 324, "training_iteration": 325, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-13-26", "timestamp": 1565082806, "time_this_iter_s": 6.724682807922363, "time_total_s": 2393.725311756134, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2393.725311756134, "timesteps_since_restore": 325000, "iterations_since_restore": 325}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1556.16, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810359356653151, "mean_processing_ms": 0.16294548706868336, "mean_inference_ms": 0.7149081701737329}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 646, "num_steps_trained": 2600000, "num_steps_sampled": 326000, "sample_time_ms": 12.67, "replay_time_ms": 4.331, "grad_time_ms": 5.654, "update_time_ms": 5.163, "opt_peak_throughput": 5659.398, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.9323501586914, "min_q": -141.01956176757812, "max_q": -52.066349029541016, "mean_td_error": -0.0513383150100708}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 326000, "episodes_total": 325, "training_iteration": 326, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-13-32", "timestamp": 1565082812, "time_this_iter_s": 6.658917665481567, "time_total_s": 2400.3842294216156, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2400.3842294216156, "timesteps_since_restore": 326000, "iterations_since_restore": 326}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1558.91, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6808784561910757, "mean_processing_ms": 0.16290706722294204, "mean_inference_ms": 0.7147276629037959}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 648, "num_steps_trained": 2608000, "num_steps_sampled": 327000, "sample_time_ms": 12.462, "replay_time_ms": 4.609, "grad_time_ms": 6.52, "update_time_ms": 5.914, "opt_peak_throughput": 4907.771, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.06233215332031, "min_q": -184.02325439453125, "max_q": -51.361026763916016, "mean_td_error": -1.0652450323104858}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 327000, "episodes_total": 326, "training_iteration": 327, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-13-39", "timestamp": 1565082819, "time_this_iter_s": 6.705070734024048, "time_total_s": 2407.0893001556396, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2407.0893001556396, "timesteps_since_restore": 327000, "iterations_since_restore": 327}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1557.36, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6807218767116413, "mean_processing_ms": 0.1628689014674101, "mean_inference_ms": 0.7145480927556678}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 650, "num_steps_trained": 2616000, "num_steps_sampled": 328000, "sample_time_ms": 12.163, "replay_time_ms": 4.104, "grad_time_ms": 5.991, "update_time_ms": 6.243, "opt_peak_throughput": 5341.085, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.22315979003906, "min_q": -154.31863403320312, "max_q": -50.79981231689453, "mean_td_error": 3.0290632247924805}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 328000, "episodes_total": 327, "training_iteration": 328, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-13-46", "timestamp": 1565082826, "time_this_iter_s": 6.686545372009277, "time_total_s": 2413.775845527649, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2413.775845527649, "timesteps_since_restore": 328000, "iterations_since_restore": 328}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1560.72, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6805707554141331, "mean_processing_ms": 0.16283201683959408, "mean_inference_ms": 0.7143733881890781}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 652, "num_steps_trained": 2624000, "num_steps_sampled": 329000, "sample_time_ms": 13.635, "replay_time_ms": 4.669, "grad_time_ms": 6.26, "update_time_ms": 6.015, "opt_peak_throughput": 5112.083, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.33604431152344, "min_q": -144.1832275390625, "max_q": -49.519508361816406, "mean_td_error": 5.367022514343262}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 329000, "episodes_total": 328, "training_iteration": 329, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-13-54", "timestamp": 1565082834, "time_this_iter_s": 7.874887228012085, "time_total_s": 2421.650732755661, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2421.650732755661, "timesteps_since_restore": 329000, "iterations_since_restore": 329}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1560.31, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6804232080885856, "mean_processing_ms": 0.16279608437659362, "mean_inference_ms": 0.7142019505360874}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 654, "num_steps_trained": 2632000, "num_steps_sampled": 330000, "sample_time_ms": 11.709, "replay_time_ms": 4.469, "grad_time_ms": 5.358, "update_time_ms": 5.274, "opt_peak_throughput": 5972.133, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -75.1795425415039, "min_q": -154.4366912841797, "max_q": -51.0999755859375, "mean_td_error": -1.7689621448516846}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 330000, "episodes_total": 329, "training_iteration": 330, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-01", "timestamp": 1565082841, "time_this_iter_s": 7.270378589630127, "time_total_s": 2428.921111345291, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2428.921111345291, "timesteps_since_restore": 330000, "iterations_since_restore": 330}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1563.4, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6802714576806871, "mean_processing_ms": 0.16275915714718306, "mean_inference_ms": 0.714026696972781}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 656, "num_steps_trained": 2640000, "num_steps_sampled": 331000, "sample_time_ms": 12.506, "replay_time_ms": 3.971, "grad_time_ms": 5.812, "update_time_ms": 5.732, "opt_peak_throughput": 5505.781, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.7025146484375, "min_q": -136.62806701660156, "max_q": -50.33329391479492, "mean_td_error": 5.16262674331665}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 331000, "episodes_total": 330, "training_iteration": 331, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-08", "timestamp": 1565082848, "time_this_iter_s": 6.616500377655029, "time_total_s": 2435.537611722946, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2435.537611722946, "timesteps_since_restore": 331000, "iterations_since_restore": 331}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1556.31, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6801200927708219, "mean_processing_ms": 0.16272249900330008, "mean_inference_ms": 0.7138519738082174}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 658, "num_steps_trained": 2648000, "num_steps_sampled": 332000, "sample_time_ms": 12.646, "replay_time_ms": 3.976, "grad_time_ms": 5.534, "update_time_ms": 5.426, "opt_peak_throughput": 5782.804, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.52511596679688, "min_q": -118.28170013427734, "max_q": -48.75477600097656, "mean_td_error": 0.24729561805725098}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 332000, "episodes_total": 331, "training_iteration": 332, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-14", "timestamp": 1565082854, "time_this_iter_s": 6.564260482788086, "time_total_s": 2442.1018722057343, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2442.1018722057343, "timesteps_since_restore": 332000, "iterations_since_restore": 332}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1553.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6799733657024148, "mean_processing_ms": 0.16268695448929715, "mean_inference_ms": 0.7136821015015038}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 660, "num_steps_trained": 2656000, "num_steps_sampled": 333000, "sample_time_ms": 12.928, "replay_time_ms": 4.685, "grad_time_ms": 5.989, "update_time_ms": 6.166, "opt_peak_throughput": 5342.977, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.90438842773438, "min_q": -147.01719665527344, "max_q": -49.50550079345703, "mean_td_error": -0.3444051742553711}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 333000, "episodes_total": 332, "training_iteration": 333, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-22", "timestamp": 1565082862, "time_this_iter_s": 7.932406425476074, "time_total_s": 2450.0342786312103, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2450.0342786312103, "timesteps_since_restore": 333000, "iterations_since_restore": 333}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1558.78, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6798301949164669, "mean_processing_ms": 0.16265222443985514, "mean_inference_ms": 0.713514748319156}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 662, "num_steps_trained": 2664000, "num_steps_sampled": 334000, "sample_time_ms": 10.62, "replay_time_ms": 3.883, "grad_time_ms": 5.149, "update_time_ms": 5.007, "opt_peak_throughput": 6214.733, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.81756591796875, "min_q": -163.25674438476562, "max_q": -49.861446380615234, "mean_td_error": 1.2084161043167114}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 334000, "episodes_total": 333, "training_iteration": 334, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-29", "timestamp": 1565082869, "time_this_iter_s": 7.15690803527832, "time_total_s": 2457.1911866664886, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2457.1911866664886, "timesteps_since_restore": 334000, "iterations_since_restore": 334}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1566.35, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6796891750120517, "mean_processing_ms": 0.1626178838238187, "mean_inference_ms": 0.7133492893074361}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 664, "num_steps_trained": 2672000, "num_steps_sampled": 335000, "sample_time_ms": 12.945, "replay_time_ms": 3.998, "grad_time_ms": 5.546, "update_time_ms": 5.404, "opt_peak_throughput": 5769.927, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -77.67422485351562, "min_q": -150.1233367919922, "max_q": -49.430458068847656, "mean_td_error": 0.32061564922332764}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 335000, "episodes_total": 334, "training_iteration": 335, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-36", "timestamp": 1565082876, "time_this_iter_s": 6.728033781051636, "time_total_s": 2463.9192204475403, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2463.9192204475403, "timesteps_since_restore": 335000, "iterations_since_restore": 335}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1560.04, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6795491485235297, "mean_processing_ms": 0.16258376652780204, "mean_inference_ms": 0.7131856338412185}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 666, "num_steps_trained": 2680000, "num_steps_sampled": 336000, "sample_time_ms": 13.162, "replay_time_ms": 4.213, "grad_time_ms": 5.571, "update_time_ms": 5.331, "opt_peak_throughput": 5744.097, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.59768676757812, "min_q": -114.82843017578125, "max_q": -49.15138244628906, "mean_td_error": 1.3966398239135742}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 336000, "episodes_total": 335, "training_iteration": 336, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-43", "timestamp": 1565082883, "time_this_iter_s": 6.601120710372925, "time_total_s": 2470.520341157913, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2470.520341157913, "timesteps_since_restore": 336000, "iterations_since_restore": 336}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1561.6, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6794110124402957, "mean_processing_ms": 0.16255002760095272, "mean_inference_ms": 0.7130238156292795}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 668, "num_steps_trained": 2688000, "num_steps_sampled": 337000, "sample_time_ms": 12.44, "replay_time_ms": 4.03, "grad_time_ms": 5.889, "update_time_ms": 5.587, "opt_peak_throughput": 5433.498, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -79.08207702636719, "min_q": -133.35940551757812, "max_q": -50.16158676147461, "mean_td_error": 1.9786713123321533}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 337000, "episodes_total": 336, "training_iteration": 337, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-49", "timestamp": 1565082889, "time_this_iter_s": 6.751084566116333, "time_total_s": 2477.2714257240295, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2477.2714257240295, "timesteps_since_restore": 337000, "iterations_since_restore": 337}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1563.38, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.679273866747565, "mean_processing_ms": 0.1625165113629012, "mean_inference_ms": 0.712863437943159}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 670, "num_steps_trained": 2696000, "num_steps_sampled": 338000, "sample_time_ms": 11.106, "replay_time_ms": 3.635, "grad_time_ms": 5.12, "update_time_ms": 4.654, "opt_peak_throughput": 6250.127, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -69.31796264648438, "min_q": -132.15174865722656, "max_q": -49.99689865112305, "mean_td_error": 4.031140327453613}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 338000, "episodes_total": 337, "training_iteration": 338, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-14-56", "timestamp": 1565082896, "time_this_iter_s": 6.635818719863892, "time_total_s": 2483.9072444438934, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2483.9072444438934, "timesteps_since_restore": 338000, "iterations_since_restore": 338}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1560.52, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6791356321869421, "mean_processing_ms": 0.1624827735851019, "mean_inference_ms": 0.7127023317904605}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 672, "num_steps_trained": 2704000, "num_steps_sampled": 339000, "sample_time_ms": 11.268, "replay_time_ms": 3.676, "grad_time_ms": 5.356, "update_time_ms": 4.926, "opt_peak_throughput": 5974.792, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.02964401245117, "min_q": -112.88963317871094, "max_q": -49.77119445800781, "mean_td_error": 1.6818066835403442}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 339000, "episodes_total": 338, "training_iteration": 339, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-15-03", "timestamp": 1565082903, "time_this_iter_s": 6.751970291137695, "time_total_s": 2490.659214735031, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2490.659214735031, "timesteps_since_restore": 339000, "iterations_since_restore": 339}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1558.42, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6789953362711815, "mean_processing_ms": 0.16244856395485407, "mean_inference_ms": 0.7125391033043593}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 674, "num_steps_trained": 2712000, "num_steps_sampled": 340000, "sample_time_ms": 10.507, "replay_time_ms": 3.454, "grad_time_ms": 5.332, "update_time_ms": 4.725, "opt_peak_throughput": 6001.374, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.13329315185547, "min_q": -120.8936767578125, "max_q": -49.321720123291016, "mean_td_error": 1.4124162197113037}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 340000, "episodes_total": 339, "training_iteration": 340, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-15-10", "timestamp": 1565082910, "time_this_iter_s": 6.712784051895142, "time_total_s": 2497.3719987869263, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2497.3719987869263, "timesteps_since_restore": 340000, "iterations_since_restore": 340}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1556.94, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6788562597178999, "mean_processing_ms": 0.16241472597024345, "mean_inference_ms": 0.7123773942613829}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 676, "num_steps_trained": 2720000, "num_steps_sampled": 341000, "sample_time_ms": 12.372, "replay_time_ms": 4.334, "grad_time_ms": 6.069, "update_time_ms": 5.556, "opt_peak_throughput": 5272.704, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.31417846679688, "min_q": -132.66156005859375, "max_q": -48.792728424072266, "mean_td_error": -2.2542710304260254}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 341000, "episodes_total": 340, "training_iteration": 341, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-15-16", "timestamp": 1565082916, "time_this_iter_s": 6.683581113815308, "time_total_s": 2504.0555799007416, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2504.0555799007416, "timesteps_since_restore": 341000, "iterations_since_restore": 341}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1554.43, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6787180331062274, "mean_processing_ms": 0.16238114545214766, "mean_inference_ms": 0.7122168348926279}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 678, "num_steps_trained": 2728000, "num_steps_sampled": 342000, "sample_time_ms": 12.111, "replay_time_ms": 4.255, "grad_time_ms": 6.453, "update_time_ms": 5.969, "opt_peak_throughput": 4959.033, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.92765808105469, "min_q": -158.5797119140625, "max_q": -49.984413146972656, "mean_td_error": -3.2176733016967773}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 342000, "episodes_total": 341, "training_iteration": 342, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-15-23", "timestamp": 1565082923, "time_this_iter_s": 6.662668704986572, "time_total_s": 2510.718248605728, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2510.718248605728, "timesteps_since_restore": 342000, "iterations_since_restore": 342}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1557.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6785806965305977, "mean_processing_ms": 0.1623477890848086, "mean_inference_ms": 0.7120574659302672}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 680, "num_steps_trained": 2736000, "num_steps_sampled": 343000, "sample_time_ms": 13.016, "replay_time_ms": 4.189, "grad_time_ms": 5.798, "update_time_ms": 5.683, "opt_peak_throughput": 5519.048, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -74.36932373046875, "min_q": -132.0734405517578, "max_q": -49.931583404541016, "mean_td_error": 0.11558735370635986}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 343000, "episodes_total": 342, "training_iteration": 343, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-15-30", "timestamp": 1565082930, "time_this_iter_s": 6.612102031707764, "time_total_s": 2517.330350637436, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2517.330350637436, "timesteps_since_restore": 343000, "iterations_since_restore": 343}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1544.08, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6784463791868159, "mean_processing_ms": 0.16231527340357613, "mean_inference_ms": 0.7119016946765414}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 682, "num_steps_trained": 2744000, "num_steps_sampled": 344000, "sample_time_ms": 14.476, "replay_time_ms": 4.592, "grad_time_ms": 6.172, "update_time_ms": 5.965, "opt_peak_throughput": 5184.574, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.56948852539062, "min_q": -114.61152648925781, "max_q": -48.50909423828125, "mean_td_error": -0.25505781173706055}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 344000, "episodes_total": 343, "training_iteration": 344, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-15-37", "timestamp": 1565082937, "time_this_iter_s": 7.921642303466797, "time_total_s": 2525.2519929409027, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2525.2519929409027, "timesteps_since_restore": 344000, "iterations_since_restore": 344}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1545.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6783210024214589, "mean_processing_ms": 0.16228531112756844, "mean_inference_ms": 0.7117598396117824}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 684, "num_steps_trained": 2752000, "num_steps_sampled": 345000, "sample_time_ms": 28.501, "replay_time_ms": 8.992, "grad_time_ms": 10.4, "update_time_ms": 12.587, "opt_peak_throughput": 3076.977, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.9931640625, "min_q": -97.05615234375, "max_q": -47.88882827758789, "mean_td_error": -2.0930635929107666}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 345000, "episodes_total": 344, "training_iteration": 345, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-15-49", "timestamp": 1565082949, "time_this_iter_s": 11.34892225265503, "time_total_s": 2536.6009151935577, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2536.6009151935577, "timesteps_since_restore": 345000, "iterations_since_restore": 345}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1548.24, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6782096160156563, "mean_processing_ms": 0.1622583595712663, "mean_inference_ms": 0.7116311162721344}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 686, "num_steps_trained": 2760000, "num_steps_sampled": 346000, "sample_time_ms": 12.834, "replay_time_ms": 4.412, "grad_time_ms": 6.047, "update_time_ms": 6.23, "opt_peak_throughput": 5291.516, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.685997009277344, "min_q": -107.58245849609375, "max_q": -47.80561447143555, "mean_td_error": 3.9644031524658203}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 346000, "episodes_total": 345, "training_iteration": 346, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-15-59", "timestamp": 1565082959, "time_this_iter_s": 10.380736589431763, "time_total_s": 2546.9816517829895, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2546.9816517829895, "timesteps_since_restore": 346000, "iterations_since_restore": 346}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1547.24, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6781006376738395, "mean_processing_ms": 0.1622319749709832, "mean_inference_ms": 0.7115048206930709}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 688, "num_steps_trained": 2768000, "num_steps_sampled": 347000, "sample_time_ms": 13.429, "replay_time_ms": 4.681, "grad_time_ms": 6.117, "update_time_ms": 5.694, "opt_peak_throughput": 5231.008, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.0869140625, "min_q": -169.9378204345703, "max_q": -47.4398078918457, "mean_td_error": -1.641014814376831}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 347000, "episodes_total": 346, "training_iteration": 347, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-16-06", "timestamp": 1565082966, "time_this_iter_s": 7.114442586898804, "time_total_s": 2554.0960943698883, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2554.0960943698883, "timesteps_since_restore": 347000, "iterations_since_restore": 347}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1547.71, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6779947120779484, "mean_processing_ms": 0.1622063143643215, "mean_inference_ms": 0.7113810451134336}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 690, "num_steps_trained": 2776000, "num_steps_sampled": 348000, "sample_time_ms": 11.408, "replay_time_ms": 3.691, "grad_time_ms": 5.357, "update_time_ms": 5.216, "opt_peak_throughput": 5973.489, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.62921905517578, "min_q": -118.54365539550781, "max_q": -46.9967041015625, "mean_td_error": 0.24493002891540527}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 348000, "episodes_total": 347, "training_iteration": 348, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-16-13", "timestamp": 1565082973, "time_this_iter_s": 7.158262729644775, "time_total_s": 2561.254357099533, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2561.254357099533, "timesteps_since_restore": 348000, "iterations_since_restore": 348}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1552.25, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6778901155041527, "mean_processing_ms": 0.16218095882398223, "mean_inference_ms": 0.7112582146569334}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 692, "num_steps_trained": 2784000, "num_steps_sampled": 349000, "sample_time_ms": 11.74, "replay_time_ms": 3.885, "grad_time_ms": 5.586, "update_time_ms": 5.17, "opt_peak_throughput": 5728.236, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.05998229980469, "min_q": -104.08793640136719, "max_q": -46.8654899597168, "mean_td_error": 1.145153284072876}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 349000, "episodes_total": 348, "training_iteration": 349, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-16-20", "timestamp": 1565082980, "time_this_iter_s": 6.531555891036987, "time_total_s": 2567.78591299057, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2567.78591299057, "timesteps_since_restore": 349000, "iterations_since_restore": 349}
{"episode_reward_max": -589.0, "episode_reward_min": -28618.0, "episode_reward_mean": -1554.33, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6777783868467523, "mean_processing_ms": 0.1621553309532146, "mean_inference_ms": 0.7111342840424526}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 694, "num_steps_trained": 2792000, "num_steps_sampled": 350000, "sample_time_ms": 14.277, "replay_time_ms": 4.767, "grad_time_ms": 5.931, "update_time_ms": 6.173, "opt_peak_throughput": 5395.753, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.08582305908203, "min_q": -122.78532409667969, "max_q": -46.90129470825195, "mean_td_error": 1.6238631010055542}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 350000, "episodes_total": 349, "training_iteration": 350, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-16-28", "timestamp": 1565082988, "time_this_iter_s": 7.968575716018677, "time_total_s": 2575.7544887065887, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2575.7544887065887, "timesteps_since_restore": 350000, "iterations_since_restore": 350}
{"episode_reward_max": -589.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1283.35, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6776649666425838, "mean_processing_ms": 0.16213009549193974, "mean_inference_ms": 0.7110119298968933}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 696, "num_steps_trained": 2800000, "num_steps_sampled": 351000, "sample_time_ms": 10.706, "replay_time_ms": 3.693, "grad_time_ms": 4.919, "update_time_ms": 4.768, "opt_peak_throughput": 6505.35, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.46217346191406, "min_q": -121.76058197021484, "max_q": -46.043853759765625, "mean_td_error": 1.6752681732177734}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 351000, "episodes_total": 350, "training_iteration": 351, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-16-35", "timestamp": 1565082995, "time_this_iter_s": 6.785443305969238, "time_total_s": 2582.539932012558, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2582.539932012558, "timesteps_since_restore": 351000, "iterations_since_restore": 351}
{"episode_reward_max": -589.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1285.12, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6775523135829131, "mean_processing_ms": 0.16210491910927685, "mean_inference_ms": 0.7108900273269356}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 698, "num_steps_trained": 2808000, "num_steps_sampled": 352000, "sample_time_ms": 10.243, "replay_time_ms": 4.071, "grad_time_ms": 5.479, "update_time_ms": 5.402, "opt_peak_throughput": 5840.683, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.3453369140625, "min_q": -110.2315444946289, "max_q": -45.98212814331055, "mean_td_error": -0.30849528312683105}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 352000, "episodes_total": 351, "training_iteration": 352, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-16-41", "timestamp": 1565083001, "time_this_iter_s": 6.6303980350494385, "time_total_s": 2589.1703300476074, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2589.1703300476074, "timesteps_since_restore": 352000, "iterations_since_restore": 352}
{"episode_reward_max": -589.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1287.56, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6774408541811152, "mean_processing_ms": 0.1620799928970143, "mean_inference_ms": 0.7107690222224662}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 700, "num_steps_trained": 2816000, "num_steps_sampled": 353000, "sample_time_ms": 11.913, "replay_time_ms": 4.263, "grad_time_ms": 6.037, "update_time_ms": 5.422, "opt_peak_throughput": 5300.691, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -61.523433685302734, "min_q": -108.35810089111328, "max_q": -45.30324172973633, "mean_td_error": -1.7545057535171509}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 353000, "episodes_total": 352, "training_iteration": 353, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-16-48", "timestamp": 1565083008, "time_this_iter_s": 6.487654209136963, "time_total_s": 2595.6579842567444, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2595.6579842567444, "timesteps_since_restore": 353000, "iterations_since_restore": 353}
{"episode_reward_max": -589.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1284.62, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6773300253646742, "mean_processing_ms": 0.1620551727867516, "mean_inference_ms": 0.7106486131513212}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 702, "num_steps_trained": 2824000, "num_steps_sampled": 354000, "sample_time_ms": 11.705, "replay_time_ms": 4.051, "grad_time_ms": 5.88, "update_time_ms": 5.391, "opt_peak_throughput": 5442.046, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -69.64938354492188, "min_q": -151.17881774902344, "max_q": -45.78181457519531, "mean_td_error": 3.545548915863037}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 354000, "episodes_total": 353, "training_iteration": 354, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-16-54", "timestamp": 1565083014, "time_this_iter_s": 6.471038818359375, "time_total_s": 2602.1290230751038, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2602.1290230751038, "timesteps_since_restore": 354000, "iterations_since_restore": 354}
{"episode_reward_max": -589.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1289.99, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6772205842602332, "mean_processing_ms": 0.16203063538860152, "mean_inference_ms": 0.7105297577207397}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 704, "num_steps_trained": 2832000, "num_steps_sampled": 355000, "sample_time_ms": 10.251, "replay_time_ms": 3.527, "grad_time_ms": 4.991, "update_time_ms": 4.726, "opt_peak_throughput": 6411.746, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.90830993652344, "min_q": -103.50114440917969, "max_q": -45.48794937133789, "mean_td_error": 4.288021564483643}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 355000, "episodes_total": 354, "training_iteration": 355, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-01", "timestamp": 1565083021, "time_this_iter_s": 6.441816806793213, "time_total_s": 2608.570839881897, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2608.570839881897, "timesteps_since_restore": 355000, "iterations_since_restore": 355}
{"episode_reward_max": -589.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1293.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6771155696457326, "mean_processing_ms": 0.16200696980996557, "mean_inference_ms": 0.7104146064978591}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 706, "num_steps_trained": 2840000, "num_steps_sampled": 356000, "sample_time_ms": 14.931, "replay_time_ms": 5.861, "grad_time_ms": 7.7, "update_time_ms": 7.095, "opt_peak_throughput": 4155.644, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.46558380126953, "min_q": -99.26254272460938, "max_q": -46.56159210205078, "mean_td_error": 1.8378491401672363}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 356000, "episodes_total": 355, "training_iteration": 356, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-08", "timestamp": 1565083028, "time_this_iter_s": 7.577113151550293, "time_total_s": 2616.1479530334473, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2616.1479530334473, "timesteps_since_restore": 356000, "iterations_since_restore": 356}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1295.42, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6770135767803321, "mean_processing_ms": 0.1619839878924483, "mean_inference_ms": 0.7103023094918577}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 708, "num_steps_trained": 2848000, "num_steps_sampled": 357000, "sample_time_ms": 12.284, "replay_time_ms": 4.031, "grad_time_ms": 5.756, "update_time_ms": 5.247, "opt_peak_throughput": 5559.581, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.48474884033203, "min_q": -101.24830627441406, "max_q": -46.989627838134766, "mean_td_error": 2.973158836364746}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 357000, "episodes_total": 356, "training_iteration": 357, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-16", "timestamp": 1565083036, "time_this_iter_s": 7.302551984786987, "time_total_s": 2623.4505050182343, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2623.4505050182343, "timesteps_since_restore": 357000, "iterations_since_restore": 357}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1283.96, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6769082410398828, "mean_processing_ms": 0.16196028614556557, "mean_inference_ms": 0.7101873302149684}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 710, "num_steps_trained": 2856000, "num_steps_sampled": 358000, "sample_time_ms": 11.508, "replay_time_ms": 3.868, "grad_time_ms": 6.231, "update_time_ms": 5.994, "opt_peak_throughput": 5135.417, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.14264678955078, "min_q": -114.18932342529297, "max_q": -47.675132751464844, "mean_td_error": 1.1772040128707886}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 358000, "episodes_total": 357, "training_iteration": 358, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-22", "timestamp": 1565083042, "time_this_iter_s": 6.468159198760986, "time_total_s": 2629.9186642169952, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2629.9186642169952, "timesteps_since_restore": 358000, "iterations_since_restore": 358}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1280.87, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.676799480152566, "mean_processing_ms": 0.16193583037243794, "mean_inference_ms": 0.7100695848496654}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 712, "num_steps_trained": 2864000, "num_steps_sampled": 359000, "sample_time_ms": 10.611, "replay_time_ms": 3.655, "grad_time_ms": 5.123, "update_time_ms": 4.754, "opt_peak_throughput": 6246.578, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -69.43840789794922, "min_q": -115.30297088623047, "max_q": -46.04541015625, "mean_td_error": 0.5290592908859253}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 359000, "episodes_total": 358, "training_iteration": 359, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-29", "timestamp": 1565083049, "time_this_iter_s": 6.482495546340942, "time_total_s": 2636.401159763336, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2636.401159763336, "timesteps_since_restore": 359000, "iterations_since_restore": 359}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1276.66, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6766927046365052, "mean_processing_ms": 0.16191185243293582, "mean_inference_ms": 0.7099535317496692}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 714, "num_steps_trained": 2872000, "num_steps_sampled": 360000, "sample_time_ms": 10.936, "replay_time_ms": 3.616, "grad_time_ms": 5.31, "update_time_ms": 4.804, "opt_peak_throughput": 6026.542, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.28189849853516, "min_q": -147.7200469970703, "max_q": -45.584964752197266, "mean_td_error": 4.151025772094727}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 360000, "episodes_total": 359, "training_iteration": 360, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-35", "timestamp": 1565083055, "time_this_iter_s": 6.613426208496094, "time_total_s": 2643.0145859718323, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2643.0145859718323, "timesteps_since_restore": 360000, "iterations_since_restore": 360}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1276.54, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6765693584729401, "mean_processing_ms": 0.16188411772202527, "mean_inference_ms": 0.7098160935520945}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 716, "num_steps_trained": 2880000, "num_steps_sampled": 361000, "sample_time_ms": 11.178, "replay_time_ms": 3.789, "grad_time_ms": 5.209, "update_time_ms": 5.117, "opt_peak_throughput": 6143.11, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -76.23533630371094, "min_q": -149.55413818359375, "max_q": -45.95643997192383, "mean_td_error": -1.534839391708374}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 361000, "episodes_total": 360, "training_iteration": 361, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-42", "timestamp": 1565083062, "time_this_iter_s": 6.63533616065979, "time_total_s": 2649.649922132492, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2649.649922132492, "timesteps_since_restore": 361000, "iterations_since_restore": 361}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1283.52, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6764382099555505, "mean_processing_ms": 0.16185469436968017, "mean_inference_ms": 0.7096690670580744}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 718, "num_steps_trained": 2888000, "num_steps_sampled": 362000, "sample_time_ms": 12.85, "replay_time_ms": 4.138, "grad_time_ms": 5.716, "update_time_ms": 5.393, "opt_peak_throughput": 5598.797, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.78653717041016, "min_q": -117.64457702636719, "max_q": -46.25442886352539, "mean_td_error": 2.13975191116333}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 362000, "episodes_total": 361, "training_iteration": 362, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-49", "timestamp": 1565083069, "time_this_iter_s": 6.541828155517578, "time_total_s": 2656.1917502880096, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2656.1917502880096, "timesteps_since_restore": 362000, "iterations_since_restore": 362}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1278.46, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6763094391871877, "mean_processing_ms": 0.16182598942443047, "mean_inference_ms": 0.7095246692531996}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 720, "num_steps_trained": 2896000, "num_steps_sampled": 363000, "sample_time_ms": 12.506, "replay_time_ms": 5.187, "grad_time_ms": 6.151, "update_time_ms": 5.807, "opt_peak_throughput": 5202.6, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.48773956298828, "min_q": -107.40262603759766, "max_q": -46.716705322265625, "mean_td_error": 2.2930779457092285}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 363000, "episodes_total": 362, "training_iteration": 363, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-17-56", "timestamp": 1565083076, "time_this_iter_s": 7.982371807098389, "time_total_s": 2664.174122095108, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2664.174122095108, "timesteps_since_restore": 363000, "iterations_since_restore": 363}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1281.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6761825909169713, "mean_processing_ms": 0.16179772794588526, "mean_inference_ms": 0.7093822717843911}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 722, "num_steps_trained": 2904000, "num_steps_sampled": 364000, "sample_time_ms": 10.526, "replay_time_ms": 3.835, "grad_time_ms": 5.432, "update_time_ms": 5.208, "opt_peak_throughput": 5891.523, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -69.9521484375, "min_q": -154.91464233398438, "max_q": -47.537296295166016, "mean_td_error": 1.816562294960022}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 364000, "episodes_total": 363, "training_iteration": 364, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-03", "timestamp": 1565083083, "time_this_iter_s": 6.694637775421143, "time_total_s": 2670.868759870529, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2670.868759870529, "timesteps_since_restore": 364000, "iterations_since_restore": 364}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1279.36, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6760575958238704, "mean_processing_ms": 0.1617699822629326, "mean_inference_ms": 0.7092417560886196}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 724, "num_steps_trained": 2912000, "num_steps_sampled": 365000, "sample_time_ms": 10.334, "replay_time_ms": 3.678, "grad_time_ms": 5.383, "update_time_ms": 5.39, "opt_peak_throughput": 5944.335, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.55793762207031, "min_q": -132.68838500976562, "max_q": -46.14155578613281, "mean_td_error": 1.2506399154663086}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 365000, "episodes_total": 364, "training_iteration": 365, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-10", "timestamp": 1565083090, "time_this_iter_s": 6.634790897369385, "time_total_s": 2677.5035507678986, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2677.5035507678986, "timesteps_since_restore": 365000, "iterations_since_restore": 365}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1277.55, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6759335347252879, "mean_processing_ms": 0.16174248170399536, "mean_inference_ms": 0.7091020604875327}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 726, "num_steps_trained": 2920000, "num_steps_sampled": 366000, "sample_time_ms": 11.551, "replay_time_ms": 4.897, "grad_time_ms": 6.157, "update_time_ms": 6.055, "opt_peak_throughput": 5197.403, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -81.91984558105469, "min_q": -136.88746643066406, "max_q": -46.304420471191406, "mean_td_error": -0.6987005472183228}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 366000, "episodes_total": 365, "training_iteration": 366, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-16", "timestamp": 1565083096, "time_this_iter_s": 6.5477375984191895, "time_total_s": 2684.0512883663177, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2684.0512883663177, "timesteps_since_restore": 366000, "iterations_since_restore": 366}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1273.32, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6758103817871844, "mean_processing_ms": 0.16171517787529532, "mean_inference_ms": 0.7089637332996013}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 728, "num_steps_trained": 2928000, "num_steps_sampled": 367000, "sample_time_ms": 12.189, "replay_time_ms": 4.0, "grad_time_ms": 5.52, "update_time_ms": 5.317, "opt_peak_throughput": 5797.341, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -74.44606018066406, "min_q": -129.3910675048828, "max_q": -46.51178741455078, "mean_td_error": 4.127820014953613}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 367000, "episodes_total": 366, "training_iteration": 367, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-23", "timestamp": 1565083103, "time_this_iter_s": 6.469341278076172, "time_total_s": 2690.520629644394, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2690.520629644394, "timesteps_since_restore": 367000, "iterations_since_restore": 367}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1273.56, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.675688010989315, "mean_processing_ms": 0.16168811616443615, "mean_inference_ms": 0.7088266308565758}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 730, "num_steps_trained": 2936000, "num_steps_sampled": 368000, "sample_time_ms": 11.317, "replay_time_ms": 3.769, "grad_time_ms": 5.478, "update_time_ms": 5.326, "opt_peak_throughput": 5841.395, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.54876708984375, "min_q": -144.55474853515625, "max_q": -45.995994567871094, "mean_td_error": 4.3270978927612305}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 368000, "episodes_total": 367, "training_iteration": 368, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-29", "timestamp": 1565083109, "time_this_iter_s": 6.45798397064209, "time_total_s": 2696.978613615036, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2696.978613615036, "timesteps_since_restore": 368000, "iterations_since_restore": 368}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1269.38, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6755672858216082, "mean_processing_ms": 0.16166147395156677, "mean_inference_ms": 0.7086916116480135}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 732, "num_steps_trained": 2944000, "num_steps_sampled": 369000, "sample_time_ms": 10.625, "replay_time_ms": 3.748, "grad_time_ms": 5.348, "update_time_ms": 4.997, "opt_peak_throughput": 5983.582, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.37216186523438, "min_q": -112.90974426269531, "max_q": -45.12481689453125, "mean_td_error": 0.7232183218002319}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 369000, "episodes_total": 368, "training_iteration": 369, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-36", "timestamp": 1565083116, "time_this_iter_s": 6.592853784561157, "time_total_s": 2703.571467399597, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2703.571467399597, "timesteps_since_restore": 369000, "iterations_since_restore": 369}
{"episode_reward_max": -600.0, "episode_reward_min": -3376.0, "episode_reward_mean": -1265.7, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6754476736248212, "mean_processing_ms": 0.16163516915043957, "mean_inference_ms": 0.7085578078682437}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 734, "num_steps_trained": 2952000, "num_steps_sampled": 370000, "sample_time_ms": 11.29, "replay_time_ms": 3.496, "grad_time_ms": 5.031, "update_time_ms": 4.745, "opt_peak_throughput": 6360.547, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.1395263671875, "min_q": -134.3050079345703, "max_q": -44.979122161865234, "mean_td_error": 1.3666410446166992}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 370000, "episodes_total": 369, "training_iteration": 370, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-43", "timestamp": 1565083123, "time_this_iter_s": 6.658513307571411, "time_total_s": 2710.2299807071686, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2710.2299807071686, "timesteps_since_restore": 370000, "iterations_since_restore": 370}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1242.96, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6753264947585264, "mean_processing_ms": 0.16160865077902922, "mean_inference_ms": 0.7084231900507924}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 736, "num_steps_trained": 2960000, "num_steps_sampled": 371000, "sample_time_ms": 11.728, "replay_time_ms": 4.025, "grad_time_ms": 5.703, "update_time_ms": 5.301, "opt_peak_throughput": 5611.555, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -80.49237060546875, "min_q": -139.6063995361328, "max_q": -45.64778137207031, "mean_td_error": -0.6884183883666992}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 371000, "episodes_total": 370, "training_iteration": 371, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-49", "timestamp": 1565083129, "time_this_iter_s": 6.650787830352783, "time_total_s": 2716.8807685375214, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2716.8807685375214, "timesteps_since_restore": 371000, "iterations_since_restore": 371}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1242.29, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.675202959591861, "mean_processing_ms": 0.16158152703107717, "mean_inference_ms": 0.7082865438634787}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 738, "num_steps_trained": 2968000, "num_steps_sampled": 372000, "sample_time_ms": 12.604, "replay_time_ms": 4.429, "grad_time_ms": 5.758, "update_time_ms": 6.216, "opt_peak_throughput": 5557.739, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.71946716308594, "min_q": -125.93818664550781, "max_q": -47.66587829589844, "mean_td_error": 0.2993340492248535}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 372000, "episodes_total": 371, "training_iteration": 372, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-18-56", "timestamp": 1565083136, "time_this_iter_s": 6.518539905548096, "time_total_s": 2723.3993084430695, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2723.3993084430695, "timesteps_since_restore": 372000, "iterations_since_restore": 372}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1240.7, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.675080243487772, "mean_processing_ms": 0.1615546639314385, "mean_inference_ms": 0.7081511023447301}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 740, "num_steps_trained": 2976000, "num_steps_sampled": 373000, "sample_time_ms": 13.121, "replay_time_ms": 4.248, "grad_time_ms": 5.788, "update_time_ms": 5.7, "opt_peak_throughput": 5528.847, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -74.9029769897461, "min_q": -144.57855224609375, "max_q": -48.461849212646484, "mean_td_error": 1.5891644954681396}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 373000, "episodes_total": 372, "training_iteration": 373, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-02", "timestamp": 1565083142, "time_this_iter_s": 6.498511552810669, "time_total_s": 2729.89781999588, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2729.89781999588, "timesteps_since_restore": 373000, "iterations_since_restore": 373}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1236.54, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6749584071636363, "mean_processing_ms": 0.16152802556993598, "mean_inference_ms": 0.70801700780166}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 742, "num_steps_trained": 2984000, "num_steps_sampled": 374000, "sample_time_ms": 10.443, "replay_time_ms": 3.53, "grad_time_ms": 5.657, "update_time_ms": 4.998, "opt_peak_throughput": 5656.298, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -82.46714782714844, "min_q": -153.65818786621094, "max_q": -46.89686584472656, "mean_td_error": 0.8545842170715332}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 374000, "episodes_total": 373, "training_iteration": 374, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-09", "timestamp": 1565083149, "time_this_iter_s": 6.5466248989105225, "time_total_s": 2736.4444448947906, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2736.4444448947906, "timesteps_since_restore": 374000, "iterations_since_restore": 374}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1237.79, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.674838121118386, "mean_processing_ms": 0.1615016672425484, "mean_inference_ms": 0.7078844303798353}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 744, "num_steps_trained": 2992000, "num_steps_sampled": 375000, "sample_time_ms": 10.261, "replay_time_ms": 3.559, "grad_time_ms": 5.06, "update_time_ms": 4.835, "opt_peak_throughput": 6323.866, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.35924530029297, "min_q": -133.1500701904297, "max_q": -47.224708557128906, "mean_td_error": -2.6308753490448}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 375000, "episodes_total": 374, "training_iteration": 375, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-15", "timestamp": 1565083155, "time_this_iter_s": 6.633509159088135, "time_total_s": 2743.077954053879, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2743.077954053879, "timesteps_since_restore": 375000, "iterations_since_restore": 375}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1234.09, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6747184273294531, "mean_processing_ms": 0.16147554882293594, "mean_inference_ms": 0.7077529376582403}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 746, "num_steps_trained": 3000000, "num_steps_sampled": 376000, "sample_time_ms": 10.76, "replay_time_ms": 4.305, "grad_time_ms": 6.028, "update_time_ms": 5.17, "opt_peak_throughput": 5308.616, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.04664611816406, "min_q": -138.05091857910156, "max_q": -48.066917419433594, "mean_td_error": -2.1663222312927246}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 376000, "episodes_total": 375, "training_iteration": 376, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-22", "timestamp": 1565083162, "time_this_iter_s": 6.6738598346710205, "time_total_s": 2749.75181388855, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2749.75181388855, "timesteps_since_restore": 376000, "iterations_since_restore": 376}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1234.27, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6745947524214011, "mean_processing_ms": 0.16144851304438138, "mean_inference_ms": 0.7076182007100073}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 748, "num_steps_trained": 3008000, "num_steps_sampled": 377000, "sample_time_ms": 12.694, "replay_time_ms": 4.607, "grad_time_ms": 5.823, "update_time_ms": 5.777, "opt_peak_throughput": 5495.749, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.92263793945312, "min_q": -123.22954559326172, "max_q": -48.13969039916992, "mean_td_error": 2.6195640563964844}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 377000, "episodes_total": 376, "training_iteration": 377, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-29", "timestamp": 1565083169, "time_this_iter_s": 6.562665224075317, "time_total_s": 2756.314479112625, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2756.314479112625, "timesteps_since_restore": 377000, "iterations_since_restore": 377}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1238.85, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6744720960800312, "mean_processing_ms": 0.16142171660636304, "mean_inference_ms": 0.707484342412183}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 750, "num_steps_trained": 3016000, "num_steps_sampled": 378000, "sample_time_ms": 11.044, "replay_time_ms": 4.593, "grad_time_ms": 6.543, "update_time_ms": 5.826, "opt_peak_throughput": 4890.978, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.69990539550781, "min_q": -119.83525848388672, "max_q": -47.213924407958984, "mean_td_error": 4.596242427825928}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 378000, "episodes_total": 377, "training_iteration": 378, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-35", "timestamp": 1565083175, "time_this_iter_s": 6.4781224727630615, "time_total_s": 2762.792601585388, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2762.792601585388, "timesteps_since_restore": 378000, "iterations_since_restore": 378}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1235.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6743482394131999, "mean_processing_ms": 0.16139473077289423, "mean_inference_ms": 0.7073497544421311}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 751, "num_steps_trained": 3024000, "num_steps_sampled": 379000, "sample_time_ms": 12.251, "replay_time_ms": 4.728, "grad_time_ms": 5.958, "update_time_ms": 5.417, "opt_peak_throughput": 5370.965, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.23233032226562, "min_q": -123.96295928955078, "max_q": -47.1077995300293, "mean_td_error": 2.0739195346832275}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 379000, "episodes_total": 378, "training_iteration": 379, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-42", "timestamp": 1565083182, "time_this_iter_s": 6.552219867706299, "time_total_s": 2769.3448214530945, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2769.3448214530945, "timesteps_since_restore": 379000, "iterations_since_restore": 379}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1231.17, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6742213453713533, "mean_processing_ms": 0.16136703725523138, "mean_inference_ms": 0.7072126915196715}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 753, "num_steps_trained": 3032000, "num_steps_sampled": 380000, "sample_time_ms": 11.606, "replay_time_ms": 3.663, "grad_time_ms": 5.085, "update_time_ms": 4.742, "opt_peak_throughput": 6293.177, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.01821517944336, "min_q": -105.84918975830078, "max_q": -47.94581604003906, "mean_td_error": 1.5854029655456543}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 380000, "episodes_total": 379, "training_iteration": 380, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-48", "timestamp": 1565083188, "time_this_iter_s": 6.602932453155518, "time_total_s": 2775.94775390625, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2775.94775390625, "timesteps_since_restore": 380000, "iterations_since_restore": 380}
{"episode_reward_max": -600.0, "episode_reward_min": -1994.0, "episode_reward_mean": -1229.07, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6740977257515895, "mean_processing_ms": 0.16134011210143537, "mean_inference_ms": 0.7070785142274716}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 755, "num_steps_trained": 3040000, "num_steps_sampled": 381000, "sample_time_ms": 15.397, "replay_time_ms": 5.867, "grad_time_ms": 7.06, "update_time_ms": 7.543, "opt_peak_throughput": 4532.759, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.27743530273438, "min_q": -121.3786849975586, "max_q": -47.51437759399414, "mean_td_error": -1.756643533706665}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 381000, "episodes_total": 380, "training_iteration": 381, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-19-56", "timestamp": 1565083196, "time_this_iter_s": 7.296948432922363, "time_total_s": 2783.2447023391724, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2783.2447023391724, "timesteps_since_restore": 381000, "iterations_since_restore": 381}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1253.01, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6739746373741521, "mean_processing_ms": 0.161313262031401, "mean_inference_ms": 0.7069446773822473}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 757, "num_steps_trained": 3048000, "num_steps_sampled": 382000, "sample_time_ms": 12.583, "replay_time_ms": 3.963, "grad_time_ms": 5.377, "update_time_ms": 5.4, "opt_peak_throughput": 5951.768, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.11613464355469, "min_q": -127.8590316772461, "max_q": -47.28921127319336, "mean_td_error": -0.7074443101882935}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 382000, "episodes_total": 381, "training_iteration": 382, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-03", "timestamp": 1565083203, "time_this_iter_s": 7.518855094909668, "time_total_s": 2790.763557434082, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2790.763557434082, "timesteps_since_restore": 382000, "iterations_since_restore": 382}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1249.05, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6738500596519877, "mean_processing_ms": 0.161286025138092, "mean_inference_ms": 0.706809389949617}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 759, "num_steps_trained": 3056000, "num_steps_sampled": 383000, "sample_time_ms": 11.42, "replay_time_ms": 4.361, "grad_time_ms": 5.529, "update_time_ms": 5.032, "opt_peak_throughput": 5787.467, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.33686828613281, "min_q": -132.77175903320312, "max_q": -46.91109848022461, "mean_td_error": 5.4463701248168945}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 383000, "episodes_total": 382, "training_iteration": 383, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-10", "timestamp": 1565083210, "time_this_iter_s": 6.394604444503784, "time_total_s": 2797.158161878586, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2797.158161878586, "timesteps_since_restore": 383000, "iterations_since_restore": 383}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1240.79, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6737242528062365, "mean_processing_ms": 0.16125856134867633, "mean_inference_ms": 0.706673240321021}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 761, "num_steps_trained": 3064000, "num_steps_sampled": 384000, "sample_time_ms": 11.953, "replay_time_ms": 3.391, "grad_time_ms": 5.048, "update_time_ms": 4.821, "opt_peak_throughput": 6339.458, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.96349334716797, "min_q": -166.3293914794922, "max_q": -47.24736022949219, "mean_td_error": 3.3887972831726074}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 384000, "episodes_total": 383, "training_iteration": 384, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-16", "timestamp": 1565083216, "time_this_iter_s": 6.599412679672241, "time_total_s": 2803.757574558258, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2803.757574558258, "timesteps_since_restore": 384000, "iterations_since_restore": 384}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1239.44, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6735996317963554, "mean_processing_ms": 0.1612314415335447, "mean_inference_ms": 0.7065388831387166}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 763, "num_steps_trained": 3072000, "num_steps_sampled": 385000, "sample_time_ms": 10.977, "replay_time_ms": 3.858, "grad_time_ms": 5.632, "update_time_ms": 5.077, "opt_peak_throughput": 5681.919, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.29193115234375, "min_q": -121.76008605957031, "max_q": -47.51716613769531, "mean_td_error": 2.459364414215088}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 385000, "episodes_total": 384, "training_iteration": 385, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-23", "timestamp": 1565083223, "time_this_iter_s": 6.546251058578491, "time_total_s": 2810.3038256168365, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2810.3038256168365, "timesteps_since_restore": 385000, "iterations_since_restore": 385}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1232.12, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6734761999812858, "mean_processing_ms": 0.161204649152913, "mean_inference_ms": 0.7064058445415254}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 765, "num_steps_trained": 3080000, "num_steps_sampled": 386000, "sample_time_ms": 11.253, "replay_time_ms": 4.162, "grad_time_ms": 5.772, "update_time_ms": 5.353, "opt_peak_throughput": 5544.354, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.32211303710938, "min_q": -123.94831848144531, "max_q": -47.290836334228516, "mean_td_error": -2.9251914024353027}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 386000, "episodes_total": 385, "training_iteration": 386, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-29", "timestamp": 1565083229, "time_this_iter_s": 6.583834648132324, "time_total_s": 2816.887660264969, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2816.887660264969, "timesteps_since_restore": 386000, "iterations_since_restore": 386}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1230.64, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.673353710748067, "mean_processing_ms": 0.16117814775932435, "mean_inference_ms": 0.7062739045381207}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 767, "num_steps_trained": 3088000, "num_steps_sampled": 387000, "sample_time_ms": 12.216, "replay_time_ms": 4.094, "grad_time_ms": 5.666, "update_time_ms": 5.169, "opt_peak_throughput": 5647.326, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -69.81807708740234, "min_q": -122.25670623779297, "max_q": -47.659019470214844, "mean_td_error": -2.796731472015381}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 387000, "episodes_total": 386, "training_iteration": 387, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-36", "timestamp": 1565083236, "time_this_iter_s": 6.4857025146484375, "time_total_s": 2823.3733627796173, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2823.3733627796173, "timesteps_since_restore": 387000, "iterations_since_restore": 387}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1222.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6732316475370368, "mean_processing_ms": 0.16115176416882546, "mean_inference_ms": 0.70614266365402}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 769, "num_steps_trained": 3096000, "num_steps_sampled": 388000, "sample_time_ms": 11.504, "replay_time_ms": 4.123, "grad_time_ms": 5.477, "update_time_ms": 5.096, "opt_peak_throughput": 5842.208, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.40122985839844, "min_q": -111.69439697265625, "max_q": -47.53004455566406, "mean_td_error": 2.428697109222412}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 388000, "episodes_total": 387, "training_iteration": 388, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-42", "timestamp": 1565083242, "time_this_iter_s": 6.491014003753662, "time_total_s": 2829.864376783371, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2829.864376783371, "timesteps_since_restore": 388000, "iterations_since_restore": 388}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1224.98, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.673110947370927, "mean_processing_ms": 0.16112562418859955, "mean_inference_ms": 0.7060126091086163}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 771, "num_steps_trained": 3104000, "num_steps_sampled": 389000, "sample_time_ms": 11.312, "replay_time_ms": 3.516, "grad_time_ms": 5.143, "update_time_ms": 4.859, "opt_peak_throughput": 6221.474, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -69.59666442871094, "min_q": -118.2380142211914, "max_q": -49.647647857666016, "mean_td_error": 1.3583855628967285}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 389000, "episodes_total": 388, "training_iteration": 389, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-49", "timestamp": 1565083249, "time_this_iter_s": 6.484267711639404, "time_total_s": 2836.3486444950104, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2836.3486444950104, "timesteps_since_restore": 389000, "iterations_since_restore": 389}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1225.56, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6729919184853463, "mean_processing_ms": 0.16109987552322366, "mean_inference_ms": 0.7058843539687762}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 773, "num_steps_trained": 3112000, "num_steps_sampled": 390000, "sample_time_ms": 10.715, "replay_time_ms": 4.104, "grad_time_ms": 5.36, "update_time_ms": 5.16, "opt_peak_throughput": 5970.646, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.6878433227539, "min_q": -112.4952163696289, "max_q": -50.296974182128906, "mean_td_error": 1.66889226436615}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 390000, "episodes_total": 389, "training_iteration": 390, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-20-55", "timestamp": 1565083255, "time_this_iter_s": 6.635280132293701, "time_total_s": 2842.983924627304, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2842.983924627304, "timesteps_since_restore": 390000, "iterations_since_restore": 390}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1226.34, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6728746979474859, "mean_processing_ms": 0.16107458073767547, "mean_inference_ms": 0.7057578921895655}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 775, "num_steps_trained": 3120000, "num_steps_sampled": 391000, "sample_time_ms": 11.306, "replay_time_ms": 4.248, "grad_time_ms": 5.856, "update_time_ms": 5.617, "opt_peak_throughput": 5464.335, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.39303588867188, "min_q": -125.38774108886719, "max_q": -49.51746368408203, "mean_td_error": -2.8340649604797363}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 391000, "episodes_total": 390, "training_iteration": 391, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-02", "timestamp": 1565083262, "time_this_iter_s": 6.715193033218384, "time_total_s": 2849.6991176605225, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2849.6991176605225, "timesteps_since_restore": 391000, "iterations_since_restore": 391}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1224.05, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6727578558442876, "mean_processing_ms": 0.16104930042403834, "mean_inference_ms": 0.7056319584704762}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 777, "num_steps_trained": 3128000, "num_steps_sampled": 392000, "sample_time_ms": 11.453, "replay_time_ms": 4.733, "grad_time_ms": 6.369, "update_time_ms": 6.013, "opt_peak_throughput": 5024.435, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.37776184082031, "min_q": -141.54881286621094, "max_q": -48.92245101928711, "mean_td_error": 2.4486937522888184}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 392000, "episodes_total": 391, "training_iteration": 392, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-09", "timestamp": 1565083269, "time_this_iter_s": 6.546540260314941, "time_total_s": 2856.2456579208374, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2856.2456579208374, "timesteps_since_restore": 392000, "iterations_since_restore": 392}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1221.16, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6726335587104357, "mean_processing_ms": 0.16102215074364296, "mean_inference_ms": 0.7054974937416838}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 779, "num_steps_trained": 3136000, "num_steps_sampled": 393000, "sample_time_ms": 11.504, "replay_time_ms": 4.165, "grad_time_ms": 5.668, "update_time_ms": 5.618, "opt_peak_throughput": 5645.971, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -79.41217041015625, "min_q": -381.4417724609375, "max_q": -47.877891540527344, "mean_td_error": -8.484036445617676}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 393000, "episodes_total": 392, "training_iteration": 393, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-15", "timestamp": 1565083275, "time_this_iter_s": 6.481656312942505, "time_total_s": 2862.72731423378, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2862.72731423378, "timesteps_since_restore": 393000, "iterations_since_restore": 393}
{"episode_reward_max": -600.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1218.61, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6725071124861856, "mean_processing_ms": 0.16099450654037636, "mean_inference_ms": 0.70536060969055}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 781, "num_steps_trained": 3144000, "num_steps_sampled": 394000, "sample_time_ms": 11.416, "replay_time_ms": 3.863, "grad_time_ms": 5.357, "update_time_ms": 5.346, "opt_peak_throughput": 5974.021, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -60.86051559448242, "min_q": -112.126220703125, "max_q": -47.968990325927734, "mean_td_error": 2.2901973724365234}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 394000, "episodes_total": 393, "training_iteration": 394, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-22", "timestamp": 1565083282, "time_this_iter_s": 6.497334241867065, "time_total_s": 2869.224648475647, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2869.224648475647, "timesteps_since_restore": 394000, "iterations_since_restore": 394}
{"episode_reward_max": -669.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1224.13, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6723805498018816, "mean_processing_ms": 0.16096656104037138, "mean_inference_ms": 0.705221767372073}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 783, "num_steps_trained": 3152000, "num_steps_sampled": 395000, "sample_time_ms": 10.529, "replay_time_ms": 3.966, "grad_time_ms": 5.427, "update_time_ms": 5.345, "opt_peak_throughput": 5896.233, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.35884857177734, "min_q": -122.52548217773438, "max_q": -48.06973648071289, "mean_td_error": 0.6632852554321289}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 395000, "episodes_total": 394, "training_iteration": 395, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-28", "timestamp": 1565083288, "time_this_iter_s": 6.597622394561768, "time_total_s": 2875.8222708702087, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2875.8222708702087, "timesteps_since_restore": 395000, "iterations_since_restore": 395}
{"episode_reward_max": -669.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1227.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6722511354637182, "mean_processing_ms": 0.1609378587271241, "mean_inference_ms": 0.7050794606083319}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 785, "num_steps_trained": 3160000, "num_steps_sampled": 396000, "sample_time_ms": 14.263, "replay_time_ms": 5.646, "grad_time_ms": 8.069, "update_time_ms": 6.76, "opt_peak_throughput": 3966.022, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.26486206054688, "min_q": -112.73298645019531, "max_q": -48.24814224243164, "mean_td_error": 0.01828444004058838}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 396000, "episodes_total": 395, "training_iteration": 396, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-36", "timestamp": 1565083296, "time_this_iter_s": 7.2787744998931885, "time_total_s": 2883.101045370102, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2883.101045370102, "timesteps_since_restore": 396000, "iterations_since_restore": 396}
{"episode_reward_max": -669.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1226.89, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6721228869761177, "mean_processing_ms": 0.16090931315101092, "mean_inference_ms": 0.7049375110064428}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 787, "num_steps_trained": 3168000, "num_steps_sampled": 397000, "sample_time_ms": 11.442, "replay_time_ms": 4.575, "grad_time_ms": 6.151, "update_time_ms": 5.773, "opt_peak_throughput": 5202.379, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.34550476074219, "min_q": -131.99168395996094, "max_q": -47.39258575439453, "mean_td_error": 2.724982261657715}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 397000, "episodes_total": 396, "training_iteration": 397, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-43", "timestamp": 1565083303, "time_this_iter_s": 7.5905070304870605, "time_total_s": 2890.691552400589, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2890.691552400589, "timesteps_since_restore": 397000, "iterations_since_restore": 397}
{"episode_reward_max": -669.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1223.86, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6719931347179832, "mean_processing_ms": 0.16088040710225623, "mean_inference_ms": 0.704794657505869}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 789, "num_steps_trained": 3176000, "num_steps_sampled": 398000, "sample_time_ms": 13.912, "replay_time_ms": 4.837, "grad_time_ms": 5.761, "update_time_ms": 5.251, "opt_peak_throughput": 5554.312, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -86.52449035644531, "min_q": -419.62042236328125, "max_q": -46.94844055175781, "mean_td_error": -2.4409537315368652}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 398000, "episodes_total": 397, "training_iteration": 398, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-50", "timestamp": 1565083310, "time_this_iter_s": 6.549091100692749, "time_total_s": 2897.2406435012817, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2897.2406435012817, "timesteps_since_restore": 398000, "iterations_since_restore": 398}
{"episode_reward_max": -669.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1222.18, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6718663933257648, "mean_processing_ms": 0.16085228636403331, "mean_inference_ms": 0.7046553871621617}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 791, "num_steps_trained": 3184000, "num_steps_sampled": 399000, "sample_time_ms": 14.242, "replay_time_ms": 4.874, "grad_time_ms": 6.217, "update_time_ms": 5.967, "opt_peak_throughput": 5147.037, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -70.59742736816406, "min_q": -184.16197204589844, "max_q": -46.71366500854492, "mean_td_error": 3.2349801063537598}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 399000, "episodes_total": 398, "training_iteration": 399, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-21-59", "timestamp": 1565083319, "time_this_iter_s": 9.199259519577026, "time_total_s": 2906.4399030208588, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2906.4399030208588, "timesteps_since_restore": 399000, "iterations_since_restore": 399}
{"episode_reward_max": -711.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1223.36, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6717396469874941, "mean_processing_ms": 0.1608241392628096, "mean_inference_ms": 0.7045159858405684}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 793, "num_steps_trained": 3192000, "num_steps_sampled": 400000, "sample_time_ms": 10.492, "replay_time_ms": 3.756, "grad_time_ms": 5.336, "update_time_ms": 4.701, "opt_peak_throughput": 5997.432, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -78.2323226928711, "min_q": -289.53839111328125, "max_q": -46.716148376464844, "mean_td_error": 3.982564926147461}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 400000, "episodes_total": 399, "training_iteration": 400, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-22-06", "timestamp": 1565083326, "time_this_iter_s": 7.211850166320801, "time_total_s": 2913.6517531871796, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2913.6517531871796, "timesteps_since_restore": 400000, "iterations_since_restore": 400}
{"episode_reward_max": -711.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1221.65, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6716138175316118, "mean_processing_ms": 0.16079623428300605, "mean_inference_ms": 0.7043791517689961}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 795, "num_steps_trained": 3200000, "num_steps_sampled": 401000, "sample_time_ms": 22.14, "replay_time_ms": 8.086, "grad_time_ms": 9.252, "update_time_ms": 9.457, "opt_peak_throughput": 3458.783, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -81.56784057617188, "min_q": -392.68994140625, "max_q": -46.69975662231445, "mean_td_error": -12.800241470336914}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 401000, "episodes_total": 400, "training_iteration": 401, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-22-14", "timestamp": 1565083334, "time_this_iter_s": 8.225267171859741, "time_total_s": 2921.8770203590393, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2921.8770203590393, "timesteps_since_restore": 401000, "iterations_since_restore": 401}
{"episode_reward_max": -711.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1227.69, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6714945690589311, "mean_processing_ms": 0.16076972316031235, "mean_inference_ms": 0.7042492694274586}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 797, "num_steps_trained": 3208000, "num_steps_sampled": 402000, "sample_time_ms": 12.611, "replay_time_ms": 4.468, "grad_time_ms": 5.655, "update_time_ms": 5.599, "opt_peak_throughput": 5658.969, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.45050048828125, "min_q": -109.61674499511719, "max_q": -46.4185905456543, "mean_td_error": 2.2053956985473633}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 402000, "episodes_total": 401, "training_iteration": 402, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-22-23", "timestamp": 1565083343, "time_this_iter_s": 8.594355821609497, "time_total_s": 2930.471376180649, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2930.471376180649, "timesteps_since_restore": 402000, "iterations_since_restore": 402}
{"episode_reward_max": -711.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1225.96, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6713779172679224, "mean_processing_ms": 0.16074393410404786, "mean_inference_ms": 0.7041224215919926}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 799, "num_steps_trained": 3216000, "num_steps_sampled": 403000, "sample_time_ms": 11.158, "replay_time_ms": 4.3, "grad_time_ms": 6.185, "update_time_ms": 5.559, "opt_peak_throughput": 5174.121, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -60.735076904296875, "min_q": -144.44793701171875, "max_q": -46.1978874206543, "mean_td_error": -0.489504337310791}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 403000, "episodes_total": 402, "training_iteration": 403, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-22-31", "timestamp": 1565083351, "time_this_iter_s": 7.535789489746094, "time_total_s": 2938.007165670395, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2938.007165670395, "timesteps_since_restore": 403000, "iterations_since_restore": 403}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1220.04, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6712644176732825, "mean_processing_ms": 0.16071901967719648, "mean_inference_ms": 0.703999008751294}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 801, "num_steps_trained": 3224000, "num_steps_sampled": 404000, "sample_time_ms": 13.894, "replay_time_ms": 4.313, "grad_time_ms": 5.587, "update_time_ms": 5.976, "opt_peak_throughput": 5728.041, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.4444580078125, "min_q": -119.226806640625, "max_q": -46.76298522949219, "mean_td_error": 1.11002779006958}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 404000, "episodes_total": 403, "training_iteration": 404, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-22-38", "timestamp": 1565083358, "time_this_iter_s": 7.4038684368133545, "time_total_s": 2945.4110341072083, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2945.4110341072083, "timesteps_since_restore": 404000, "iterations_since_restore": 404}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1220.88, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.671149867627764, "mean_processing_ms": 0.16069385346824425, "mean_inference_ms": 0.7038748030921859}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 803, "num_steps_trained": 3232000, "num_steps_sampled": 405000, "sample_time_ms": 12.805, "replay_time_ms": 5.367, "grad_time_ms": 7.444, "update_time_ms": 6.612, "opt_peak_throughput": 4298.654, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -76.66683959960938, "min_q": -157.68739318847656, "max_q": -47.010677337646484, "mean_td_error": 0.7467159032821655}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 405000, "episodes_total": 404, "training_iteration": 405, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-22-45", "timestamp": 1565083365, "time_this_iter_s": 7.413358926773071, "time_total_s": 2952.8243930339813, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2952.8243930339813, "timesteps_since_restore": 405000, "iterations_since_restore": 405}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1217.01, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6710358516950766, "mean_processing_ms": 0.16066887221932385, "mean_inference_ms": 0.7037514614882241}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 805, "num_steps_trained": 3240000, "num_steps_sampled": 406000, "sample_time_ms": 13.445, "replay_time_ms": 5.101, "grad_time_ms": 6.488, "update_time_ms": 6.469, "opt_peak_throughput": 4931.81, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.56436157226562, "min_q": -303.43072509765625, "max_q": -46.044097900390625, "mean_td_error": 4.517175674438477}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 406000, "episodes_total": 405, "training_iteration": 406, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-22-53", "timestamp": 1565083373, "time_this_iter_s": 7.5017805099487305, "time_total_s": 2960.32617354393, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2960.32617354393, "timesteps_since_restore": 406000, "iterations_since_restore": 406}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1217.9, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6709237324911423, "mean_processing_ms": 0.1606443425390192, "mean_inference_ms": 0.7036299507534132}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 807, "num_steps_trained": 3248000, "num_steps_sampled": 407000, "sample_time_ms": 12.295, "replay_time_ms": 3.782, "grad_time_ms": 5.574, "update_time_ms": 5.398, "opt_peak_throughput": 5740.903, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.1103515625, "min_q": -126.46570587158203, "max_q": -47.08233642578125, "mean_td_error": -0.7215629816055298}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 407000, "episodes_total": 406, "training_iteration": 407, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-00", "timestamp": 1565083380, "time_this_iter_s": 6.99796986579895, "time_total_s": 2967.324143409729, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2967.324143409729, "timesteps_since_restore": 407000, "iterations_since_restore": 407}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1222.3, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6708150852145726, "mean_processing_ms": 0.1606204924623498, "mean_inference_ms": 0.703511833628957}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 809, "num_steps_trained": 3256000, "num_steps_sampled": 408000, "sample_time_ms": 14.935, "replay_time_ms": 5.513, "grad_time_ms": 7.274, "update_time_ms": 7.304, "opt_peak_throughput": 4398.951, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.65408325195312, "min_q": -172.9767608642578, "max_q": -45.60551834106445, "mean_td_error": 5.222060203552246}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 408000, "episodes_total": 407, "training_iteration": 408, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-07", "timestamp": 1565083387, "time_this_iter_s": 7.4352476596832275, "time_total_s": 2974.7593910694122, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2974.7593910694122, "timesteps_since_restore": 408000, "iterations_since_restore": 408}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1226.53, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6707103189491689, "mean_processing_ms": 0.16059758111800007, "mean_inference_ms": 0.7033975944575654}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 811, "num_steps_trained": 3264000, "num_steps_sampled": 409000, "sample_time_ms": 11.866, "replay_time_ms": 4.819, "grad_time_ms": 5.943, "update_time_ms": 5.574, "opt_peak_throughput": 5384.54, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.862152099609375, "min_q": -107.31512451171875, "max_q": -45.459110260009766, "mean_td_error": 2.374938488006592}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 409000, "episodes_total": 408, "training_iteration": 409, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-15", "timestamp": 1565083395, "time_this_iter_s": 7.887710094451904, "time_total_s": 2982.647101163864, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2982.647101163864, "timesteps_since_restore": 409000, "iterations_since_restore": 409}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1223.73, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6706063753640349, "mean_processing_ms": 0.16057480027825843, "mean_inference_ms": 0.7032842592324198}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 813, "num_steps_trained": 3272000, "num_steps_sampled": 410000, "sample_time_ms": 12.468, "replay_time_ms": 4.249, "grad_time_ms": 6.232, "update_time_ms": 5.669, "opt_peak_throughput": 5134.671, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -70.81637573242188, "min_q": -166.13143920898438, "max_q": -45.6104621887207, "mean_td_error": 0.01964545249938965}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 410000, "episodes_total": 409, "training_iteration": 410, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-22", "timestamp": 1565083402, "time_this_iter_s": 6.756500959396362, "time_total_s": 2989.4036021232605, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2989.4036021232605, "timesteps_since_restore": 410000, "iterations_since_restore": 410}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1221.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6705038175702417, "mean_processing_ms": 0.16055234376131108, "mean_inference_ms": 0.7031726978399037}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 815, "num_steps_trained": 3280000, "num_steps_sampled": 411000, "sample_time_ms": 10.974, "replay_time_ms": 3.9, "grad_time_ms": 5.836, "update_time_ms": 5.552, "opt_peak_throughput": 5483.534, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -60.54719161987305, "min_q": -128.8037872314453, "max_q": -45.05659103393555, "mean_td_error": 4.294070720672607}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 411000, "episodes_total": 410, "training_iteration": 411, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-29", "timestamp": 1565083409, "time_this_iter_s": 6.823265790939331, "time_total_s": 2996.2268679142, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2996.2268679142, "timesteps_since_restore": 411000, "iterations_since_restore": 411}
{"episode_reward_max": -672.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1219.99, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6704025690580545, "mean_processing_ms": 0.16053018179039552, "mean_inference_ms": 0.7030626260713396}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 817, "num_steps_trained": 3288000, "num_steps_sampled": 412000, "sample_time_ms": 11.887, "replay_time_ms": 3.918, "grad_time_ms": 5.668, "update_time_ms": 5.959, "opt_peak_throughput": 5646.043, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.90145874023438, "min_q": -142.41726684570312, "max_q": -44.565982818603516, "mean_td_error": 1.1813896894454956}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 412000, "episodes_total": 411, "training_iteration": 412, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-36", "timestamp": 1565083416, "time_this_iter_s": 6.880367994308472, "time_total_s": 3003.1072359085083, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3003.1072359085083, "timesteps_since_restore": 412000, "iterations_since_restore": 412}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1213.58, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.670302493957445, "mean_processing_ms": 0.1605084175206984, "mean_inference_ms": 0.7029542253065331}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 819, "num_steps_trained": 3296000, "num_steps_sampled": 413000, "sample_time_ms": 10.943, "replay_time_ms": 3.785, "grad_time_ms": 5.516, "update_time_ms": 5.471, "opt_peak_throughput": 5800.849, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.809452056884766, "min_q": -133.6241912841797, "max_q": -45.59257507324219, "mean_td_error": 1.4505592584609985}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 413000, "episodes_total": 412, "training_iteration": 413, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-43", "timestamp": 1565083423, "time_this_iter_s": 6.852993011474609, "time_total_s": 3009.960228919983, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3009.960228919983, "timesteps_since_restore": 413000, "iterations_since_restore": 413}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1204.29, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6701990719221708, "mean_processing_ms": 0.16048592403303563, "mean_inference_ms": 0.7028433720691426}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 821, "num_steps_trained": 3304000, "num_steps_sampled": 414000, "sample_time_ms": 11.102, "replay_time_ms": 4.012, "grad_time_ms": 5.905, "update_time_ms": 5.476, "opt_peak_throughput": 5418.844, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.27115631103516, "min_q": -155.97882080078125, "max_q": -45.36168670654297, "mean_td_error": 1.6144356727600098}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 414000, "episodes_total": 413, "training_iteration": 414, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-50", "timestamp": 1565083430, "time_this_iter_s": 6.868043899536133, "time_total_s": 3016.828272819519, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3016.828272819519, "timesteps_since_restore": 414000, "iterations_since_restore": 414}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1200.94, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6700946833486586, "mean_processing_ms": 0.16046320472449352, "mean_inference_ms": 0.70273208543261}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 823, "num_steps_trained": 3312000, "num_steps_sampled": 415000, "sample_time_ms": 12.373, "replay_time_ms": 4.312, "grad_time_ms": 5.67, "update_time_ms": 5.57, "opt_peak_throughput": 5643.526, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.90824127197266, "min_q": -119.50521087646484, "max_q": -45.779170989990234, "mean_td_error": 4.1329121589660645}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 415000, "episodes_total": 414, "training_iteration": 415, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-23-56", "timestamp": 1565083436, "time_this_iter_s": 6.7471160888671875, "time_total_s": 3023.5753889083862, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3023.5753889083862, "timesteps_since_restore": 415000, "iterations_since_restore": 415}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1197.6, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6699952748566526, "mean_processing_ms": 0.16044174706020717, "mean_inference_ms": 0.7026256308167753}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 825, "num_steps_trained": 3320000, "num_steps_sampled": 416000, "sample_time_ms": 13.617, "replay_time_ms": 4.437, "grad_time_ms": 6.301, "update_time_ms": 5.854, "opt_peak_throughput": 5078.849, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.880516052246094, "min_q": -98.25689697265625, "max_q": -44.81951904296875, "mean_td_error": 0.3280622959136963}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 416000, "episodes_total": 415, "training_iteration": 416, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-24-04", "timestamp": 1565083444, "time_this_iter_s": 8.199778318405151, "time_total_s": 3031.7751672267914, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3031.7751672267914, "timesteps_since_restore": 416000, "iterations_since_restore": 416}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1199.96, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6698976369413333, "mean_processing_ms": 0.16042063688740607, "mean_inference_ms": 0.7025207755163849}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 827, "num_steps_trained": 3328000, "num_steps_sampled": 417000, "sample_time_ms": 10.52, "replay_time_ms": 4.106, "grad_time_ms": 5.687, "update_time_ms": 5.705, "opt_peak_throughput": 5626.823, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -61.62794494628906, "min_q": -126.42028045654297, "max_q": -44.20671081542969, "mean_td_error": -1.967352271080017}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 417000, "episodes_total": 416, "training_iteration": 417, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-24-11", "timestamp": 1565083451, "time_this_iter_s": 6.986866474151611, "time_total_s": 3038.762033700943, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3038.762033700943, "timesteps_since_restore": 417000, "iterations_since_restore": 417}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1192.12, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.669800615161339, "mean_processing_ms": 0.16039964857809708, "mean_inference_ms": 0.7024167351565037}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 829, "num_steps_trained": 3336000, "num_steps_sampled": 418000, "sample_time_ms": 11.294, "replay_time_ms": 3.851, "grad_time_ms": 5.353, "update_time_ms": 4.893, "opt_peak_throughput": 5977.826, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.3863296508789, "min_q": -122.09634399414062, "max_q": -44.65743637084961, "mean_td_error": 5.026904106140137}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 418000, "episodes_total": 417, "training_iteration": 418, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-24-18", "timestamp": 1565083458, "time_this_iter_s": 6.797708034515381, "time_total_s": 3045.5597417354584, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3045.5597417354584, "timesteps_since_restore": 418000, "iterations_since_restore": 418}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1190.97, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6697047700547983, "mean_processing_ms": 0.16037891121137002, "mean_inference_ms": 0.7023139761223096}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 831, "num_steps_trained": 3344000, "num_steps_sampled": 419000, "sample_time_ms": 12.218, "replay_time_ms": 4.215, "grad_time_ms": 5.878, "update_time_ms": 5.564, "opt_peak_throughput": 5444.165, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.7139663696289, "min_q": -128.38833618164062, "max_q": -43.92051696777344, "mean_td_error": -0.8601216077804565}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 419000, "episodes_total": 418, "training_iteration": 419, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-24-25", "timestamp": 1565083465, "time_this_iter_s": 6.839497804641724, "time_total_s": 3052.3992395401, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3052.3992395401, "timesteps_since_restore": 419000, "iterations_since_restore": 419}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1187.99, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6696131043530344, "mean_processing_ms": 0.16035921435991835, "mean_inference_ms": 0.7022154624263812}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 833, "num_steps_trained": 3352000, "num_steps_sampled": 420000, "sample_time_ms": 13.305, "replay_time_ms": 4.785, "grad_time_ms": 6.385, "update_time_ms": 5.948, "opt_peak_throughput": 5012.033, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.32054138183594, "min_q": -134.18434143066406, "max_q": -44.95253372192383, "mean_td_error": 1.5773051977157593}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 420000, "episodes_total": 419, "training_iteration": 420, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-24-33", "timestamp": 1565083473, "time_this_iter_s": 8.325420379638672, "time_total_s": 3060.7246599197388, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3060.7246599197388, "timesteps_since_restore": 420000, "iterations_since_restore": 420}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1183.91, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6695225310682804, "mean_processing_ms": 0.16033971472968125, "mean_inference_ms": 0.702118301283293}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 835, "num_steps_trained": 3360000, "num_steps_sampled": 421000, "sample_time_ms": 10.662, "replay_time_ms": 3.607, "grad_time_ms": 5.001, "update_time_ms": 5.044, "opt_peak_throughput": 6398.664, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.10127258300781, "min_q": -327.60601806640625, "max_q": -46.02602005004883, "mean_td_error": 0.8504980802536011}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 421000, "episodes_total": 420, "training_iteration": 421, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-24-41", "timestamp": 1565083481, "time_this_iter_s": 7.0655505657196045, "time_total_s": 3067.7902104854584, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3067.7902104854584, "timesteps_since_restore": 421000, "iterations_since_restore": 421}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1187.55, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6694334819925265, "mean_processing_ms": 0.16032062397041458, "mean_inference_ms": 0.7020227706744084}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 837, "num_steps_trained": 3368000, "num_steps_sampled": 422000, "sample_time_ms": 11.947, "replay_time_ms": 5.025, "grad_time_ms": 5.905, "update_time_ms": 5.462, "opt_peak_throughput": 5419.369, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.24894714355469, "min_q": -128.276123046875, "max_q": -45.652252197265625, "mean_td_error": 4.979860782623291}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 422000, "episodes_total": 421, "training_iteration": 422, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-24-47", "timestamp": 1565083487, "time_this_iter_s": 6.852459907531738, "time_total_s": 3074.64267039299, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3074.64267039299, "timesteps_since_restore": 422000, "iterations_since_restore": 422}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1185.83, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6693413678197198, "mean_processing_ms": 0.16030078047088067, "mean_inference_ms": 0.7019244114981258}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 839, "num_steps_trained": 3376000, "num_steps_sampled": 423000, "sample_time_ms": 11.493, "replay_time_ms": 3.945, "grad_time_ms": 5.794, "update_time_ms": 5.692, "opt_peak_throughput": 5523.022, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.05110168457031, "min_q": -244.21914672851562, "max_q": -44.63770294189453, "mean_td_error": -2.6275737285614014}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 423000, "episodes_total": 422, "training_iteration": 423, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-24-54", "timestamp": 1565083494, "time_this_iter_s": 6.800365209579468, "time_total_s": 3081.4430356025696, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3081.4430356025696, "timesteps_since_restore": 423000, "iterations_since_restore": 423}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1200.88, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6692494097947731, "mean_processing_ms": 0.16028097639467004, "mean_inference_ms": 0.7018267489525387}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 841, "num_steps_trained": 3384000, "num_steps_sampled": 424000, "sample_time_ms": 12.154, "replay_time_ms": 4.177, "grad_time_ms": 6.1, "update_time_ms": 5.827, "opt_peak_throughput": 5245.872, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.52902221679688, "min_q": -114.32478332519531, "max_q": -45.27628707885742, "mean_td_error": 1.476099967956543}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 424000, "episodes_total": 423, "training_iteration": 424, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-01", "timestamp": 1565083501, "time_this_iter_s": 6.833528995513916, "time_total_s": 3088.2765645980835, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3088.2765645980835, "timesteps_since_restore": 424000, "iterations_since_restore": 424}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1196.52, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6691578269487098, "mean_processing_ms": 0.16026129864566208, "mean_inference_ms": 0.7017296487331197}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 843, "num_steps_trained": 3392000, "num_steps_sampled": 425000, "sample_time_ms": 10.381, "replay_time_ms": 3.85, "grad_time_ms": 5.058, "update_time_ms": 4.935, "opt_peak_throughput": 6326.906, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -72.97870635986328, "min_q": -314.58489990234375, "max_q": -46.14982986450195, "mean_td_error": 5.564234733581543}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 425000, "episodes_total": 424, "training_iteration": 425, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-08", "timestamp": 1565083508, "time_this_iter_s": 6.745553255081177, "time_total_s": 3095.0221178531647, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3095.0221178531647, "timesteps_since_restore": 425000, "iterations_since_restore": 425}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1193.28, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6690672699755731, "mean_processing_ms": 0.16024191154514086, "mean_inference_ms": 0.7016338940162438}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 845, "num_steps_trained": 3400000, "num_steps_sampled": 426000, "sample_time_ms": 10.8, "replay_time_ms": 4.031, "grad_time_ms": 5.348, "update_time_ms": 4.998, "opt_peak_throughput": 5983.129, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -77.15040588378906, "min_q": -197.1103057861328, "max_q": -45.28002166748047, "mean_td_error": 1.7778968811035156}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 426000, "episodes_total": 425, "training_iteration": 426, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-15", "timestamp": 1565083515, "time_this_iter_s": 6.82105016708374, "time_total_s": 3101.8431680202484, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3101.8431680202484, "timesteps_since_restore": 426000, "iterations_since_restore": 426}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1187.16, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.668977803109899, "mean_processing_ms": 0.16022284851373825, "mean_inference_ms": 0.7015394346257081}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 847, "num_steps_trained": 3408000, "num_steps_sampled": 427000, "sample_time_ms": 10.528, "replay_time_ms": 3.852, "grad_time_ms": 5.321, "update_time_ms": 5.274, "opt_peak_throughput": 6014.174, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -70.01313018798828, "min_q": -141.91165161132812, "max_q": -44.63352966308594, "mean_td_error": -0.9258819818496704}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 427000, "episodes_total": 426, "training_iteration": 427, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-22", "timestamp": 1565083522, "time_this_iter_s": 6.885805130004883, "time_total_s": 3108.7289731502533, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3108.7289731502533, "timesteps_since_restore": 427000, "iterations_since_restore": 427}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1183.61, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6688895672691296, "mean_processing_ms": 0.16020408896369037, "mean_inference_ms": 0.7014466567527957}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 849, "num_steps_trained": 3416000, "num_steps_sampled": 428000, "sample_time_ms": 13.508, "replay_time_ms": 4.236, "grad_time_ms": 6.178, "update_time_ms": 5.649, "opt_peak_throughput": 5179.612, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.94792938232422, "min_q": -228.39060974121094, "max_q": -44.6693115234375, "mean_td_error": 2.365825653076172}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 428000, "episodes_total": 427, "training_iteration": 428, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-28", "timestamp": 1565083528, "time_this_iter_s": 6.92597222328186, "time_total_s": 3115.654945373535, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3115.654945373535, "timesteps_since_restore": 428000, "iterations_since_restore": 428}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1180.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6688015877353535, "mean_processing_ms": 0.16018542370680514, "mean_inference_ms": 0.7013545744085896}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 851, "num_steps_trained": 3424000, "num_steps_sampled": 429000, "sample_time_ms": 13.007, "replay_time_ms": 4.877, "grad_time_ms": 6.241, "update_time_ms": 5.983, "opt_peak_throughput": 5127.452, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -74.67357635498047, "min_q": -437.98284912109375, "max_q": -44.71392059326172, "mean_td_error": 1.3800709247589111}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 429000, "episodes_total": 428, "training_iteration": 429, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-37", "timestamp": 1565083537, "time_this_iter_s": 8.171303749084473, "time_total_s": 3123.8262491226196, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3123.8262491226196, "timesteps_since_restore": 429000, "iterations_since_restore": 429}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1172.89, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6687123564093426, "mean_processing_ms": 0.16016643009297207, "mean_inference_ms": 0.7012617300191661}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 853, "num_steps_trained": 3432000, "num_steps_sampled": 430000, "sample_time_ms": 10.958, "replay_time_ms": 3.993, "grad_time_ms": 5.53, "update_time_ms": 4.866, "opt_peak_throughput": 5786.868, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.7625503540039, "min_q": -117.41438293457031, "max_q": -43.59365463256836, "mean_td_error": 0.326404333114624}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 430000, "episodes_total": 429, "training_iteration": 430, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-43", "timestamp": 1565083543, "time_this_iter_s": 6.743299961090088, "time_total_s": 3130.5695490837097, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3130.5695490837097, "timesteps_since_restore": 430000, "iterations_since_restore": 430}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1169.61, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6686242038265218, "mean_processing_ms": 0.16014769820552163, "mean_inference_ms": 0.7011700491399402}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 855, "num_steps_trained": 3440000, "num_steps_sampled": 431000, "sample_time_ms": 11.763, "replay_time_ms": 3.716, "grad_time_ms": 6.392, "update_time_ms": 6.159, "opt_peak_throughput": 5005.901, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.46654510498047, "min_q": -121.49343872070312, "max_q": -44.14476013183594, "mean_td_error": 2.887281894683838}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 431000, "episodes_total": 430, "training_iteration": 431, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-50", "timestamp": 1565083550, "time_this_iter_s": 6.80167555809021, "time_total_s": 3137.3712246418, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3137.3712246418, "timesteps_since_restore": 431000, "iterations_since_restore": 431}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1173.11, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6685373837316257, "mean_processing_ms": 0.16012918011374272, "mean_inference_ms": 0.7010800908931094}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 857, "num_steps_trained": 3448000, "num_steps_sampled": 432000, "sample_time_ms": 10.741, "replay_time_ms": 3.911, "grad_time_ms": 5.647, "update_time_ms": 5.114, "opt_peak_throughput": 5666.471, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.46843719482422, "min_q": -179.2276611328125, "max_q": -44.84646224975586, "mean_td_error": -3.238129138946533}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 432000, "episodes_total": 431, "training_iteration": 432, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-25-57", "timestamp": 1565083557, "time_this_iter_s": 6.962974786758423, "time_total_s": 3144.3341994285583, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3144.3341994285583, "timesteps_since_restore": 432000, "iterations_since_restore": 432}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1172.26, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6684483486976383, "mean_processing_ms": 0.16011018462427784, "mean_inference_ms": 0.7009882316077952}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 859, "num_steps_trained": 3456000, "num_steps_sampled": 433000, "sample_time_ms": 13.385, "replay_time_ms": 4.62, "grad_time_ms": 6.248, "update_time_ms": 5.845, "opt_peak_throughput": 5122.013, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -59.60871124267578, "min_q": -96.8505630493164, "max_q": -43.96353530883789, "mean_td_error": -2.401012420654297}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 433000, "episodes_total": 432, "training_iteration": 433, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-26-04", "timestamp": 1565083564, "time_this_iter_s": 6.877797365188599, "time_total_s": 3151.211996793747, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3151.211996793747, "timesteps_since_restore": 433000, "iterations_since_restore": 433}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1175.82, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6683586323216943, "mean_processing_ms": 0.16009103662526872, "mean_inference_ms": 0.7008966849236845}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 861, "num_steps_trained": 3464000, "num_steps_sampled": 434000, "sample_time_ms": 15.575, "replay_time_ms": 4.425, "grad_time_ms": 6.558, "update_time_ms": 7.425, "opt_peak_throughput": 4879.332, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.64341735839844, "min_q": -114.56275939941406, "max_q": -44.2607421875, "mean_td_error": -0.6817494630813599}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 434000, "episodes_total": 433, "training_iteration": 434, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-26-11", "timestamp": 1565083571, "time_this_iter_s": 6.861876726150513, "time_total_s": 3158.0738735198975, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3158.0738735198975, "timesteps_since_restore": 434000, "iterations_since_restore": 434}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1173.39, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.668272453234026, "mean_processing_ms": 0.16007283265493238, "mean_inference_ms": 0.7008087510748119}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 863, "num_steps_trained": 3472000, "num_steps_sampled": 435000, "sample_time_ms": 13.402, "replay_time_ms": 5.01, "grad_time_ms": 6.136, "update_time_ms": 6.885, "opt_peak_throughput": 5215.255, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.9058837890625, "min_q": -108.15738677978516, "max_q": -44.157798767089844, "mean_td_error": -0.5863572359085083}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 435000, "episodes_total": 434, "training_iteration": 435, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-26-19", "timestamp": 1565083579, "time_this_iter_s": 8.184593915939331, "time_total_s": 3166.258467435837, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3166.258467435837, "timesteps_since_restore": 435000, "iterations_since_restore": 435}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1177.2, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6681882637741131, "mean_processing_ms": 0.16005507047077283, "mean_inference_ms": 0.7007226024812112}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 865, "num_steps_trained": 3480000, "num_steps_sampled": 436000, "sample_time_ms": 10.972, "replay_time_ms": 3.922, "grad_time_ms": 5.769, "update_time_ms": 5.018, "opt_peak_throughput": 5546.623, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -55.33198165893555, "min_q": -97.68331909179688, "max_q": -43.42854690551758, "mean_td_error": 2.2893588542938232}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 436000, "episodes_total": 435, "training_iteration": 436, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-26-26", "timestamp": 1565083586, "time_this_iter_s": 7.1269330978393555, "time_total_s": 3173.385400533676, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3173.385400533676, "timesteps_since_restore": 436000, "iterations_since_restore": 436}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1175.78, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6681050930509559, "mean_processing_ms": 0.16003758308449167, "mean_inference_ms": 0.7006376807328119}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 867, "num_steps_trained": 3488000, "num_steps_sampled": 437000, "sample_time_ms": 11.193, "replay_time_ms": 4.051, "grad_time_ms": 5.563, "update_time_ms": 5.194, "opt_peak_throughput": 5752.517, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.64833068847656, "min_q": -127.16297149658203, "max_q": -43.43715286254883, "mean_td_error": 3.191545009613037}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 437000, "episodes_total": 436, "training_iteration": 437, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-26-33", "timestamp": 1565083593, "time_this_iter_s": 6.905052661895752, "time_total_s": 3180.290453195572, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3180.290453195572, "timesteps_since_restore": 437000, "iterations_since_restore": 437}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1171.67, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6680252576678878, "mean_processing_ms": 0.16002081285468772, "mean_inference_ms": 0.7005568872719716}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 869, "num_steps_trained": 3496000, "num_steps_sampled": 438000, "sample_time_ms": 18.162, "replay_time_ms": 6.121, "grad_time_ms": 8.759, "update_time_ms": 8.823, "opt_peak_throughput": 3653.495, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.666748046875, "min_q": -116.06793975830078, "max_q": -43.07625198364258, "mean_td_error": 1.544594407081604}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 438000, "episodes_total": 437, "training_iteration": 438, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-26-41", "timestamp": 1565083601, "time_this_iter_s": 8.04114317893982, "time_total_s": 3188.3315963745117, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3188.3315963745117, "timesteps_since_restore": 438000, "iterations_since_restore": 438}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1173.65, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6679529665783984, "mean_processing_ms": 0.1600056846523755, "mean_inference_ms": 0.700483800885112}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 871, "num_steps_trained": 3504000, "num_steps_sampled": 439000, "sample_time_ms": 17.677, "replay_time_ms": 5.024, "grad_time_ms": 6.317, "update_time_ms": 6.832, "opt_peak_throughput": 5065.585, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -59.87666320800781, "min_q": -121.0926284790039, "max_q": -42.04840087890625, "mean_td_error": -1.9461636543273926}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 439000, "episodes_total": 438, "training_iteration": 439, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-26-51", "timestamp": 1565083611, "time_this_iter_s": 9.584777355194092, "time_total_s": 3197.916373729706, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3197.916373729706, "timesteps_since_restore": 439000, "iterations_since_restore": 439}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1176.28, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6678856232030715, "mean_processing_ms": 0.15999180599985097, "mean_inference_ms": 0.7004170246427092}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 873, "num_steps_trained": 3512000, "num_steps_sampled": 440000, "sample_time_ms": 16.371, "replay_time_ms": 5.832, "grad_time_ms": 8.885, "update_time_ms": 7.545, "opt_peak_throughput": 3601.623, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -59.09642791748047, "min_q": -100.49044799804688, "max_q": -41.53499221801758, "mean_td_error": 2.6863369941711426}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 440000, "episodes_total": 439, "training_iteration": 440, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-00", "timestamp": 1565083620, "time_this_iter_s": 8.94756007194519, "time_total_s": 3206.863933801651, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3206.863933801651, "timesteps_since_restore": 440000, "iterations_since_restore": 440}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1175.84, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6678236969530942, "mean_processing_ms": 0.1599791818191392, "mean_inference_ms": 0.7003570813266061}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 875, "num_steps_trained": 3520000, "num_steps_sampled": 441000, "sample_time_ms": 13.955, "replay_time_ms": 5.156, "grad_time_ms": 7.612, "update_time_ms": 6.295, "opt_peak_throughput": 4204.026, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.36398315429688, "min_q": -117.85458374023438, "max_q": -41.68661117553711, "mean_td_error": 2.393494129180908}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 441000, "episodes_total": 440, "training_iteration": 441, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-09", "timestamp": 1565083629, "time_this_iter_s": 8.860360383987427, "time_total_s": 3215.7242941856384, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3215.7242941856384, "timesteps_since_restore": 441000, "iterations_since_restore": 441}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1171.77, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6677676475518001, "mean_processing_ms": 0.15996782433837048, "mean_inference_ms": 0.7003044270500983}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 876, "num_steps_trained": 3528000, "num_steps_sampled": 442000, "sample_time_ms": 10.833, "replay_time_ms": 4.758, "grad_time_ms": 6.104, "update_time_ms": 5.277, "opt_peak_throughput": 5242.348, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -53.46221160888672, "min_q": -95.5081787109375, "max_q": -40.92898941040039, "mean_td_error": 1.1823153495788574}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 442000, "episodes_total": 441, "training_iteration": 442, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-18", "timestamp": 1565083638, "time_this_iter_s": 8.993925094604492, "time_total_s": 3224.718219280243, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3224.718219280243, "timesteps_since_restore": 442000, "iterations_since_restore": 442}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1168.74, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6677129935453137, "mean_processing_ms": 0.15995686363192316, "mean_inference_ms": 0.7002543536727381}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 878, "num_steps_trained": 3536000, "num_steps_sampled": 443000, "sample_time_ms": 12.448, "replay_time_ms": 4.47, "grad_time_ms": 6.579, "update_time_ms": 5.728, "opt_peak_throughput": 4863.807, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -61.05393981933594, "min_q": -104.41043090820312, "max_q": -40.84429931640625, "mean_td_error": -0.28172600269317627}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 443000, "episodes_total": 442, "training_iteration": 443, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-25", "timestamp": 1565083645, "time_this_iter_s": 7.080362319946289, "time_total_s": 3231.798581600189, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3231.798581600189, "timesteps_since_restore": 443000, "iterations_since_restore": 443}
{"episode_reward_max": -604.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1159.04, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6676550653714716, "mean_processing_ms": 0.15994516869243147, "mean_inference_ms": 0.7002017758308035}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 880, "num_steps_trained": 3544000, "num_steps_sampled": 444000, "sample_time_ms": 11.555, "replay_time_ms": 4.094, "grad_time_ms": 5.618, "update_time_ms": 5.246, "opt_peak_throughput": 5696.412, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -59.97187423706055, "min_q": -112.12789916992188, "max_q": -41.760337829589844, "mean_td_error": 1.544703483581543}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 444000, "episodes_total": 443, "training_iteration": 444, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-31", "timestamp": 1565083651, "time_this_iter_s": 6.626979112625122, "time_total_s": 3238.4255607128143, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3238.4255607128143, "timesteps_since_restore": 444000, "iterations_since_restore": 444}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1153.94, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6675841570370686, "mean_processing_ms": 0.15993004609058026, "mean_inference_ms": 0.7001321719466636}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 882, "num_steps_trained": 3552000, "num_steps_sampled": 445000, "sample_time_ms": 11.92, "replay_time_ms": 4.588, "grad_time_ms": 6.126, "update_time_ms": 5.633, "opt_peak_throughput": 5223.415, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -59.09300231933594, "min_q": -122.06094360351562, "max_q": -42.05763244628906, "mean_td_error": 5.080945014953613}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 445000, "episodes_total": 444, "training_iteration": 445, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-38", "timestamp": 1565083658, "time_this_iter_s": 6.605990409851074, "time_total_s": 3245.0315511226654, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3245.0315511226654, "timesteps_since_restore": 445000, "iterations_since_restore": 445}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1157.86, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6675020817453832, "mean_processing_ms": 0.15991251134358675, "mean_inference_ms": 0.7000517769943635}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 884, "num_steps_trained": 3560000, "num_steps_sampled": 446000, "sample_time_ms": 10.751, "replay_time_ms": 3.745, "grad_time_ms": 5.197, "update_time_ms": 5.114, "opt_peak_throughput": 6157.002, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -60.21223449707031, "min_q": -101.13614654541016, "max_q": -41.35476303100586, "mean_td_error": 3.371631145477295}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 446000, "episodes_total": 445, "training_iteration": 446, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-45", "timestamp": 1565083665, "time_this_iter_s": 6.646497011184692, "time_total_s": 3251.67804813385, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3251.67804813385, "timesteps_since_restore": 446000, "iterations_since_restore": 446}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1161.53, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6674198852167997, "mean_processing_ms": 0.1598949738059468, "mean_inference_ms": 0.699972268263498}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 886, "num_steps_trained": 3568000, "num_steps_sampled": 447000, "sample_time_ms": 12.621, "replay_time_ms": 4.211, "grad_time_ms": 5.598, "update_time_ms": 5.295, "opt_peak_throughput": 5716.112, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.34860229492188, "min_q": -135.01956176757812, "max_q": -40.345890045166016, "mean_td_error": 1.7127270698547363}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 447000, "episodes_total": 446, "training_iteration": 447, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-52", "timestamp": 1565083672, "time_this_iter_s": 7.171074151992798, "time_total_s": 3258.849122285843, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3258.849122285843, "timesteps_since_restore": 447000, "iterations_since_restore": 447}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1162.13, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6673390483573658, "mean_processing_ms": 0.15987769344836567, "mean_inference_ms": 0.6998943377983359}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 888, "num_steps_trained": 3576000, "num_steps_sampled": 448000, "sample_time_ms": 15.153, "replay_time_ms": 5.171, "grad_time_ms": 7.375, "update_time_ms": 6.792, "opt_peak_throughput": 4339.08, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -58.87781524658203, "min_q": -107.2846450805664, "max_q": -39.74775314331055, "mean_td_error": 0.6483179330825806}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 448000, "episodes_total": 447, "training_iteration": 448, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-27-59", "timestamp": 1565083679, "time_this_iter_s": 7.504323244094849, "time_total_s": 3266.3534455299377, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3266.3534455299377, "timesteps_since_restore": 448000, "iterations_since_restore": 448}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1162.14, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6672614527579158, "mean_processing_ms": 0.15986114140622917, "mean_inference_ms": 0.6998196563949952}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 890, "num_steps_trained": 3584000, "num_steps_sampled": 449000, "sample_time_ms": 11.372, "replay_time_ms": 4.545, "grad_time_ms": 6.469, "update_time_ms": 5.98, "opt_peak_throughput": 4947.025, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -56.34693908691406, "min_q": -110.53694915771484, "max_q": -39.46174240112305, "mean_td_error": -0.3265577554702759}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 449000, "episodes_total": 448, "training_iteration": 449, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-28-07", "timestamp": 1565083687, "time_this_iter_s": 7.70201563835144, "time_total_s": 3274.055461168289, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3274.055461168289, "timesteps_since_restore": 449000, "iterations_since_restore": 449}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1149.15, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6671800105736304, "mean_processing_ms": 0.1598437797997959, "mean_inference_ms": 0.699742005428287}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 892, "num_steps_trained": 3592000, "num_steps_sampled": 450000, "sample_time_ms": 11.947, "replay_time_ms": 4.147, "grad_time_ms": 5.847, "update_time_ms": 5.36, "opt_peak_throughput": 5473.181, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.31855773925781, "min_q": -145.94874572753906, "max_q": -39.07242965698242, "mean_td_error": -1.9150886535644531}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 450000, "episodes_total": 449, "training_iteration": 450, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-28-13", "timestamp": 1565083693, "time_this_iter_s": 6.498554229736328, "time_total_s": 3280.5540153980255, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3280.5540153980255, "timesteps_since_restore": 450000, "iterations_since_restore": 450}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1144.13, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6670981298069307, "mean_processing_ms": 0.15982640310455626, "mean_inference_ms": 0.6996645973019227}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 894, "num_steps_trained": 3600000, "num_steps_sampled": 451000, "sample_time_ms": 10.511, "replay_time_ms": 4.126, "grad_time_ms": 5.613, "update_time_ms": 5.089, "opt_peak_throughput": 5700.888, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -60.041934967041016, "min_q": -109.97486877441406, "max_q": -39.272769927978516, "mean_td_error": 5.277453899383545}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 451000, "episodes_total": 450, "training_iteration": 451, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-28-20", "timestamp": 1565083700, "time_this_iter_s": 6.610527038574219, "time_total_s": 3287.1645424365997, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3287.1645424365997, "timesteps_since_restore": 451000, "iterations_since_restore": 451}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1139.54, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6670187283779346, "mean_processing_ms": 0.1598096458596061, "mean_inference_ms": 0.6995899089632693}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 896, "num_steps_trained": 3608000, "num_steps_sampled": 452000, "sample_time_ms": 15.664, "replay_time_ms": 5.856, "grad_time_ms": 7.254, "update_time_ms": 7.076, "opt_peak_throughput": 4411.255, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -56.867679595947266, "min_q": -115.70147705078125, "max_q": -38.617435455322266, "mean_td_error": -0.06643199920654297}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 452000, "episodes_total": 451, "training_iteration": 452, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-28-28", "timestamp": 1565083708, "time_this_iter_s": 7.495940446853638, "time_total_s": 3294.6604828834534, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3294.6604828834534, "timesteps_since_restore": 452000, "iterations_since_restore": 452}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1139.8, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.666941977988345, "mean_processing_ms": 0.15979353970603016, "mean_inference_ms": 0.6995181894222228}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 898, "num_steps_trained": 3616000, "num_steps_sampled": 453000, "sample_time_ms": 12.108, "replay_time_ms": 3.885, "grad_time_ms": 5.919, "update_time_ms": 5.245, "opt_peak_throughput": 5406.228, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -59.197914123535156, "min_q": -103.43038940429688, "max_q": -39.82661056518555, "mean_td_error": 0.8618950843811035}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 453000, "episodes_total": 452, "training_iteration": 453, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-28-35", "timestamp": 1565083715, "time_this_iter_s": 7.5932722091674805, "time_total_s": 3302.253755092621, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3302.253755092621, "timesteps_since_restore": 453000, "iterations_since_restore": 453}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1148.36, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6668665997201958, "mean_processing_ms": 0.15977774234718223, "mean_inference_ms": 0.69944762422361}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 900, "num_steps_trained": 3624000, "num_steps_sampled": 454000, "sample_time_ms": 12.197, "replay_time_ms": 4.617, "grad_time_ms": 6.416, "update_time_ms": 6.045, "opt_peak_throughput": 4987.356, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.275001525878906, "min_q": -99.6763687133789, "max_q": -40.0109977722168, "mean_td_error": -1.3261868953704834}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 454000, "episodes_total": 453, "training_iteration": 454, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-28-42", "timestamp": 1565083722, "time_this_iter_s": 6.626339673995972, "time_total_s": 3308.880094766617, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3308.880094766617, "timesteps_since_restore": 454000, "iterations_since_restore": 454}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1145.91, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6667924205373363, "mean_processing_ms": 0.15976218143672216, "mean_inference_ms": 0.6993781699318679}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 902, "num_steps_trained": 3632000, "num_steps_sampled": 455000, "sample_time_ms": 10.34, "replay_time_ms": 3.726, "grad_time_ms": 5.262, "update_time_ms": 5.346, "opt_peak_throughput": 6081.153, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -61.43207550048828, "min_q": -116.44207763671875, "max_q": -39.43809127807617, "mean_td_error": 2.0853259563446045}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 455000, "episodes_total": 454, "training_iteration": 455, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-28-49", "timestamp": 1565083729, "time_this_iter_s": 6.666653394699097, "time_total_s": 3315.546748161316, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3315.546748161316, "timesteps_since_restore": 455000, "iterations_since_restore": 455}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1143.94, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6667181357482076, "mean_processing_ms": 0.1597466814549447, "mean_inference_ms": 0.6993091000865622}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 904, "num_steps_trained": 3640000, "num_steps_sampled": 456000, "sample_time_ms": 15.119, "replay_time_ms": 5.415, "grad_time_ms": 6.897, "update_time_ms": 6.816, "opt_peak_throughput": 4639.781, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -56.74925994873047, "min_q": -118.97096252441406, "max_q": -38.58918762207031, "mean_td_error": -0.1450362205505371}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 456000, "episodes_total": 455, "training_iteration": 456, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-28-56", "timestamp": 1565083736, "time_this_iter_s": 7.568386077880859, "time_total_s": 3323.115134239197, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3323.115134239197, "timesteps_since_restore": 456000, "iterations_since_restore": 456}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1151.3, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6666458854241699, "mean_processing_ms": 0.15973170107161666, "mean_inference_ms": 0.6992430590302575}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 906, "num_steps_trained": 3648000, "num_steps_sampled": 457000, "sample_time_ms": 11.106, "replay_time_ms": 4.755, "grad_time_ms": 5.702, "update_time_ms": 5.689, "opt_peak_throughput": 5612.212, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -52.443424224853516, "min_q": -108.77747344970703, "max_q": -39.027156829833984, "mean_td_error": 0.6730225086212158}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 457000, "episodes_total": 456, "training_iteration": 457, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-29-04", "timestamp": 1565083744, "time_this_iter_s": 8.127617597579956, "time_total_s": 3331.2427518367767, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3331.2427518367767, "timesteps_since_restore": 457000, "iterations_since_restore": 457}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1152.13, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6665757985513516, "mean_processing_ms": 0.15971732984999495, "mean_inference_ms": 0.6991794310355444}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 908, "num_steps_trained": 3656000, "num_steps_sampled": 458000, "sample_time_ms": 11.32, "replay_time_ms": 4.415, "grad_time_ms": 5.796, "update_time_ms": 5.502, "opt_peak_throughput": 5521.296, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.64323425292969, "min_q": -132.34690856933594, "max_q": -38.62247085571289, "mean_td_error": 1.7250428199768066}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 458000, "episodes_total": 457, "training_iteration": 458, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-29-12", "timestamp": 1565083752, "time_this_iter_s": 7.2707109451293945, "time_total_s": 3338.513462781906, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3338.513462781906, "timesteps_since_restore": 458000, "iterations_since_restore": 458}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1154.86, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6665068027966544, "mean_processing_ms": 0.15970316187816744, "mean_inference_ms": 0.6991167184078809}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 910, "num_steps_trained": 3664000, "num_steps_sampled": 459000, "sample_time_ms": 11.808, "replay_time_ms": 4.876, "grad_time_ms": 5.872, "update_time_ms": 5.5, "opt_peak_throughput": 5450.046, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -58.921180725097656, "min_q": -118.89277648925781, "max_q": -39.24231719970703, "mean_td_error": -1.2141706943511963}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 459000, "episodes_total": 458, "training_iteration": 459, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-29-18", "timestamp": 1565083758, "time_this_iter_s": 6.702032566070557, "time_total_s": 3345.2154953479767, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3345.2154953479767, "timesteps_since_restore": 459000, "iterations_since_restore": 459}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1147.29, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6664378114663891, "mean_processing_ms": 0.15968907097161156, "mean_inference_ms": 0.699054580404338}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 912, "num_steps_trained": 3672000, "num_steps_sampled": 460000, "sample_time_ms": 10.683, "replay_time_ms": 4.331, "grad_time_ms": 5.619, "update_time_ms": 5.414, "opt_peak_throughput": 5694.527, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.47872161865234, "min_q": -125.86238861083984, "max_q": -39.59203338623047, "mean_td_error": 4.979167938232422}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 460000, "episodes_total": 459, "training_iteration": 460, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-29-25", "timestamp": 1565083765, "time_this_iter_s": 6.676148176193237, "time_total_s": 3351.89164352417, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3351.89164352417, "timesteps_since_restore": 460000, "iterations_since_restore": 460}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1152.62, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6663696680527363, "mean_processing_ms": 0.15967516815530408, "mean_inference_ms": 0.6989934258583982}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 914, "num_steps_trained": 3680000, "num_steps_sampled": 461000, "sample_time_ms": 10.562, "replay_time_ms": 4.152, "grad_time_ms": 5.573, "update_time_ms": 5.366, "opt_peak_throughput": 5741.788, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.097328186035156, "min_q": -110.57005310058594, "max_q": -39.160072326660156, "mean_td_error": 4.526998519897461}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 461000, "episodes_total": 460, "training_iteration": 461, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-29-32", "timestamp": 1565083772, "time_this_iter_s": 6.782946586608887, "time_total_s": 3358.674590110779, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3358.674590110779, "timesteps_since_restore": 461000, "iterations_since_restore": 461}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1148.52, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6663021911330991, "mean_processing_ms": 0.1596614562781972, "mean_inference_ms": 0.6989331895164957}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 916, "num_steps_trained": 3688000, "num_steps_sampled": 462000, "sample_time_ms": 11.319, "replay_time_ms": 3.538, "grad_time_ms": 5.08, "update_time_ms": 4.915, "opt_peak_throughput": 6299.734, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.11591339111328, "min_q": -119.58488464355469, "max_q": -39.221439361572266, "mean_td_error": -0.48630285263061523}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 462000, "episodes_total": 461, "training_iteration": 462, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-29-38", "timestamp": 1565083778, "time_this_iter_s": 6.716966867446899, "time_total_s": 3365.3915569782257, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3365.3915569782257, "timesteps_since_restore": 462000, "iterations_since_restore": 462}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1154.56, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6662318128878332, "mean_processing_ms": 0.15964703512567063, "mean_inference_ms": 0.6988702527315505}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 918, "num_steps_trained": 3696000, "num_steps_sampled": 463000, "sample_time_ms": 13.199, "replay_time_ms": 5.046, "grad_time_ms": 7.333, "update_time_ms": 6.698, "opt_peak_throughput": 4364.024, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.642608642578125, "min_q": -115.22254943847656, "max_q": -39.385013580322266, "mean_td_error": -0.4902017116546631}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 463000, "episodes_total": 462, "training_iteration": 463, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-29-45", "timestamp": 1565083785, "time_this_iter_s": 6.750301837921143, "time_total_s": 3372.141858816147, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3372.141858816147, "timesteps_since_restore": 463000, "iterations_since_restore": 463}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1150.82, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6661652368594025, "mean_processing_ms": 0.15963362030821127, "mean_inference_ms": 0.6988108138226135}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 920, "num_steps_trained": 3704000, "num_steps_sampled": 464000, "sample_time_ms": 11.62, "replay_time_ms": 4.602, "grad_time_ms": 6.108, "update_time_ms": 5.782, "opt_peak_throughput": 5239.053, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -55.65068817138672, "min_q": -113.93653869628906, "max_q": -39.21144104003906, "mean_td_error": 1.9286448955535889}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 464000, "episodes_total": 463, "training_iteration": 464, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-29-53", "timestamp": 1565083793, "time_this_iter_s": 8.135538816452026, "time_total_s": 3380.277397632599, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3380.277397632599, "timesteps_since_restore": 464000, "iterations_since_restore": 464}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1147.34, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6660990299208726, "mean_processing_ms": 0.1596202085172182, "mean_inference_ms": 0.6987519966502808}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 922, "num_steps_trained": 3712000, "num_steps_sampled": 465000, "sample_time_ms": 11.429, "replay_time_ms": 3.698, "grad_time_ms": 5.523, "update_time_ms": 5.463, "opt_peak_throughput": 5794.188, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -56.60358428955078, "min_q": -109.0075454711914, "max_q": -38.73316192626953, "mean_td_error": 2.9143588542938232}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 465000, "episodes_total": 464, "training_iteration": 465, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-00", "timestamp": 1565083800, "time_this_iter_s": 6.723850250244141, "time_total_s": 3387.001247882843, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3387.001247882843, "timesteps_since_restore": 465000, "iterations_since_restore": 465}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1151.82, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6660339889961249, "mean_processing_ms": 0.15960708616447056, "mean_inference_ms": 0.6986945474206546}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 924, "num_steps_trained": 3720000, "num_steps_sampled": 466000, "sample_time_ms": 11.002, "replay_time_ms": 3.8, "grad_time_ms": 5.242, "update_time_ms": 5.222, "opt_peak_throughput": 6104.996, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -61.249412536621094, "min_q": -118.534423828125, "max_q": -39.8541374206543, "mean_td_error": 6.016842842102051}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 466000, "episodes_total": 465, "training_iteration": 466, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-07", "timestamp": 1565083807, "time_this_iter_s": 6.731474161148071, "time_total_s": 3393.732722043991, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3393.732722043991, "timesteps_since_restore": 466000, "iterations_since_restore": 466}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1157.22, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6659700044396867, "mean_processing_ms": 0.15959420563419308, "mean_inference_ms": 0.6986381918901862}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 926, "num_steps_trained": 3728000, "num_steps_sampled": 467000, "sample_time_ms": 10.922, "replay_time_ms": 4.182, "grad_time_ms": 5.323, "update_time_ms": 5.115, "opt_peak_throughput": 6011.912, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -56.566612243652344, "min_q": -112.66617584228516, "max_q": -39.45897674560547, "mean_td_error": 2.910360813140869}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 467000, "episodes_total": 466, "training_iteration": 467, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-14", "timestamp": 1565083814, "time_this_iter_s": 6.7460362911224365, "time_total_s": 3400.4787583351135, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3400.4787583351135, "timesteps_since_restore": 467000, "iterations_since_restore": 467}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1165.42, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.665907082864195, "mean_processing_ms": 0.15958153779706238, "mean_inference_ms": 0.6985830366593632}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 928, "num_steps_trained": 3736000, "num_steps_sampled": 468000, "sample_time_ms": 11.838, "replay_time_ms": 4.13, "grad_time_ms": 5.922, "update_time_ms": 5.66, "opt_peak_throughput": 5403.355, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -58.09858322143555, "min_q": -103.1969223022461, "max_q": -39.68962860107422, "mean_td_error": 0.5626881122589111}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 468000, "episodes_total": 467, "training_iteration": 468, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-20", "timestamp": 1565083820, "time_this_iter_s": 6.6738951206207275, "time_total_s": 3407.1526534557343, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3407.1526534557343, "timesteps_since_restore": 468000, "iterations_since_restore": 468}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1169.89, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6658482363518591, "mean_processing_ms": 0.15956987316905463, "mean_inference_ms": 0.6985315471818846}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 930, "num_steps_trained": 3744000, "num_steps_sampled": 469000, "sample_time_ms": 13.175, "replay_time_ms": 4.614, "grad_time_ms": 6.394, "update_time_ms": 6.129, "opt_peak_throughput": 5005.061, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.46826934814453, "min_q": -107.39618682861328, "max_q": -38.89253616333008, "mean_td_error": 3.3605666160583496}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 469000, "episodes_total": 468, "training_iteration": 469, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-28", "timestamp": 1565083828, "time_this_iter_s": 8.121713638305664, "time_total_s": 3415.27436709404, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3415.27436709404, "timesteps_since_restore": 469000, "iterations_since_restore": 469}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1170.9, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6657896398052168, "mean_processing_ms": 0.15955830093914605, "mean_inference_ms": 0.6984807241656183}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 932, "num_steps_trained": 3752000, "num_steps_sampled": 470000, "sample_time_ms": 11.098, "replay_time_ms": 3.997, "grad_time_ms": 5.299, "update_time_ms": 5.0, "opt_peak_throughput": 6038.69, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -54.7591552734375, "min_q": -100.33663940429688, "max_q": -39.9942741394043, "mean_td_error": 1.0568792819976807}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 470000, "episodes_total": 469, "training_iteration": 470, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-35", "timestamp": 1565083835, "time_this_iter_s": 6.8688037395477295, "time_total_s": 3422.1431708335876, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3422.1431708335876, "timesteps_since_restore": 470000, "iterations_since_restore": 470}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1169.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6657312858833069, "mean_processing_ms": 0.15954684064940605, "mean_inference_ms": 0.6984304168860689}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 934, "num_steps_trained": 3760000, "num_steps_sampled": 471000, "sample_time_ms": 11.534, "replay_time_ms": 4.1, "grad_time_ms": 5.518, "update_time_ms": 5.208, "opt_peak_throughput": 5798.919, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -56.753753662109375, "min_q": -105.13591766357422, "max_q": -38.65694808959961, "mean_td_error": 1.0242847204208374}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 471000, "episodes_total": 470, "training_iteration": 471, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-42", "timestamp": 1565083842, "time_this_iter_s": 6.677570343017578, "time_total_s": 3428.820741176605, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3428.820741176605, "timesteps_since_restore": 471000, "iterations_since_restore": 471}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1168.52, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.665673299118312, "mean_processing_ms": 0.1595354707034695, "mean_inference_ms": 0.6983808448132593}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 936, "num_steps_trained": 3768000, "num_steps_sampled": 472000, "sample_time_ms": 12.442, "replay_time_ms": 4.325, "grad_time_ms": 5.61, "update_time_ms": 5.225, "opt_peak_throughput": 5704.014, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.78970336914062, "min_q": -117.70465087890625, "max_q": -39.669921875, "mean_td_error": -2.6333749294281006}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 472000, "episodes_total": 471, "training_iteration": 472, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-49", "timestamp": 1565083849, "time_this_iter_s": 6.738598823547363, "time_total_s": 3435.5593400001526, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3435.5593400001526, "timesteps_since_restore": 472000, "iterations_since_restore": 472}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1182.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6656161751984184, "mean_processing_ms": 0.15952421988032886, "mean_inference_ms": 0.6983318554682257}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 938, "num_steps_trained": 3776000, "num_steps_sampled": 473000, "sample_time_ms": 12.017, "replay_time_ms": 3.964, "grad_time_ms": 6.052, "update_time_ms": 6.176, "opt_peak_throughput": 5287.389, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -60.62174987792969, "min_q": -115.7269287109375, "max_q": -39.18327713012695, "mean_td_error": 1.4467159509658813}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 473000, "episodes_total": 472, "training_iteration": 473, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-30-55", "timestamp": 1565083855, "time_this_iter_s": 6.6046671867370605, "time_total_s": 3442.1640071868896, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3442.1640071868896, "timesteps_since_restore": 473000, "iterations_since_restore": 473}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1187.72, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.665559462392684, "mean_processing_ms": 0.1595131006831837, "mean_inference_ms": 0.6982834498231205}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 940, "num_steps_trained": 3784000, "num_steps_sampled": 474000, "sample_time_ms": 13.47, "replay_time_ms": 4.626, "grad_time_ms": 6.253, "update_time_ms": 6.278, "opt_peak_throughput": 5117.345, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -57.326324462890625, "min_q": -106.81027221679688, "max_q": -39.525142669677734, "mean_td_error": 2.128420352935791}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 474000, "episodes_total": 473, "training_iteration": 474, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-02", "timestamp": 1565083862, "time_this_iter_s": 6.673514127731323, "time_total_s": 3448.837521314621, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3448.837521314621, "timesteps_since_restore": 474000, "iterations_since_restore": 474}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1192.48, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6655033413267764, "mean_processing_ms": 0.15950211901052375, "mean_inference_ms": 0.6982357126569768}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 942, "num_steps_trained": 3792000, "num_steps_sampled": 475000, "sample_time_ms": 11.043, "replay_time_ms": 3.515, "grad_time_ms": 5.06, "update_time_ms": 5.013, "opt_peak_throughput": 6323.508, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -70.61259460449219, "min_q": -196.44888305664062, "max_q": -40.0460319519043, "mean_td_error": 1.1835834980010986}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 475000, "episodes_total": 474, "training_iteration": 475, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-09", "timestamp": 1565083869, "time_this_iter_s": 6.68219780921936, "time_total_s": 3455.5197191238403, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3455.5197191238403, "timesteps_since_restore": 475000, "iterations_since_restore": 475}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1198.69, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6654476840028106, "mean_processing_ms": 0.15949116488145126, "mean_inference_ms": 0.6981883717747269}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 944, "num_steps_trained": 3800000, "num_steps_sampled": 476000, "sample_time_ms": 11.528, "replay_time_ms": 3.986, "grad_time_ms": 5.132, "update_time_ms": 5.155, "opt_peak_throughput": 6235.608, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -55.684898376464844, "min_q": -115.8675308227539, "max_q": -39.67585754394531, "mean_td_error": 0.535927414894104}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 476000, "episodes_total": 475, "training_iteration": 476, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-15", "timestamp": 1565083875, "time_this_iter_s": 6.715910911560059, "time_total_s": 3462.2356300354004, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3462.2356300354004, "timesteps_since_restore": 476000, "iterations_since_restore": 476}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1203.51, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653932076841979, "mean_processing_ms": 0.15948046049882367, "mean_inference_ms": 0.6981420465202262}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 946, "num_steps_trained": 3808000, "num_steps_sampled": 477000, "sample_time_ms": 10.228, "replay_time_ms": 4.04, "grad_time_ms": 5.815, "update_time_ms": 4.925, "opt_peak_throughput": 5502.689, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -71.02053833007812, "min_q": -138.5924835205078, "max_q": -40.39058303833008, "mean_td_error": -3.0886430740356445}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 477000, "episodes_total": 476, "training_iteration": 477, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-22", "timestamp": 1565083882, "time_this_iter_s": 6.815160036087036, "time_total_s": 3469.0507900714874, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3469.0507900714874, "timesteps_since_restore": 477000, "iterations_since_restore": 477}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1203.91, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653397880165218, "mean_processing_ms": 0.15946999615890203, "mean_inference_ms": 0.6980969174007798}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 948, "num_steps_trained": 3816000, "num_steps_sampled": 478000, "sample_time_ms": 11.387, "replay_time_ms": 4.37, "grad_time_ms": 6.031, "update_time_ms": 5.544, "opt_peak_throughput": 5305.845, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.986572265625, "min_q": -140.65573120117188, "max_q": -39.52418518066406, "mean_td_error": 4.485985279083252}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 478000, "episodes_total": 477, "training_iteration": 478, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-29", "timestamp": 1565083889, "time_this_iter_s": 6.778687238693237, "time_total_s": 3475.8294773101807, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3475.8294773101807, "timesteps_since_restore": 478000, "iterations_since_restore": 478}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1206.14, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.665289947781455, "mean_processing_ms": 0.15946044065716722, "mean_inference_ms": 0.6980554219368785}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 950, "num_steps_trained": 3824000, "num_steps_sampled": 479000, "sample_time_ms": 13.008, "replay_time_ms": 4.583, "grad_time_ms": 6.163, "update_time_ms": 5.916, "opt_peak_throughput": 5192.135, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.06349182128906, "min_q": -129.80322265625, "max_q": -39.597389221191406, "mean_td_error": 1.8841735124588013}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 479000, "episodes_total": 478, "training_iteration": 479, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-37", "timestamp": 1565083897, "time_this_iter_s": 8.184703588485718, "time_total_s": 3484.0141808986664, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3484.0141808986664, "timesteps_since_restore": 479000, "iterations_since_restore": 479}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1206.73, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6652411402399453, "mean_processing_ms": 0.1594512073978261, "mean_inference_ms": 0.6980150369422351}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 952, "num_steps_trained": 3832000, "num_steps_sampled": 480000, "sample_time_ms": 10.468, "replay_time_ms": 3.825, "grad_time_ms": 5.482, "update_time_ms": 4.975, "opt_peak_throughput": 5837.025, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.21110534667969, "min_q": -126.95160675048828, "max_q": -40.204952239990234, "mean_td_error": 2.236246347427368}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 480000, "episodes_total": 479, "training_iteration": 480, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-44", "timestamp": 1565083904, "time_this_iter_s": 6.805518388748169, "time_total_s": 3490.8196992874146, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3490.8196992874146, "timesteps_since_restore": 480000, "iterations_since_restore": 480}
{"episode_reward_max": -603.0, "episode_reward_min": -3197.0, "episode_reward_mean": -1205.7, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6651910688779771, "mean_processing_ms": 0.15944172048270944, "mean_inference_ms": 0.6979738386384002}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 954, "num_steps_trained": 3840000, "num_steps_sampled": 481000, "sample_time_ms": 10.783, "replay_time_ms": 3.768, "grad_time_ms": 5.516, "update_time_ms": 5.388, "opt_peak_throughput": 5801.727, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.7825698852539, "min_q": -154.14776611328125, "max_q": -41.14778518676758, "mean_td_error": 2.7423763275146484}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 481000, "episodes_total": 480, "training_iteration": 481, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-51", "timestamp": 1565083911, "time_this_iter_s": 6.737098693847656, "time_total_s": 3497.556797981262, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3497.556797981262, "timesteps_since_restore": 481000, "iterations_since_restore": 481}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1192.43, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6651384247516867, "mean_processing_ms": 0.15943165277106958, "mean_inference_ms": 0.6979308211490983}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 956, "num_steps_trained": 3848000, "num_steps_sampled": 482000, "sample_time_ms": 11.663, "replay_time_ms": 4.126, "grad_time_ms": 5.558, "update_time_ms": 5.217, "opt_peak_throughput": 5757.032, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.85287475585938, "min_q": -123.05341339111328, "max_q": -39.68248748779297, "mean_td_error": 2.4304590225219727}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 482000, "episodes_total": 481, "training_iteration": 482, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-31-57", "timestamp": 1565083917, "time_this_iter_s": 6.7531561851501465, "time_total_s": 3504.3099541664124, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3504.3099541664124, "timesteps_since_restore": 482000, "iterations_since_restore": 482}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1192.28, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.665086534794017, "mean_processing_ms": 0.1594218157985115, "mean_inference_ms": 0.6978887786170176}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 958, "num_steps_trained": 3856000, "num_steps_sampled": 483000, "sample_time_ms": 11.899, "replay_time_ms": 4.385, "grad_time_ms": 6.114, "update_time_ms": 5.529, "opt_peak_throughput": 5234.272, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.88920593261719, "min_q": -121.56128692626953, "max_q": -39.21258544921875, "mean_td_error": -2.1321277618408203}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 483000, "episodes_total": 482, "training_iteration": 483, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-32-04", "timestamp": 1565083924, "time_this_iter_s": 6.653619766235352, "time_total_s": 3510.9635739326477, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3510.9635739326477, "timesteps_since_restore": 483000, "iterations_since_restore": 483}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1195.52, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6650350726687162, "mean_processing_ms": 0.15941207027892296, "mean_inference_ms": 0.6978472396034043}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 960, "num_steps_trained": 3864000, "num_steps_sampled": 484000, "sample_time_ms": 11.316, "replay_time_ms": 4.652, "grad_time_ms": 6.332, "update_time_ms": 5.662, "opt_peak_throughput": 5053.626, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.63973999023438, "min_q": -124.82424926757812, "max_q": -40.39777374267578, "mean_td_error": 1.4614988565444946}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 484000, "episodes_total": 483, "training_iteration": 484, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-32-11", "timestamp": 1565083931, "time_this_iter_s": 6.656930446624756, "time_total_s": 3517.6205043792725, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3517.6205043792725, "timesteps_since_restore": 484000, "iterations_since_restore": 484}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1199.13, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6649871573595811, "mean_processing_ms": 0.15940311740580745, "mean_inference_ms": 0.6978089137283641}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 962, "num_steps_trained": 3872000, "num_steps_sampled": 485000, "sample_time_ms": 12.375, "replay_time_ms": 4.402, "grad_time_ms": 6.516, "update_time_ms": 6.096, "opt_peak_throughput": 4910.842, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.09169006347656, "min_q": -130.87771606445312, "max_q": -40.267982482910156, "mean_td_error": 3.539144992828369}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 485000, "episodes_total": 484, "training_iteration": 485, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-32-19", "timestamp": 1565083939, "time_this_iter_s": 7.940905570983887, "time_total_s": 3525.5614099502563, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3525.5614099502563, "timesteps_since_restore": 485000, "iterations_since_restore": 485}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1201.08, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6649406166786352, "mean_processing_ms": 0.15939446351908468, "mean_inference_ms": 0.6977721261589263}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 964, "num_steps_trained": 3880000, "num_steps_sampled": 486000, "sample_time_ms": 11.097, "replay_time_ms": 4.097, "grad_time_ms": 5.631, "update_time_ms": 5.266, "opt_peak_throughput": 5682.424, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.08892822265625, "min_q": -166.0705108642578, "max_q": -40.8005485534668, "mean_td_error": 0.09498333930969238}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 486000, "episodes_total": 485, "training_iteration": 486, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-32-26", "timestamp": 1565083946, "time_this_iter_s": 7.117602586746216, "time_total_s": 3532.6790125370026, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3532.6790125370026, "timesteps_since_restore": 486000, "iterations_since_restore": 486}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1202.32, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6648948923845236, "mean_processing_ms": 0.15938597818119943, "mean_inference_ms": 0.6977363918430405}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 966, "num_steps_trained": 3888000, "num_steps_sampled": 487000, "sample_time_ms": 11.733, "replay_time_ms": 4.215, "grad_time_ms": 5.628, "update_time_ms": 5.586, "opt_peak_throughput": 5685.746, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -70.16622924804688, "min_q": -155.51048278808594, "max_q": -40.94868469238281, "mean_td_error": 0.3754526376724243}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 487000, "episodes_total": 486, "training_iteration": 487, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-32-33", "timestamp": 1565083953, "time_this_iter_s": 6.767950057983398, "time_total_s": 3539.446962594986, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3539.446962594986, "timesteps_since_restore": 487000, "iterations_since_restore": 487}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1206.46, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6648499946360341, "mean_processing_ms": 0.15937768320503715, "mean_inference_ms": 0.6977016024908437}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 968, "num_steps_trained": 3896000, "num_steps_sampled": 488000, "sample_time_ms": 12.182, "replay_time_ms": 4.421, "grad_time_ms": 6.227, "update_time_ms": 5.902, "opt_peak_throughput": 5139.311, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -68.11141204833984, "min_q": -122.25404357910156, "max_q": -40.88388442993164, "mean_td_error": -1.422297716140747}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 488000, "episodes_total": 487, "training_iteration": 488, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-32-39", "timestamp": 1565083959, "time_this_iter_s": 6.61664605140686, "time_total_s": 3546.063608646393, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3546.063608646393, "timesteps_since_restore": 488000, "iterations_since_restore": 488}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1199.41, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6648082900129828, "mean_processing_ms": 0.15937022873553613, "mean_inference_ms": 0.6976701694134829}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 970, "num_steps_trained": 3904000, "num_steps_sampled": 489000, "sample_time_ms": 12.55, "replay_time_ms": 4.669, "grad_time_ms": 6.454, "update_time_ms": 6.373, "opt_peak_throughput": 4957.843, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.44715881347656, "min_q": -124.0085678100586, "max_q": -39.46996307373047, "mean_td_error": 2.0688109397888184}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 489000, "episodes_total": 488, "training_iteration": 489, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-32-47", "timestamp": 1565083967, "time_this_iter_s": 7.993633031845093, "time_total_s": 3554.057241678238, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3554.057241678238, "timesteps_since_restore": 489000, "iterations_since_restore": 489}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1196.54, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6647676759311629, "mean_processing_ms": 0.1593630359878062, "mean_inference_ms": 0.6976401398804555}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 972, "num_steps_trained": 3912000, "num_steps_sampled": 490000, "sample_time_ms": 12.437, "replay_time_ms": 3.558, "grad_time_ms": 5.158, "update_time_ms": 5.079, "opt_peak_throughput": 6204.104, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.07322692871094, "min_q": -126.76636505126953, "max_q": -40.109580993652344, "mean_td_error": 6.004343509674072}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 490000, "episodes_total": 489, "training_iteration": 490, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-32-54", "timestamp": 1565083974, "time_this_iter_s": 7.036753416061401, "time_total_s": 3561.0939950942993, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3561.0939950942993, "timesteps_since_restore": 490000, "iterations_since_restore": 490}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1197.78, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6647271336162202, "mean_processing_ms": 0.15935584742203035, "mean_inference_ms": 0.6976104882145003}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 974, "num_steps_trained": 3920000, "num_steps_sampled": 491000, "sample_time_ms": 12.054, "replay_time_ms": 4.175, "grad_time_ms": 5.877, "update_time_ms": 5.524, "opt_peak_throughput": 5445.159, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.2004165649414, "min_q": -302.514892578125, "max_q": -40.25320816040039, "mean_td_error": 2.0708413124084473}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 491000, "episodes_total": 490, "training_iteration": 491, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-01", "timestamp": 1565083981, "time_this_iter_s": 6.715508937835693, "time_total_s": 3567.809504032135, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3567.809504032135, "timesteps_since_restore": 491000, "iterations_since_restore": 491}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1197.05, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6646871100266804, "mean_processing_ms": 0.15934883337217065, "mean_inference_ms": 0.6975814186258813}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 976, "num_steps_trained": 3928000, "num_steps_sampled": 492000, "sample_time_ms": 12.071, "replay_time_ms": 4.693, "grad_time_ms": 6.074, "update_time_ms": 5.855, "opt_peak_throughput": 5268.44, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -62.66294860839844, "min_q": -134.77601623535156, "max_q": -40.096527099609375, "mean_td_error": 2.9625110626220703}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 492000, "episodes_total": 491, "training_iteration": 492, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-08", "timestamp": 1565083988, "time_this_iter_s": 6.669108629226685, "time_total_s": 3574.4786126613617, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3574.4786126613617, "timesteps_since_restore": 492000, "iterations_since_restore": 492}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1198.15, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6646479645555139, "mean_processing_ms": 0.1593420200553565, "mean_inference_ms": 0.6975531774863225}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 978, "num_steps_trained": 3936000, "num_steps_sampled": 493000, "sample_time_ms": 12.168, "replay_time_ms": 4.905, "grad_time_ms": 6.404, "update_time_ms": 6.194, "opt_peak_throughput": 4997.03, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -66.35944366455078, "min_q": -139.75515747070312, "max_q": -39.228214263916016, "mean_td_error": 2.987487316131592}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 493000, "episodes_total": 492, "training_iteration": 493, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-14", "timestamp": 1565083994, "time_this_iter_s": 6.660220384597778, "time_total_s": 3581.1388330459595, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3581.1388330459595, "timesteps_since_restore": 493000, "iterations_since_restore": 493}
{"episode_reward_max": -603.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1199.15, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6646093499367771, "mean_processing_ms": 0.15933533426921864, "mean_inference_ms": 0.6975256763540911}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 980, "num_steps_trained": 3944000, "num_steps_sampled": 494000, "sample_time_ms": 10.333, "replay_time_ms": 3.686, "grad_time_ms": 5.376, "update_time_ms": 5.122, "opt_peak_throughput": 5952.56, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.91364288330078, "min_q": -179.87100219726562, "max_q": -39.78162384033203, "mean_td_error": 3.079335927963257}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 494000, "episodes_total": 493, "training_iteration": 494, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-21", "timestamp": 1565084001, "time_this_iter_s": 6.655731678009033, "time_total_s": 3587.7945647239685, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3587.7945647239685, "timesteps_since_restore": 494000, "iterations_since_restore": 494}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1192.95, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.664573112711921, "mean_processing_ms": 0.15932933057672935, "mean_inference_ms": 0.6975008414990547}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 982, "num_steps_trained": 3952000, "num_steps_sampled": 495000, "sample_time_ms": 14.792, "replay_time_ms": 6.113, "grad_time_ms": 7.486, "update_time_ms": 6.868, "opt_peak_throughput": 4274.368, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.64644622802734, "min_q": -113.69420623779297, "max_q": -39.48167419433594, "mean_td_error": 6.078286170959473}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 495000, "episodes_total": 494, "training_iteration": 495, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-29", "timestamp": 1565084009, "time_this_iter_s": 7.689097881317139, "time_total_s": 3595.4836626052856, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3595.4836626052856, "timesteps_since_restore": 495000, "iterations_since_restore": 495}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1187.75, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6645372991874909, "mean_processing_ms": 0.15932340392885197, "mean_inference_ms": 0.6974766147429655}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 984, "num_steps_trained": 3960000, "num_steps_sampled": 496000, "sample_time_ms": 11.848, "replay_time_ms": 4.329, "grad_time_ms": 5.803, "update_time_ms": 5.66, "opt_peak_throughput": 5514.649, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.625877380371094, "min_q": -109.98080444335938, "max_q": -39.57096862792969, "mean_td_error": 2.560950756072998}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 496000, "episodes_total": 495, "training_iteration": 496, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-36", "timestamp": 1565084016, "time_this_iter_s": 7.439451456069946, "time_total_s": 3602.9231140613556, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3602.9231140613556, "timesteps_since_restore": 496000, "iterations_since_restore": 496}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1187.21, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6645007923529812, "mean_processing_ms": 0.15931742251261466, "mean_inference_ms": 0.697452453121324}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 986, "num_steps_trained": 3968000, "num_steps_sampled": 497000, "sample_time_ms": 12.085, "replay_time_ms": 4.053, "grad_time_ms": 5.612, "update_time_ms": 5.358, "opt_peak_throughput": 5701.712, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -67.55441284179688, "min_q": -134.7319793701172, "max_q": -39.41373825073242, "mean_td_error": -0.9208046197891235}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 497000, "episodes_total": 496, "training_iteration": 497, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-44", "timestamp": 1565084024, "time_this_iter_s": 7.479238986968994, "time_total_s": 3610.4023530483246, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3610.4023530483246, "timesteps_since_restore": 497000, "iterations_since_restore": 497}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1192.03, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6644654219467833, "mean_processing_ms": 0.15931178001003038, "mean_inference_ms": 0.6974299506896878}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 988, "num_steps_trained": 3976000, "num_steps_sampled": 498000, "sample_time_ms": 12.269, "replay_time_ms": 4.239, "grad_time_ms": 6.406, "update_time_ms": 6.445, "opt_peak_throughput": 4995.003, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -65.9080810546875, "min_q": -126.00592041015625, "max_q": -40.93614959716797, "mean_td_error": 0.16300463676452637}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 498000, "episodes_total": 497, "training_iteration": 498, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-51", "timestamp": 1565084031, "time_this_iter_s": 7.10729193687439, "time_total_s": 3617.509644985199, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3617.509644985199, "timesteps_since_restore": 498000, "iterations_since_restore": 498}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1186.6, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6644256442095232, "mean_processing_ms": 0.15930490452006937, "mean_inference_ms": 0.697401628043124}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 990, "num_steps_trained": 3984000, "num_steps_sampled": 499000, "sample_time_ms": 12.199, "replay_time_ms": 4.129, "grad_time_ms": 5.693, "update_time_ms": 5.494, "opt_peak_throughput": 5621.12, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -57.870391845703125, "min_q": -132.17041015625, "max_q": -39.60328674316406, "mean_td_error": -2.33212947845459}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 499000, "episodes_total": 498, "training_iteration": 499, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-33-57", "timestamp": 1565084037, "time_this_iter_s": 6.620965003967285, "time_total_s": 3624.1306099891663, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3624.1306099891663, "timesteps_since_restore": 499000, "iterations_since_restore": 499}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1187.23, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6643877612879237, "mean_processing_ms": 0.15929852241182718, "mean_inference_ms": 0.6973754041018316}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 992, "num_steps_trained": 3992000, "num_steps_sampled": 500000, "sample_time_ms": 14.053, "replay_time_ms": 4.849, "grad_time_ms": 6.817, "update_time_ms": 6.405, "opt_peak_throughput": 4694.323, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.61054992675781, "min_q": -366.994140625, "max_q": -39.0604133605957, "mean_td_error": 0.29351603984832764}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 500000, "episodes_total": 499, "training_iteration": 500, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-34-06", "timestamp": 1565084046, "time_this_iter_s": 8.194525480270386, "time_total_s": 3632.3251354694366, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3632.3251354694366, "timesteps_since_restore": 500000, "iterations_since_restore": 500}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1187.08, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6643484159660169, "mean_processing_ms": 0.1592916509881665, "mean_inference_ms": 0.6973451563227065}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 994, "num_steps_trained": 4000000, "num_steps_sampled": 501000, "sample_time_ms": 11.745, "replay_time_ms": 4.573, "grad_time_ms": 6.065, "update_time_ms": 5.307, "opt_peak_throughput": 5276.227, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -60.85883712768555, "min_q": -136.46038818359375, "max_q": -39.21818542480469, "mean_td_error": 0.40868711471557617}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 501000, "episodes_total": 500, "training_iteration": 501, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-34-13", "timestamp": 1565084053, "time_this_iter_s": 7.2629663944244385, "time_total_s": 3639.588101863861, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3639.588101863861, "timesteps_since_restore": 501000, "iterations_since_restore": 501}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1181.96, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6643048513966268, "mean_processing_ms": 0.15928394219708236, "mean_inference_ms": 0.6973103876233528}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 996, "num_steps_trained": 4008000, "num_steps_sampled": 502000, "sample_time_ms": 12.072, "replay_time_ms": 4.387, "grad_time_ms": 6.472, "update_time_ms": 6.05, "opt_peak_throughput": 4944.473, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -73.41778564453125, "min_q": -130.9820098876953, "max_q": -38.85609817504883, "mean_td_error": 4.402072906494141}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 502000, "episodes_total": 501, "training_iteration": 502, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-34-20", "timestamp": 1565084060, "time_this_iter_s": 7.051111936569214, "time_total_s": 3646.6392138004303, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3646.6392138004303, "timesteps_since_restore": 502000, "iterations_since_restore": 502}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1183.93, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6642603868226402, "mean_processing_ms": 0.15927595008938705, "mean_inference_ms": 0.697274662285528}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 998, "num_steps_trained": 4016000, "num_steps_sampled": 503000, "sample_time_ms": 13.66, "replay_time_ms": 5.255, "grad_time_ms": 6.667, "update_time_ms": 6.48, "opt_peak_throughput": 4799.816, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -59.477699279785156, "min_q": -110.92214965820312, "max_q": -39.677398681640625, "mean_td_error": 0.9076279401779175}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 503000, "episodes_total": 502, "training_iteration": 503, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-34-27", "timestamp": 1565084067, "time_this_iter_s": 6.858094215393066, "time_total_s": 3653.4973080158234, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3653.4973080158234, "timesteps_since_restore": 503000, "iterations_since_restore": 503}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1189.02, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6642150243226018, "mean_processing_ms": 0.15926765726748732, "mean_inference_ms": 0.6972382248544531}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 1000, "num_steps_trained": 4024000, "num_steps_sampled": 504000, "sample_time_ms": 13.058, "replay_time_ms": 4.034, "grad_time_ms": 5.648, "update_time_ms": 5.972, "opt_peak_throughput": 5665.753, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -64.53218078613281, "min_q": -136.8185272216797, "max_q": -39.6328125, "mean_td_error": 4.766725063323975}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 504000, "episodes_total": 503, "training_iteration": 504, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-34-34", "timestamp": 1565084074, "time_this_iter_s": 7.026099920272827, "time_total_s": 3660.523407936096, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3660.523407936096, "timesteps_since_restore": 504000, "iterations_since_restore": 504}
{"episode_reward_max": -532.0, "episode_reward_min": -2706.0, "episode_reward_mean": -1187.07, "episode_len_mean": 1001.0, "episodes_this_iter": 1, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6641686319721312, "mean_processing_ms": 0.15925913042165593, "mean_inference_ms": 0.6972013916457}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 1001, "num_steps_trained": 4032000, "num_steps_sampled": 505000, "sample_time_ms": 11.543, "replay_time_ms": 4.361, "grad_time_ms": 6.182, "update_time_ms": 5.02, "opt_peak_throughput": 5176.436, "opt_samples": 32.0, "learner": {"default_policy": {"cur_lr": 0.0005000000237487257, "mean_q": -63.39249801635742, "min_q": -130.4056854248047, "max_q": -39.74586868286133, "mean_td_error": 2.903914213180542}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 505000, "episodes_total": 504, "training_iteration": 505, "experiment_id": "31d871a2df144d6fafdd6a98882c5203", "date": "2019-08-06_17-34-41", "timestamp": 1565084081, "time_this_iter_s": 7.031695127487183, "time_total_s": 3667.5551030635834, "pid": 6548, "hostname": "skylark0924", "node_ip": "192.168.1.106", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "env_config": {"cityflow_config_file": "examples/config_1x1.json", "thread_num": 1, "num_step": 1000, "lane_phase_info": {"intersection_1_1": {"start_lane": ["road_0_1_0_0", "road_0_1_0_1", "road_1_0_1_0", "road_1_0_1_1", "road_1_2_3_0", "road_1_2_3_1", "road_2_1_2_0", "road_2_1_2_1"], "end_lane": ["road_1_1_0_0", "road_1_1_0_1", "road_1_1_1_0", "road_1_1_1_1", "road_1_1_2_0", "road_1_1_2_1", "road_1_1_3_0", "road_1_1_3_1"], "phase": [1, 2, 3, 4, 5, 6, 7, 8], "phase_startLane_mapping": {"1": ["road_0_1_0_1", "road_2_1_2_1"], "2": ["road_1_0_1_1", "road_1_2_3_1"], "3": ["road_0_1_0_0", "road_2_1_2_0"], "4": ["road_1_0_1_0", "road_1_2_3_0"], "5": ["road_0_1_0_1", "road_0_1_0_0"], "6": ["road_2_1_2_1", "road_2_1_2_0"], "7": ["road_1_0_1_1", "road_1_0_1_0"], "8": ["road_1_2_3_0", "road_1_2_3_1"]}, "phase_roadLink_mapping": {"1": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"]], "2": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]], "3": [["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "4": [["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"], ["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"]], "5": [["road_0_1_0_1", "road_1_1_0_0"], ["road_0_1_0_1", "road_1_1_0_1"], ["road_0_1_0_0", "road_1_1_1_0"], ["road_0_1_0_0", "road_1_1_1_1"]], "6": [["road_2_1_2_1", "road_1_1_2_0"], ["road_2_1_2_1", "road_1_1_2_1"], ["road_2_1_2_0", "road_1_1_3_0"], ["road_2_1_2_0", "road_1_1_3_1"]], "7": [["road_1_0_1_1", "road_1_1_1_0"], ["road_1_0_1_1", "road_1_1_1_1"], ["road_1_0_1_0", "road_1_1_2_0"], ["road_1_0_1_0", "road_1_1_2_1"]], "8": [["road_1_2_3_0", "road_1_1_0_0"], ["road_1_2_3_0", "road_1_1_0_1"], ["road_1_2_3_1", "road_1_1_3_0"], ["road_1_2_3_1", "road_1_1_3_1"]]}}}, "state_time_span": 5, "time_span": 30, "state_size": 8, "action_size": 8, "batch_size": 128}, "env": "CityflowGymEnv", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 4, "train_batch_size": 32, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [256], "n_step": 1, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_eps": 0.02, "target_network_update_freq": 500, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_norm_clipping": 40, "learning_starts": 1000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3667.5551030635834, "timesteps_since_restore": 505000, "iterations_since_restore": 505}
